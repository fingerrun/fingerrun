<html lang="ko">
<head>
    <!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-T9HC454Z');</script>
<!-- End Google Tag Manager -->
    <meta charset="UTF-8">

    <!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-7QSEYCFK83"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-7QSEYCFK83');
</script>

<meta name="viewport" content="width=device-width, initial-scale=0.67, maximum-scale=1.0, user-scalable=yes">
<title>í•‘ê±°ëŸ° | ì••ë„ì ì¸ ë””ìì¸ê³¼ ì„±ëŠ¥ì˜ í•œê¸€íƒ€ìì—°ìŠµì„ ê²½í—˜í•´ë³´ì„¸ìš”.</title>
<link rel="icon" type="image/svg+xml" href="../images/finger-run-logo.svg">
<link rel="shortcut icon" type="image/svg+xml" href="../images/finger-run-logo.svg">
<link rel="apple-touch-icon" href="../images/finger-run-logo.svg">
<link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>âŒ¨ï¸</text></svg>">
    
    <!-- SEO ë©”íƒ€íƒœê·¸ -->
<meta name="description" content="í•‘ê±°ëŸ° íƒ€ìì—°ìŠµ ì‚¬ì´íŠ¸ì—ì„œ ì••ë„ì ì¸ ë””ìì¸ê³¼ ì„±ëŠ¥ì„ ê°–ì¶˜ í•œê¸€íƒ€ìì—°ìŠµì„ ê²½í—˜í•˜ì„¸ìš”. ììŒ, ëª¨ìŒ, ë‹¨ì–´, ë¬¸ì¥ ë‹¨ê³„ë³„ í•™ìŠµê³¼ ì‹¤ì‹œê°„ AI í”¼ë“œë°±, í‚¤ë³´ë“œ ê°€ì´ë“œë¡œ íƒ€ì´í•‘ ì†ë„ì™€ ì •í™•ë„ë¥¼ íš¨ê³¼ì ìœ¼ë¡œ í–¥ìƒì‹œí‚¬ ìˆ˜ ìˆëŠ” ìµœê³ ì˜ í•œê¸€ íƒ€ìì—°ìŠµ ì‚¬ì´íŠ¸ì…ë‹ˆë‹¤.">
    <meta name="keywords" content="í•œê¸€íƒ€ìì—°ìŠµ, í•œê¸€ìíŒì—°ìŠµ, íƒ€ìì—°ìŠµ, í•œê¸€íƒ€ìì†ë„, í•œê¸€íƒ€ìì—°ìŠµ ì‚¬ì´íŠ¸, ì˜¨ë¼ì¸ íƒ€ìì—°ìŠµ, ììŒì—°ìŠµ, ëª¨ìŒì—°ìŠµ, ë‹¨ì–´ì—°ìŠµ, ë¬¸ì¥ì—°ìŠµ">
    <meta name="author" content="FingerRun">
    <meta name="robots" content="index, follow">

    <!-- Open Graph (SNS ê³µìœ ) -->
    <meta property="og:title" content="í•‘ê±°ëŸ° | í•œê¸€íƒ€ìì—°ìŠµ">
    <meta property="og:description" content="ì••ë„ì ì¸ ë””ìì¸ê³¼ ì„±ëŠ¥ì˜ íƒ€ìì—°ìŠµ ì‚¬ì´íŠ¸ë¡œ íƒ€ì´í•‘ ì†ë„ì™€ ì •í™•ë„ë¥¼ í–¥ìƒì‹œí‚¤ì„¸ìš”. ììŒ, ëª¨ìŒ, ë‹¨ì–´, ë¬¸ì¥ ë‹¨ê³„ë³„ í•™ìŠµ.">
    <meta property="og:url" content="https://fingerrun.com/Korean/practice.html">
    <meta property="og:type" content="website">

    <!-- ì¶”ê°€ SEO -->
    <link rel="canonical" href="https://fingerrun.com/Korean/practice.html">
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #f5f5f5;
            min-height: 100vh;
            color: #333;
            line-height: 1.6;
        }

        /* Navigation */
        nav {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            padding: 1rem 0;
            position: fixed;
            width: 100%;
            top: 0;
            z-index: 1000;
            box-shadow: 0 2px 20px rgba(0, 0, 0, 0.1);
        }

        .nav-container {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 2rem;
        }

        .logo {
            font-size: 1.8rem;
            font-weight: bold;
            color: #667eea;
            text-decoration: none;
        }

        .nav-menu {
            display: flex;
            list-style: none;
            gap: 1.5rem;
            flex-wrap: nowrap;
            white-space: nowrap;
        }

        .nav-menu li {
            position: relative;
        }

        .nav-menu a {
            text-decoration: none;
            color: #333;
            font-weight: 500;
            padding: 0.5rem 0.8rem;
            border-radius: 25px;
            transition: all 0.3s ease;
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 0.3rem;
        }

        .nav-menu a:hover {
            background: #667eea;
            color: white;
            transform: translateY(-2px);
        }

        /* ë“œë¡­ë‹¤ìš´ í™”ì‚´í‘œ */
        .dropdown-arrow {
            font-size: 0.7rem;
            transition: transform 0.3s ease;
        }

        /* ë“œë¡­ë‹¤ìš´ ë©”ë‰´ */
        .dropdown-menu {
            position: absolute;
            top: 100%;
            left: 0;
            background: white;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
            border-radius: 10px;
            padding: 0.5rem 0;
            min-width: 180px;
            opacity: 0;
            visibility: hidden;
            transform: translateY(-10px);
            transition: all 0.3s ease;
            z-index: 1001;
            border: 1px solid rgba(0, 0, 0, 0.1);
        }

        .nav-menu li:hover .dropdown-menu {
            opacity: 1;
            visibility: visible;
            transform: translateY(0);
        }

        .nav-menu li:hover .dropdown-arrow {
            transform: rotate(180deg);
        }

        .dropdown-menu a {
            display: block;
            padding: 0.7rem 1rem;
            color: #333;
            border-radius: 0;
            font-weight: 400;
            transition: all 0.2s ease;
        }

        .dropdown-menu a:hover {
            background: #f8f9fa;
            color: #667eea;
            transform: none;
            padding-left: 1.2rem;
        }

        /* Main Container */
        .main-container {
            margin-top: 80px;
            padding: 2rem 0;
            max-width: 1200px;
            margin-left: auto;
            margin-right: auto;
            padding-left: 2rem;
            padding-right: 2rem;
        }

        .page-header {
            text-align: center;
            margin-bottom: 3rem;
        }

        .page-title {
            font-size: 2.5rem;
            font-weight: 700;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 1rem;
        }

        .page-description {
            font-size: 1.2rem;
            color: #666;
            max-width: 600px;
            margin: 0 auto;
            white-space: nowrap;
        }

        /* Practice Container */
        .practice-container {
            background: white;
            border-radius: 20px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1);
            padding: 3rem;
            margin-bottom: 2rem;
            transition: all 0.3s ease;
        }

        .practice-container:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 50px rgba(0, 0, 0, 0.15);
        }

        /* Menu Buttons */
        .practice-menu {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-bottom: 3rem;
            flex-wrap: wrap;
        }

        .menu-btn {
            padding: 12px 25px;
            border: none;
            border-radius: 25px;
            font-size: 1rem;
            font-weight: 500;
            cursor: pointer;
            background: #f8f9fa;
            color: #667eea;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            border: 2px solid transparent;
        }

        .menu-btn:hover {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.3);
        }

        .menu-btn.active {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            transform: scale(1.05);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4);
        }

        /* Practice Area */
        .practice-area {
            text-align: center;
            margin-bottom: 3rem;
        }

        .text-display {
            font-size: 1.8rem;
            line-height: 1.8;
            margin-bottom: 2rem;
            min-height: 120px;
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            align-items: center;
            background: #f8f9fa;
            border-radius: 15px;
            padding: 2rem;
            word-break: keep-all;
            letter-spacing: 2px;
            border: 2px solid #e2e8f0;
            transition: all 0.3s ease;
        }

        .text-display:hover {
            border-color: #667eea;
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.1);
        }

        .text-display.sentence-mode {
            letter-spacing: 0.2px;
            line-height: 1.6;
            background: white;
            border: 2px solid #e2e8f0;
        }

        .text-display.sentence-mode:hover {
            border-color: #667eea;
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.1);
        }

        .text-display.sentence-mode .char {
            margin: 0;
            padding: 0;
            background: none !important;
            border-radius: 0;
            transition: color 0.2s ease;
            color: #8b5cf6;
            font-weight: 500;
            box-shadow: none !important;
            transform: none !important;
            animation: none !important;
        }

        .text-display.sentence-mode .char.correct {
            color: #000000;
        }

        .text-display.sentence-mode .char.incorrect {
            color: #ff4444;
        }

        .text-display.sentence-mode .char.current {
            color: #3b82f6;
            background: none !important;
        }

        /* ë„ì–´ì“°ê¸° ìŠ¤íƒ€ì¼ */
        .text-display.sentence-mode .char.space {
            display: inline-block;
            width: 0.5em;
        }

        .char {
            margin: 3px;
            padding: 8px 10px;
            border-radius: 8px;
            transition: all 0.3s ease;
            color: #666;
            font-weight: 500;
        }

        .char.correct {
            color: white;
            background: linear-gradient(45deg, #4caf50, #45a049);
            transform: scale(1.1);
            box-shadow: 0 4px 10px rgba(76, 175, 80, 0.3);
        }

        .char.incorrect {
            color: white;
            background: linear-gradient(45deg, #ff6b6b, #ff5252);
            transform: scale(1.1);
            box-shadow: 0 4px 10px rgba(255, 107, 107, 0.3);
        }

        .char.current {
            color: white;
            background: linear-gradient(45deg, #667eea, #764ba2);
            animation: pulse 1.5s infinite;
            transform: scale(1.15);
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; transform: scale(1.15); }
            50% { opacity: 0.7; transform: scale(1.2); }
        }

        /* Keyboard Area */
        .keyboard-area {
            margin: 2rem 0;
            display: flex;
            justify-content: center;
        }

        .keyboard {
            background: white;
            border-radius: 20px;
            padding: 2rem;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            border: 2px solid #e2e8f0;
            width: 100%;
            max-width: none;
        }

        .keyboard-row {
            display: flex;
            justify-content: center;
            margin-bottom: 0.5rem;
            gap: 0.3rem;
        }

        .keyboard-row:last-child {
            margin-bottom: 0;
        }

        .key {
            background: linear-gradient(145deg, #f8f9fa, #e9ecef);
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            padding: 0.8rem;
            min-width: 2.5rem;
            height: 2.5rem;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 500;
            font-size: 0.9rem;
            color: #495057;
            transition: all 0.3s ease;
            cursor: pointer;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            position: relative;
        }

        .key:hover {
            background: linear-gradient(145deg, #e9ecef, #dee2e6);
            transform: translateY(-1px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
        }

        .key.active {
            background: linear-gradient(145deg, #ff6b6b, #ff5252) !important;
            color: white !important;
            border-color: #ff4444 !important;
            transform: scale(1.1) !important;
            box-shadow: 0 6px 20px rgba(255, 107, 107, 0.4) !important;
            animation: keyPulse 0.3s ease-in-out !important;
        }

        @keyframes keyPulse {
            0% { transform: scale(1.1); }
            50% { transform: scale(1.2); }
            100% { transform: scale(1.1); }
        }

        /* íŠ¹ìˆ˜ í‚¤ ìŠ¤íƒ€ì¼ */
        .key.wide { min-width: 4rem; }
        .key.extra-wide { min-width: 6rem; }
        .key.space { min-width: 12rem; }
        .key.shift { min-width: 5rem; }
        .key.tab { min-width: 3.5rem; }
        .key.caps { min-width: 4.5rem; }
        .key.enter { min-width: 5.5rem; }
        .key.backspace { min-width: 4.5rem; }

        /* í•œê¸€/ì˜ì–´ í‘œì‹œ */
        .key-dual {
            display: flex;
            flex-direction: column;
            align-items: center;
            line-height: 1.1;
        }

        .key-en {
            font-size: 0.7rem;
            color: #6c757d;
        }

        .key-ko {
            font-size: 0.8rem;
            color: #495057;
            font-weight: 600;
        }

        /* Input Area */
        .input-area {
            margin-bottom: 3rem;
        }

        .typing-input {
            width: 100%;
            padding: 18px;
            font-size: 1.2rem;
            border: 2px solid #e2e8f0;
            border-radius: 15px;
            text-align: center;
            outline: none;
            background: white;
            color: #333;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }

        .typing-input:focus {
            border-color: #667eea;
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.2);
            transform: translateY(-2px);
        }

        /* Stats */
        .stats {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            background: #f8f9fa;
            padding: 2rem;
            border-radius: 15px;
            margin-bottom: 2rem;
            border: 2px solid #e2e8f0;
        }

        .stat-item {
            text-align: center;
            padding: 1.5rem;
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.05);
            transition: all 0.3s ease;
        }

        .stat-item:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.1);
        }

        .stat-value {
            font-size: 2.2rem;
            font-weight: 700;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 0.5rem;
        }

        .stat-label {
            color: #666;
            font-size: 1rem;
            font-weight: 500;
        }

        /* Modal */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .modal-content {
            background: white;
            padding: 3rem;
            border-radius: 20px;
            text-align: center;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            max-width: 500px;
            width: 90%;
            animation: slideUp 0.5s ease;
        }

        /* Enhanced Modal for AI Feedback */
        .modal-content.ai-feedback {
            max-width: 900px;
            max-height: 90vh;
            overflow-y: auto;
            text-align: left;
            padding: 2.5rem;
        }

        @keyframes slideUp {
            from { transform: translateY(50px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        .complete-title {
            font-size: 2.8rem;
            font-weight: 700;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 2rem;
        }

        .ai-title {
            font-size: 2.2rem;
            font-weight: 700;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 2rem;
            text-align: center;
        }

        .complete-stats {
            display: flex;
            justify-content: space-around;
            margin-bottom: 3rem;
        }

        .complete-stat {
            text-align: center;
            padding: 1.5rem;
            background: #f8f9fa;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.05);
        }

        .complete-value {
            font-size: 2.5rem;
            font-weight: 700;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 0.5rem;
        }

        .complete-label {
            color: #666;
            font-size: 1.1rem;
            font-weight: 500;
        }

        /* AI Feedback Specific Styles */
        .feedback-section {
            margin-bottom: 2rem;
            padding: 1.5rem;
            background: #f8f9fa;
            border-radius: 12px;
            border-left: 4px solid #667eea;
        }

        .feedback-section-title {
            font-size: 1.3rem;
            font-weight: 600;
            color: #333;
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .feedback-text {
            font-size: 1rem;
            line-height: 1.6;
            color: #555;
            margin-bottom: 0.5rem;
        }

        .feedback-highlight {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            font-weight: 600;
        }

        /* Speedometer */
        .speedometer-container {
            display: flex;
            justify-content: center;
            align-items: center;
            margin: 2rem 0;
        }

        .speedometer {
            position: relative;
            width: 300px; /* 1.5ë°° ì¦ê°€ (200px -> 300px) */
            height: 150px; /* 1.5ë°° ì¦ê°€ (100px -> 150px) */
            margin: 0 auto;
        }

        .speedometer-arc {
            width: 300px; /* 1.5ë°° ì¦ê°€ */
            height: 150px; /* 1.5ë°° ì¦ê°€ */
            border: 12px solid #e2e8f0; /* í…Œë‘ë¦¬ë„ 1.5ë°° ì¦ê°€ */
            border-bottom: none;
            border-radius: 300px 300px 0 0; /* ë°˜ì§€ë¦„ë„ 1.5ë°° ì¦ê°€ */
            position: relative;
            background: linear-gradient(90deg, #ff4444 0%, #ffa500 25%, #ffff00 50%, #90EE90 75%, #4CAF50 100%);
            background-clip: padding-box;
        }

        .speedometer-needle {
            position: absolute;
            bottom: 0;
            left: 50%;
            width: 6px; /* 1.5ë°° ì¦ê°€ */
            height: 120px; /* 1.5ë°° ì¦ê°€ */
            background: #333;
            transform-origin: bottom center;
            transform: translateX(-50%) rotate(-90deg);
            transition: transform 2s ease-in-out;
            border-radius: 3px; /* 1.5ë°° ì¦ê°€ */
            z-index: 2;
        }

        .speedometer-center {
            position: absolute;
            bottom: -12px; /* í…Œë‘ë¦¬ ë‘ê»˜ì— ë§ì¶° ì¡°ì • */
            left: 50%;
            width: 24px; /* 1.5ë°° ì¦ê°€ */
            height: 24px; /* 1.5ë°° ì¦ê°€ */
            background: #333;
            border-radius: 50%;
            transform: translateX(-50%);
            z-index: 3;
        }

        .speedometer-labels {
            position: absolute;
            bottom: -20px;
            left: 0;
            right: 0;
            font-size: 0.8rem;
            color: #666;
        }

        .speedometer-labels .left-label {
            position: absolute;
            left: 0;
            bottom: 0;
        }

        .speedometer-labels .right-label {
            position: absolute;
            right: 0;
            bottom: 0;
        }

                        /* VS ëŒ€ê²° êµ¬ë„ ìŠ¤íƒ€ì¼ */
        .vs-container {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 2rem;
            margin: 2rem 0;
            padding: 2rem;
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border-radius: 15px;
            border: 2px solid #e2e8f0;
        }

        .vs-player {
            flex: 1;
            text-align: center;
            padding: 1.5rem;
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }

        .vs-player.user {
            border: 3px solid #667eea;
        }

        .vs-player.average {
            border: 3px solid #28a745;
        }

        .vs-divider {
            font-size: 3rem;
            font-weight: bold;
            color: #667eea;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
        }

        .vs-title {
            font-size: 1.3rem;
            font-weight: 700;
            margin-bottom: 1rem;
            color: #333;
        }

        .vs-stat {
            margin-bottom: 0.8rem;
            font-size: 1rem;
        }

        .vs-stat-label {
            color: #666;
            font-weight: 500;
        }

        .vs-stat-value {
            font-weight: 700;
            color: #667eea;
            margin-left: 0.5rem;
        }

        .vs-player.average .vs-stat-value {
            color: #28a745;
        }

        .skill-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin: 1rem 0;
        }

        .skill-item {
            background: white;
            padding: 1rem;
            border-radius: 8px;
            border-left: 3px solid #667eea;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .skill-item.advice-item {
            grid-column: span 3;
            border-left: 3px solid #28a745;
            background: linear-gradient(135deg, #f8fff9 0%, #e8f5e8 100%);
        }

        .skill-name {
            font-weight: 600;
            color: #333;
            margin-bottom: 0.5rem;
        }

        .skill-score {
            font-size: 1.1rem;
            font-weight: 700;
            color: #667eea;
        }

        .advice-content {
            font-size: 1rem;
            line-height: 1.6;
            color: #2d5016;
        }

        .progress-bar {
            width: 100%;
            height: 20px;
            background: #e2e8f0;
            border-radius: 10px;
            overflow: hidden;
            margin: 1rem 0;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(45deg, #667eea, #764ba2);
            border-radius: 10px;
            transition: width 0.5s ease;
        }

        .modal-buttons {
            display: flex;
            gap: 1rem;
            justify-content: center;
            margin-top: 2rem;
        }

        .restart-btn, .continue-btn {
            padding: 15px 40px;
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            border: none;
            border-radius: 25px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
            flex: 1;
        }

        .continue-btn {
            background: linear-gradient(45deg, #28a745, #20c997);
            box-shadow: 0 4px 15px rgba(40, 167, 69, 0.3);
        }

        .restart-btn:hover, .continue-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.5);
        }

        .continue-btn:hover {
            box-shadow: 0 8px 25px rgba(40, 167, 69, 0.5);
        }

        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid #f3f3f3;
            border-top: 3px solid #667eea;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-right: 10px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .feedback-section div[style*="display: flex"] {
                flex-direction: column !important;
                gap: 1.5rem !important;
            }
            
            .nav-menu {
                gap: 1rem;
                flex-wrap: nowrap;
            }

            .nav-menu a {
                padding: 0.4rem 0.6rem;
                font-size: 0.8rem;
            }

            .dropdown-menu {
                min-width: 150px;
                font-size: 0.8rem;
            }

            .dropdown-menu a {
                padding: 0.5rem 0.8rem;
            }

            .practice-container {
                padding: 2rem;
                margin: 1rem;
            }

            .page-title {
                font-size: 2rem;
            }

            .text-display {
                font-size: 1.5rem;
                padding: 1.5rem;
            }

            .stats {
                grid-template-columns: 1fr;
                gap: 15px;
                padding: 1.5rem;
            }

            .practice-menu {
                gap: 10px;
            }

            .menu-btn {
                padding: 10px 20px;
                font-size: 0.9rem;
            }

            .modal-content {
                padding: 2rem;
                margin: 1rem;
            }

            .modal-content.ai-feedback {
                padding: 1.5rem;
                margin: 0.5rem;
            }

            .complete-title {
                font-size: 2.2rem;
            }

            .ai-title {
                font-size: 1.8rem;
            }

            .complete-value {
                font-size: 2rem;
            }

            .speedometer {
                width: 225px; /* ëª¨ë°”ì¼ì—ì„œë„ 1.5ë°° í¬ê¸° ìœ ì§€ */
                height: 112px;
            }

            .speedometer-arc {
                width: 225px;
                height: 112px;
            }

            .speedometer-needle {
                height: 90px;
            }

            .skill-grid {
                grid-template-columns: 1fr;
            }

            .skill-item.advice-item {
                grid-column: span 1;
            }

            .modal-buttons {
                flex-direction: row; /* í•œ ì¤„ ìœ ì§€ */
                gap: 0.8rem;
            }

            .restart-btn, .continue-btn {
                padding: 12px 20px; /* ëª¨ë°”ì¼ì—ì„œ ë²„íŠ¼ í¬ê¸° ì¡°ì • */
                font-size: 0.9rem;
                flex: 1; /* ë™ì¼í•œ í¬ê¸° ìœ ì§€ */
            }

            /* ëª¨ë°”ì¼ í‚¤ë³´ë“œ ì¡°ì • */
            .keyboard {
                padding: 1rem;
            }

            .key {
                min-width: 1.8rem;
                height: 1.8rem;
                padding: 0.4rem;
                font-size: 0.7rem;
            }

            .key-dual {
                line-height: 1;
            }

            .key-en {
                font-size: 0.5rem;
            }

            .key-ko {
                font-size: 0.6rem;
            }

            .key.space {
                min-width: 6rem;
            }

            .key.shift {
                min-width: 2.5rem;
            }

            .key.enter {
                min-width: 3rem;
            }

            .key.backspace {
                min-width: 2.5rem;
            }

            .key.wide {
                min-width: 2rem;
            }

            .key.tab {
                min-width: 2rem;
            }

            .key.caps {
                min-width: 2.5rem;
            }
        }

        /* Animations */
        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .practice-container {
            animation: fadeInUp 0.8s ease-out;
        }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav>
        <div class="nav-container">
            <a href="../index.html" class="logo">âŒ¨ï¸ FingerRun</a>
            <ul class="nav-menu">
                <li><a href="../notices.html">ê³µì§€ì‚¬í•­</a></li>
                <li>
                    <a href="practice.html">
                        í•œê¸€ íƒ€ìì—°ìŠµ
                        <span class="dropdown-arrow">â–¼</span>
                    </a>
                    <div class="dropdown-menu">
                        <a href="practice.html" onclick="switchMode('consonant')">ììŒ ì—°ìŠµ</a>
                        <a href="practice.html" onclick="switchMode('vowel')">ëª¨ìŒ ì—°ìŠµ</a>
                        <a href="practice.html" onclick="switchMode('word')">ë‹¨ì–´ ì—°ìŠµ</a>
                        <a href="practice.html" onclick="switchMode('sentence')">ë¬¸ì¥ ì—°ìŠµ</a>
                    </div>
                </li>
                <li>
                    <a href="../English/practice.html">
                        ì˜ì–´ íƒ€ìì—°ìŠµ
                        <span class="dropdown-arrow">â–¼</span>
                    </a>
                    <div class="dropdown-menu">
                        <a href="../English/practice.html" onclick="switchEnglishMode('alphabet')">ì•ŒíŒŒë²³ ì—°ìŠµ</a>
                        <a href="../English/practice.html" onclick="switchEnglishMode('word')">ë‹¨ì–´ ì—°ìŠµ</a>
                        <a href="../English/practice.html" onclick="switchEnglishMode('sentence')">ë¬¸ì¥ ì—°ìŠµ</a>
                    </div>
                </li>
                <li>
                    <a href="game-mole.html">
                        íƒ€ìê²Œì„
                        <span class="dropdown-arrow">â–¼</span>
                    </a>
                    <div class="dropdown-menu">
                        <a href="game-mole.html">ë‘ë”ì§€ ì¡ê¸° (í•œê¸€)</a>
                        <a href="../English/game-mole.html">ë‘ë”ì§€ ì¡ê¸° (ì˜ì–´)</a>
                        <a href="game-plane.html">ë¹„í–‰ê¸° ì¡°ì¢… (í•œê¸€)</a>
                        <a href="../English/game-plane.html">ë¹„í–‰ê¸° ì¡°ì¢… (ì˜ì–´)</a>
                        <a href="game-delivery.html">íƒë°° ë¶„ë¥˜ (í•œê¸€)</a>
                        <a href="../English/game-delivery.html">íƒë°° ë¶„ë¥˜ (ì˜ì–´)</a>
                    </div>
                </li>
                <li><a href="../writing.html">í•„ì‚¬</a></li>
                <li>
                    <a href="../Certificate/word-processor.html">
                        ìê²©ì¦
                        <span class="dropdown-arrow">â–¼</span>
                    </a>
                    <div class="dropdown-menu">
                        <a href="../Certificate/word-processor.html">ì›Œë“œí”„ë¡œì„¸ì„œ</a>
                    </div>
                </li>
                <li><a href="../contact.html">ë¬¸ì˜í•˜ê¸°</a></li>
            </ul>
        </div>
    </nav>

    <!-- Main Container -->
    <div class="main-container">
        <!-- Page Header -->
        <div class="page-header">
            <h1 class="page-title">í•œê¸€ íƒ€ì ì—°ìŠµ</h1>
            <p class="page-description">ì²´ê³„ì ì¸ í•™ìŠµê³¼ ì² ì €í•œ AI í”¼ë“œë°± ë¶„ì„ìœ¼ë¡œ ì •í™•ë„ì™€ ì†ë„ë¥¼ í–¥ìƒì‹œí‚¤ì„¸ìš”.</p>
        </div>

        <!-- Practice Container -->
        <div class="practice-container">
            <!-- Practice Menu -->
            <div class="practice-menu">
                <button class="menu-btn active" data-mode="consonant">ììŒì—°ìŠµ</button>
                <button class="menu-btn" data-mode="vowel">ëª¨ìŒì—°ìŠµ</button>
                <button class="menu-btn" data-mode="word">ë‹¨ì–´ì—°ìŠµ</button>
                <button class="menu-btn" data-mode="sentence">ë¬¸ì¥ì—°ìŠµ</button>
            </div>

            <!-- Practice Area -->
            <div class="practice-area">
                <div class="text-display" id="textDisplay"></div>

                <!-- Keyboard Area -->
                <div class="keyboard-area">
                    <div class="keyboard" id="keyboard">
                        <div class="keyboard-row">
                            <div class="key" data-key="`" data-ko=""><div class="key-dual"><span class="key-en">`</span><span class="key-ko"></span></div></div>
                            <div class="key" data-key="1" data-ko=""><div class="key-dual"><span class="key-en">1</span><span class="key-ko"></span></div></div>
                            <div class="key" data-key="2" data-ko=""><div class="key-dual"><span class="key-en">2</span><span class="key-ko"></span></div></div>
                            <div class="key" data-key="3" data-ko=""><div class="key-dual"><span class="key-en">3</span><span class="key-ko"></span></div></div>
                            <div class="key" data-key="4" data-ko=""><div class="key-dual"><span class="key-en">4</span><span class="key-ko"></span></div></div>
                            <div class="key" data-key="5" data-ko=""><div class="key-dual"><span class="key-en">5</span><span class="key-ko"></span></div></div>
                            <div class="key" data-key="6" data-ko=""><div class="key-dual"><span class="key-en">6</span><span class="key-ko"></span></div></div>
                            <div class="key" data-key="7" data-ko=""><div class="key-dual"><span class="key-en">7</span><span class="key-ko"></span></div></div>
                            <div class="key" data-key="8" data-ko=""><div class="key-dual"><span class="key-en">8</span><span class="key-ko"></span></div></div>
                            <div class="key" data-key="9" data-ko=""><div class="key-dual"><span class="key-en">9</span><span class="key-ko"></span></div></div>
                            <div class="key" data-key="0" data-ko=""><div class="key-dual"><span class="key-en">0</span><span class="key-ko"></span></div></div>
                            <div class="key" data-key="-" data-ko=""><div class="key-dual"><span class="key-en">-</span><span class="key-ko"></span></div></div>
                            <div class="key" data-key="=" data-ko=""><div class="key-dual"><span class="key-en">=</span><span class="key-ko"></span></div></div>
                            <div class="key backspace" data-key="Backspace">â†</div>
                        </div>
                        <div class="keyboard-row">
                            <div class="key tab" data-key="Tab">Tab</div>
                            <div class="key" data-key="q" data-ko="ã…‚"><div class="key-dual"><span class="key-en">Q</span><span class="key-ko">ã…‚</span></div></div>
                            <div class="key" data-key="w" data-ko="ã…ˆ"><div class="key-dual"><span class="key-en">W</span><span class="key-ko">ã…ˆ</span></div></div>
                            <div class="key" data-key="e" data-ko="ã„·"><div class="key-dual"><span class="key-en">E</span><span class="key-ko">ã„·</span></div></div>
                            <div class="key" data-key="r" data-ko="ã„±"><div class="key-dual"><span class="key-en">R</span><span class="key-ko">ã„±</span></div></div>
                            <div class="key" data-key="t" data-ko="ã……"><div class="key-dual"><span class="key-en">T</span><span class="key-ko">ã……</span></div></div>
                            <div class="key" data-key="y" data-ko="ã…›"><div class="key-dual"><span class="key-en">Y</span><span class="key-ko">ã…›</span></div></div>
                            <div class="key" data-key="u" data-ko="ã…•"><div class="key-dual"><span class="key-en">U</span><span class="key-ko">ã…•</span></div></div>
                            <div class="key" data-key="i" data-ko="ã…‘"><div class="key-dual"><span class="key-en">I</span><span class="key-ko">ã…‘</span></div></div>
                            <div class="key" data-key="o" data-ko="ã…"><div class="key-dual"><span class="key-en">O</span><span class="key-ko">ã…</span></div></div>
                            <div class="key" data-key="p" data-ko="ã…”"><div class="key-dual"><span class="key-en">P</span><span class="key-ko">ã…”</span></div></div>
                            <div class="key" data-key="[" data-ko=""><div class="key-dual"><span class="key-en">[</span><span class="key-ko"></span></div></div>
                            <div class="key" data-key="]" data-ko=""><div class="key-dual"><span class="key-en">]</span><span class="key-ko"></span></div></div>
                            <div class="key" data-key="\\" data-ko=""><div class="key-dual"><span class="key-en">\\</span><span class="key-ko"></span></div></div>
                        </div>
                        <div class="keyboard-row">
                            <div class="key caps" data-key="CapsLock">Caps</div>
                            <div class="key" data-key="a" data-ko="ã…"><div class="key-dual"><span class="key-en">A</span><span class="key-ko">ã…</span></div></div>
                            <div class="key" data-key="s" data-ko="ã„´"><div class="key-dual"><span class="key-en">S</span><span class="key-ko">ã„´</span></div></div>
                            <div class="key" data-key="d" data-ko="ã…‡"><div class="key-dual"><span class="key-en">D</span><span class="key-ko">ã…‡</span></div></div>
                            <div class="key" data-key="f" data-ko="ã„¹"><div class="key-dual"><span class="key-en">F</span><span class="key-ko">ã„¹</span></div></div>
                            <div class="key" data-key="g" data-ko="ã…"><div class="key-dual"><span class="key-en">G</span><span class="key-ko">ã…</span></div></div>
                            <div class="key" data-key="h" data-ko="ã…—"><div class="key-dual"><span class="key-en">H</span><span class="key-ko">ã…—</span></div></div>
                            <div class="key" data-key="j" data-ko="ã…“"><div class="key-dual"><span class="key-en">J</span><span class="key-ko">ã…“</span></div></div>
                            <div class="key" data-key="k" data-ko="ã…"><div class="key-dual"><span class="key-en">K</span><span class="key-ko">ã…</span></div></div>
                            <div class="key" data-key="l" data-ko="ã…£"><div class="key-dual"><span class="key-en">L</span><span class="key-ko">ã…£</span></div></div>
                            <div class="key" data-key=";" data-ko=""><div class="key-dual"><span class="key-en">;</span><span class="key-ko"></span></div></div>
                            <div class="key" data-key="'" data-ko=""><div class="key-dual"><span class="key-en">'</span><span class="key-ko"></span></div></div>
                            <div class="key enter" data-key="Enter">Enter</div>
                        </div>
                        <div class="keyboard-row">
                            <div class="key shift" data-key="ShiftLeft">Shift</div>
                            <div class="key" data-key="z" data-ko="ã…‹"><div class="key-dual"><span class="key-en">Z</span><span class="key-ko">ã…‹</span></div></div>
                            <div class="key" data-key="x" data-ko="ã…Œ"><div class="key-dual"><span class="key-en">X</span><span class="key-ko">ã…Œ</span></div></div>
                            <div class="key" data-key="c" data-ko="ã…Š"><div class="key-dual"><span class="key-en">C</span><span class="key-ko">ã…Š</span></div></div>
                            <div class="key" data-key="v" data-ko="ã…"><div class="key-dual"><span class="key-en">V</span><span class="key-ko">ã…</span></div></div>
                            <div class="key" data-key="b" data-ko="ã… "><div class="key-dual"><span class="key-en">B</span><span class="key-ko">ã… </span></div></div>
                            <div class="key" data-key="n" data-ko="ã…œ"><div class="key-dual"><span class="key-en">N</span><span class="key-ko">ã…œ</span></div></div>
                            <div class="key" data-key="m" data-ko="ã…¡"><div class="key-dual"><span class="key-en">M</span><span class="key-ko">ã…¡</span></div></div>
                            <div class="key" data-key="," data-ko=""><div class="key-dual"><span class="key-en">,</span><span class="key-ko"></span></div></div>
                            <div class="key" data-key="." data-ko=""><div class="key-dual"><span class="key-en">.</span><span class="key-ko"></span></div></div>
                            <div class="key" data-key="/" data-ko=""><div class="key-dual"><span class="key-en">/</span><span class="key-ko"></span></div></div>
                            <div class="key shift" data-key="ShiftRight">Shift</div>
                        </div>
                        <div class="keyboard-row">
                            <div class="key wide" data-key="ControlLeft">Ctrl</div>
                            <div class="key wide" data-key="MetaLeft">Win</div>
                            <div class="key wide" data-key="AltLeft">Alt</div>
                            <div class="key space" data-key=" ">Space</div>
                            <div class="key wide" data-key="AltRight">Alt</div>
                            <div class="key wide" data-key="MetaRight">Win</div>
                            <div class="key wide" data-key="ContextMenu">Menu</div>
                            <div class="key wide" data-key="ControlRight">Ctrl</div>
                        </div>
                    </div>
                </div>

                <div class="input-area">
                    <input type="text" class="typing-input" id="typingInput" placeholder="ì—¬ê¸°ì— íƒ€ì´í•‘í•˜ì„¸ìš”...">
                </div>
            </div>

            <!-- Stats -->
            <div class="stats">
                <div class="stat-item">
                    <div class="stat-value" id="accuracy">100%</div>
                    <div class="stat-label">ì •í™•ë„</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="speed">0</div>
                    <div class="stat-label">íƒ€ì/ë¶„</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="progress">0/10</div>
                    <div class="stat-label">ì§„í–‰ë¥ </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Complete Modal -->
    <div class="modal" id="completeModal" style="display: none;">
        <div class="modal-content" id="modalContent">
            <h2 class="complete-title">ì—°ìŠµ ì™„ë£Œ! ğŸ‰</h2>
            <div class="complete-stats">
                <div class="complete-stat">
                    <div class="complete-value" id="finalAccuracy">100%</div>
                    <div class="complete-label">ìµœì¢… ì •í™•ë„</div>
                </div>
                <div class="complete-stat">
                    <div class="complete-value" id="finalSpeed">0</div>
                    <div class="complete-label">í‰ê·  ì†ë„</div>
                </div>
            </div>
            <div class="modal-buttons">
                <button class="restart-btn" id="restartBtn">ë‹¤ì‹œ ì‹œì‘</button>
            </div>
        </div>
    </div>

    <script>
        class KoreanTypingPractice {
            constructor() {
                this.currentMode = 'consonant';
                this.currentText = '';
                this.currentPosition = 0;
                this.startTime = null;
                this.currentJamoSequence = [];
                this.currentJamoPosition = 0;
                this.currentProblem = 0;
                this.totalProblems = 10;
                this.usedWords = [];
                this.usedSentences = [];

                // AI ë¶„ì„ìš© ë°ì´í„° (ë¬¸ì¥ì—°ìŠµ ì „ìš©)
                this.sentenceTypingData = [];
                this.sentenceMistakes = [];
                this.sentenceKeyTimings = [];
                this.sentenceStartTime = null;
                this.lastKeyTime = null;
                this.lastKeyPressed = null;
                this.keyTransitions = []; // í‚¤ ì´ë™ íŒ¨í„´ ë¶„ì„ìš©
                
                // ê° ë¬¸ì¥ë³„ í†µê³„ ì €ì¥ìš© (ìƒˆë¡œ ì¶”ê°€)
                this.sentenceStats = [];

                // í•œê¸€ ìëª¨ ë§¤í•‘
                this.koreanKeyMap = {
                    'q': 'ã…‚', 'w': 'ã…ˆ', 'e': 'ã„·', 'r': 'ã„±', 't': 'ã……',
                    'y': 'ã…›', 'u': 'ã…•', 'i': 'ã…‘', 'o': 'ã…', 'p': 'ã…”',
                    'a': 'ã…', 's': 'ã„´', 'd': 'ã…‡', 'f': 'ã„¹', 'g': 'ã…',
                    'h': 'ã…—', 'j': 'ã…“', 'k': 'ã…', 'l': 'ã…£',
                    'z': 'ã…‹', 'x': 'ã…Œ', 'c': 'ã…Š', 'v': 'ã…',
                    'b': 'ã… ', 'n': 'ã…œ', 'm': 'ã…¡'
                };

                // í‚¤ë³´ë“œ ë§¤í•‘ (í•œê¸€ ìëª¨ -> í‚¤)
                this.keyboardMap = {};
                for (let [key, korean] of Object.entries(this.koreanKeyMap)) {
                    this.keyboardMap[korean] = key;
                }

                // ì¶”ê°€ í•œê¸€ ìëª¨ ë§¤í•‘ (ë³µí•©ëª¨ìŒ, ìŒììŒ)
                this.keyboardMap['ã„²'] = 'r';
                this.keyboardMap['ã„¸'] = 'e';
                this.keyboardMap['ã…ƒ'] = 'q';
                this.keyboardMap['ã…†'] = 't';
                this.keyboardMap['ã…‰'] = 'w';
                this.keyboardMap['ã…’'] = 'o';
                this.keyboardMap['ã…–'] = 'p';
                this.keyboardMap[' '] = ' ';

                // ë³µí•©ëª¨ìŒ ë§¤í•‘ (ë™ì‹œì— ë‘ í‚¤ ê°•ì¡°ìš©)
                this.complexVowelMap = {
                    'ã…˜': ['h', 'k'], 'ã…™': ['h', 'o'], 'ã…š': ['h', 'l'],
                    'ã…': ['n', 'j'], 'ã…': ['n', 'p'], 'ã…Ÿ': ['n', 'l'], 'ã…¢': ['m', 'l']
                };

                // í‚¤ë³´ë“œ ìœ„ì¹˜ ë§¤í•‘ (í–‰, ì—´ ì¢Œí‘œ)
                this.keyPositions = {
                    'q': [1, 0], 'w': [1, 1], 'e': [1, 2], 'r': [1, 3], 't': [1, 4],
                    'y': [1, 5], 'u': [1, 6], 'i': [1, 7], 'o': [1, 8], 'p': [1, 9],
                    'a': [2, 0], 's': [2, 1], 'd': [2, 2], 'f': [2, 3], 'g': [2, 4],
                    'h': [2, 5], 'j': [2, 6], 'k': [2, 7], 'l': [2, 8],
                    'z': [3, 0], 'x': [3, 1], 'c': [3, 2], 'v': [3, 3], 'b': [3, 4],
                    'n': [3, 5], 'm': [3, 6], ' ': [4, 0] // ìŠ¤í˜ì´ìŠ¤ë°”
                };

                // ì†ê°€ë½ë³„ í‚¤ í• ë‹¹
                this.fingerAssignment = {
                    'q': 'ì™¼ìƒˆë¼', 'a': 'ì™¼ìƒˆë¼', 'z': 'ì™¼ìƒˆë¼',
                    'w': 'ì™¼ì•½ì§€', 's': 'ì™¼ì•½ì§€', 'x': 'ì™¼ì•½ì§€',
                    'e': 'ì™¼ì¤‘ì§€', 'd': 'ì™¼ì¤‘ì§€', 'c': 'ì™¼ì¤‘ì§€',
                    'r': 'ì™¼ê²€ì§€', 'f': 'ì™¼ê²€ì§€', 'v': 'ì™¼ê²€ì§€', 't': 'ì™¼ê²€ì§€', 'g': 'ì™¼ê²€ì§€', 'b': 'ì™¼ê²€ì§€',
                    'y': 'ì˜¤ê²€ì§€', 'h': 'ì˜¤ê²€ì§€', 'n': 'ì˜¤ê²€ì§€', 'u': 'ì˜¤ê²€ì§€', 'j': 'ì˜¤ê²€ì§€', 'm': 'ì˜¤ê²€ì§€',
                    'i': 'ì˜¤ì¤‘ì§€', 'k': 'ì˜¤ì¤‘ì§€',
                    'o': 'ì˜¤ì•½ì§€', 'l': 'ì˜¤ì•½ì§€',
                    'p': 'ì˜¤ìƒˆë¼',
                    ' ': 'ì—„ì§€'
                };

                this.practiceData = {
                    consonant: ['ã„±', 'ã„´', 'ã„·', 'ã„¹', 'ã…', 'ã…‚', 'ã……', 'ã…‡', 'ã…ˆ', 'ã…Š', 'ã…‹', 'ã…Œ', 'ã…', 'ã…', 'ã„²', 'ã„¸', 'ã…ƒ', 'ã…†', 'ã…‰'],
                    vowel: ['ã…', 'ã…‘', 'ã…“', 'ã…•', 'ã…—', 'ã…›', 'ã…œ', 'ã… ', 'ã…¡', 'ã…£', 'ã…', 'ã…’', 'ã…”', 'ã…–', 'ã…˜', 'ã…™', 'ã…š', 'ã…', 'ã…', 'ã…Ÿ', 'ã…¢'],
                    word: {
                        easy: [
                            'ì‚¬ëŒ', 'í•™êµ', 'ì§‘', 'ë¬¼', 'ë¶ˆ', 'í•˜ëŠ˜', 'ë•…', 'ë°”ë‹¤', 'ì‚°', 'ê°•',
                            'ë‚˜ë¬´', 'ê½ƒ', 'ìƒˆ', 'ê³ ì–‘ì´', 'ê°œ', 'ì±…', 'ì—°í•„', 'ì˜ì', 'ì±…ìƒ', 'ë¬¸',
                            'ì°½ë¬¸', 'ì‹œê³„', 'ì „í™”', 'ì»´í“¨í„°', 'í…”ë ˆë¹„ì „', 'ëƒ‰ì¥ê³ ', 'ì¹¨ëŒ€', 'ì†ŒíŒŒ', 'ë°¥', 'ë¹µ',
                            'ìš°ìœ ', 'ì‚¬ê³¼', 'ë°”ë‚˜ë‚˜', 'ë”¸ê¸°', 'í¬ë„', 'ì˜¤ë Œì§€', 'ì•„ì¹¨', 'ì ì‹¬', 'ì €ë…', 'ì›”ìš”ì¼',
                            'í™”ìš”ì¼', 'ìˆ˜ìš”ì¼', 'ëª©ìš”ì¼', 'ê¸ˆìš”ì¼', 'í† ìš”ì¼', 'ì¼ìš”ì¼', 'ë´„', 'ì—¬ë¦„', 'ê°€ì„', 'ê²¨ìš¸',
                            'ë‚ ì”¨', 'ë¹„', 'ëˆˆ', 'ë°”ëŒ', 'êµ¬ë¦„', 'í•´', 'ë‹¬', 'ë³„', 'ë¹¨ê°„ìƒ‰', 'íŒŒë€ìƒ‰',
                            'ë…¸ë€ìƒ‰', 'ì´ˆë¡ìƒ‰', 'í•˜ì–€ìƒ‰', 'ê²€ì€ìƒ‰', 'ì—„ë§ˆ', 'ì•„ë¹ ', 'í˜•', 'ë™ìƒ', 'í• ë¨¸ë‹ˆ', 'í• ì•„ë²„ì§€',
                            'ë³‘ì›', 'ì•½êµ­', 'ì€í–‰', 'ìš°ì²´êµ­', 'ë§ˆíŠ¸', 'ê°€ê²Œ', 'ë²„ìŠ¤', 'ì§€í•˜ì² ', 'íƒì‹œ', 'ìì „ê±°',
                            'ìë™ì°¨', 'ë¹„í–‰ê¸°', 'ê¸°ì°¨', 'ë°°', 'ë°”ì§€', 'ì¹˜ë§ˆ', 'ì˜·', 'ì‹ ë°œ', 'ëª¨ì', 'ê°€ë°©',
                            'ìš°ì‚°', 'ëˆ', 'ì¹´ë“œ', 'íœ´ëŒ€í°', 'ë…¸íŠ¸ë¶', 'ë§ˆìš°ìŠ¤', 'í‚¤ë³´ë“œ', 'ìŒì‹', 'ë¬¼ê±´', 'ì¥ë‚œê°',
                            'ìš´ë™', 'ì¶•êµ¬', 'ì•¼êµ¬', 'ë†êµ¬', 'ìˆ˜ì˜', 'ë‹¬ë¦¬ê¸°'
                        ],
                        medium: [
                            'ì •ì¹˜', 'ê²½ì œ', 'ì‚¬íšŒ', 'ë¬¸í™”', 'ê³¼í•™', 'ê¸°ìˆ ', 'ì—­ì‚¬', 'ì² í•™', 'ì˜ˆìˆ ', 'ìŒì•…',
                            'ë¬¸í•™', 'ì†Œì„¤', 'ì‹œì¸', 'ì‘ê°€', 'íˆ¬ì', 'ì£¼ì‹', 'ë¶€ë™ì‚°', 'ì°½ì—…', 'í˜ì‹ ', 'ë¦¬ë”ì‹­',
                            'ë„ì „', 'ì„±ê³µ', 'ì‹¤íŒ¨', 'ì„±ì¥', 'ë³€í™”', 'ê¸°íšŒ', 'ê¿ˆ', 'ëª©í‘œ', 'ì—´ì •', 'ë…¸ë ¥',
                            'ì¸ë‚´', 'ìš©ê¸°', 'í¬ë§', 'ìì‹ ê°', 'ì±…ì„', 'ì •ì˜', 'í‰ë“±', 'ììœ ', 'ë¯¼ì£¼ì£¼ì˜', 'ì¸ê¶Œ',
                            'í™˜ê²½', 'ê¸°í›„', 'ì—ë„ˆì§€', 'ë¯¸ë˜', 'ë°œì „', 'êµìœ¡', 'ì—°êµ¬', 'ì‹¤í—˜', 'ë°œê²¬', 'ì°½ì‘',
                            'ì˜ê°', 'ìƒìƒë ¥', 'ì§€í˜œ', 'ì§€ì‹', 'ì§„ë¦¬', 'ì•„ë¦„ë‹¤ì›€', 'ê°ë™', 'ì‚¬ë‘', 'ìš°ì •', 'ê°€ì¡±',
                            'ê³µë™ì²´', 'ì†Œí†µ', 'ì´í•´', 'ë°°ë ¤', 'ê°ì‚¬', 'í–‰ë³µ', 'í‰í™”', 'ê±´ê°•', 'ì—¬í–‰', 'ëª¨í—˜',
                            'ê²½í—˜', 'ì¶”ì–µ', 'ì‹œê°„', 'ê³µê°„', 'ìì—°', 'ë„ì‹œ', 'ë¬¸ëª…', 'ì „í†µ', 'í˜„ëŒ€', 'ê¸€ë¡œë²Œ',
                            'ë””ì§€í„¸', 'ì¸ê³µì§€ëŠ¥', 'ë¡œë´‡', 'ìš°ì£¼', 'ìƒëª…', 'ì˜ë£Œ', 'ì¹˜ë£Œ', 'ì˜ˆë°©', 'ìš´ë™', 'ìŠ¤í¬ì¸ ',
                            'ì „ëµ', 'ê³„íš', 'ê´€ë¦¬', 'ë¶„ì„', 'í‰ê°€', 'ê°œì„ ', 'íš¨ìœ¨', 'í’ˆì§ˆ', 'ì„œë¹„ìŠ¤', 'ê³ ê°',
                            'ì‹œì¥', 'ê²½ìŸ', 'í˜‘ë ¥', 'ë„¤íŠ¸ì›Œí¬', 'í”Œë«í¼', 'ë°ì´í„°', 'ì •ë³´', 'í†µì‹ ', 'ë³´ì•ˆ', 'ê°œì¸ì •ë³´', 'í”„ë¼ì´ë²„ì‹œ'
                        ],
                        hard: [
                            'ë¿Œë¦¬ê¹Šì€', 'ë¹¨ê°›ê²Œ', 'ê¹Œë§£ê²Œ', 'ë½€ì–—ê²Œ', 'ë¹ ëœ¨ë¦¬ë‹¤', 'ëœ¨ëœ»ë¯¸ì§€ê·¼í•˜ë‹¤', 'êº¼ì¹ êº¼ì¹ í•˜ë‹¤', 'ì‚ê±±ì‚ê±±', 'ë’¤ëš±ë’¤ëš±', 'ì—‡ê°ˆë¦¬ë‹¤',
                            'ì–½í˜€ìˆë‹¤', 'ì›…ì„±ì›…ì„±', 'ìš°ë¥´ë¥´', 'ìê¸€ìê¸€', 'ì­ˆê¸€ì­ˆê¸€', 'ë–¨ë– ë¦„í•˜ë‹¤', 'ìš°ê¸€ìš°ê¸€', 'ì‘¥ìŠ¤ëŸ½ë‹¤', 'ì—‰ì„±í•˜ë‹¤', 'ì‚ëš¤ì–´ì§€ë‹¤',
                            'ê¹œë¹¡ê¹œë¹¡', 'íë­‡í•˜ë‹¤', 'ì•„ëœ©í•˜ë‹¤', 'ê¹ŒíƒˆìŠ¤ëŸ½ë‹¤', 'ê¹”ë”í•˜ë‹¤', 'ê¹Œë¬´ì¡ì¡í•˜ë‹¤', 'ë¹¼ê³¡í•˜ë‹¤', 'ë¹™ê¸€ë¹™ê¸€', 'ê»„ê»„ì›ƒë‹¤', 'í‚¥í‚¥ê±°ë¦¬ë‹¤',
                            'ì”©ì”©í•˜ë‹¤', 'ì­‰ì­‰ë»—ë‹¤', 'íœ˜ì²­íœ˜ì²­', 'í”ë“¤í”ë“¤', 'ìš¸í‰ë¶ˆí‰', 'ë°êµ´ë°êµ´', 'ë±…ê¸€ë±…ê¸€', 'ê»‘ì¶©ê»‘ì¶©', 'íŒ”ë‘íŒ”ë‘', 'í„ëŸ­í„ëŸ­',
                            'ë‚˜í’€ë‚˜í’€', 'ì‚´ë‘ì‚´ë‘', 'ì£¼ë ì£¼ë ', 'ì¡¸ì¡¸íë¥´ë‹¤', 'ì°°ë‘ì°°ë‘', 'ì¶œë ì¶œë ', 'ì¶œë ê±°ë¦¬ë‹¤', 'ì² ì©ì² ì©', 'ì²¨ë²™ì²¨ë²™', 'ë›°ì–´ì˜¬ë¼ê°€ë‹¤',
                            'ì£¼ì €ì•‰ë‹¤', 'ì—ë“œë¦¬ë‹¤', 'ìš°ëšì„œë‹¤', 'ë’¤ëŒì•„ë³´ë‹¤', 'ë‚´ë ¤ë‹¤ë³´ë‹¤', 'ì˜¬ë ¤ë‹¤ë³´ë‹¤', 'ê°€ë¡œì§ˆëŸ¬ê°€ë‹¤', 'ë¹„í‹€ê±°ë¦¬ë‹¤', 'ë’¤ëš±ê±°ë¦¬ë‹¤', 'ë¹„ìŠ¤ë“¬íˆ',
                            'ì•„ìŠ¬ì•„ìŠ¬', 'ê°€íŒŒë¥´ë‹¤', 'ë¾°ì¡±í•˜ë‹¤', 'ë‘ë£¨ë­‰ìˆ í•˜ë‹¤', 'ì–´ê¹¨ë™ë¬´í•˜ë‹¤', 'ì†ë¼‰ì¹˜ë‹¤', 'ë°œê°€ë½ì§ˆí•˜ë‹¤', 'ëˆˆì§“í•˜ë‹¤', 'ë¨¸ë¦¬ê°ë‹¤', 'ì´ë§ˆì°¡ê·¸ë¦¬ë‹¤',
                            'ì½”ì›ƒìŒì¹˜ë‹¤', 'ì…ê¾¸ë¬¼ê±°ë¦¬ë‹¤'
                        ]
                    },
                    sentence: [
                        'ì°½ì—… ìƒíƒœê³„ ì¡°ì„±ì´ êµ­ê°€ ê²½ìŸë ¥ í–¥ìƒì˜ í•µì‹¬ì…ë‹ˆë‹¤.',
                        'ë¹„í–‰ê¸° ëª¨ë“œë¡œ ì¶©ì „í•˜ë©´ ì†ë„ê°€ í›¨ì”¬ ë¹¨ë¼ì ¸ìš”.',
                        'ê²½ì œ ì„±ì¥ê³¼ ì‚¬íšŒ ë°œì „ì€ ì„œë¡œ ë°€ì ‘í•œ ê´€ë ¨ì´ ìˆìŠµë‹ˆë‹¤.',
                        'ë² ì´í‚¹ì†Œë‹¤ë¡œ ë¨¸ê·¸ì»µ ì–¼ë£©ì„ ê°„ë‹¨íˆ ì§€ìš¸ ìˆ˜ ìˆì£ .',
                        'ì¸ê³µì§€ëŠ¥ì´ ì¸ê°„ì˜ ì‚¶ì„ ì–´ë–»ê²Œ ë³€í™”ì‹œí‚¬ê¹Œìš”?',
                        'ì˜·ì— ê»Œ ë¬»ì—ˆì„ ë• ëƒ‰ë™ í›„ì— ë–¼ë©´ í¸í•˜ë‹µë‹ˆë‹¤.',
                        'ë¬¸í™” ë‹¤ì–‘ì„±ì„ ì¡´ì¤‘í•˜ëŠ” ì‚¬íšŒê°€ ë”ìš± ë°œì „í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.',
                        'ì‹ ë°œ ì†ì— í‹°ë°± ë„£ìœ¼ë©´ ëƒ„ìƒˆê°€ ê¸ˆë°© ì‚¬ë¼ì ¸ìš”.',
                        'ê¸°ìˆ  í˜ì‹ ì´ ìš°ë¦¬ì˜ ë¯¸ë˜ë¥¼ ë°”ê¾¸ê³  ìˆìŠµë‹ˆë‹¤.',
                        'ë¬¼ë³‘ì— ì‹œê°„ í‘œì‹œë¥¼ í•´ë‘ë©´ ë¬¼ ì„­ì·¨ëŸ‰ì´ ëŠ˜ì–´ìš”.',
                        'ì†Œì…œë¯¸ë””ì–´ëŠ” í˜„ëŒ€ì¸ì˜ ì˜ì‚¬ì†Œí†µì„ í¬ê²Œ ë³€í™”ì‹œì¼°ìŠµë‹ˆë‹¤.',
                        'ì¼€ì´ë¸” ëì— ìŠ¤í”„ë§ì„ ê°ì•„ êº¾ì„ì„ ì˜ˆë°©í•˜ì„¸ìš”.',
                        'ë¯¼ì£¼ì£¼ì˜ëŠ” ì‹œë¯¼ì˜ ì°¸ì—¬ë¡œ ì™„ì„±ë©ë‹ˆë‹¤.',
                        'ì„¸íƒê¸°ì— ì‹ì´ˆ+ê³ ì˜¨ì„¸íƒìœ¼ë¡œ ëƒ„ìƒˆë¥¼ ì—†ì•¨ ìˆ˜ ìˆì£ .',
                        'êµìœ¡ì˜ í˜ìœ¼ë¡œ ë” ë‚˜ì€ ì„¸ìƒì„ ë§Œë“¤ì–´ê°‘ì‹œë‹¤.',
                        'ì–‘íŒŒë¥¼ ëƒ‰ë™ 10ë¶„ ë’¤ ìë¥´ë©´ ëˆˆë¬¼ì´ ëœ ë‚œë‹µë‹ˆë‹¤.',
                        'í™˜ê²½ ë³´í˜¸ëŠ” ë‹¤ìŒ ì„¸ëŒ€ë¥¼ ìœ„í•œ ì¤‘ìš”í•œ ê³¼ì œì…ë‹ˆë‹¤.',
                        'ì˜·ì¥ ì† ìŠµê¸°ëŠ” ì‹ ë¬¸ì§€ë¡œë„ ì‰½ê²Œ ì¡ì„ ìˆ˜ ìˆì–´ìš”.',
                        'ê¸€ë¡œë²Œ ì‹œëŒ€ì—ëŠ” ì†Œí†µ ëŠ¥ë ¥ì´ í•„ìˆ˜ì…ë‹ˆë‹¤.',
                        'ì”¨ ì—†ëŠ” í¬ë„ ì–¼ë¦¬ë©´ ë‹¬ì½¤í•œ ê°„ì‹ì´ ë˜ì£ .',
                        'ì§€ì†ê°€ëŠ¥í•œ ë°œì „ì„ ìœ„í•´ì„œëŠ” ëª¨ë‘ì˜ ë…¸ë ¥ì´ í•„ìš”í•©ë‹ˆë‹¤.',
                        'íœ´ì§€ì‹¬ì— ë¹„ë‹ ë„£ìœ¼ë©´ ê¹”ë”í•˜ê²Œ ë½‘ì•„ ì“°ê¸° ì¢‹ì•„ìš”.',
                        'ì‹¤íŒ¨ëŠ” ì„±ê³µìœ¼ë¡œ ê°€ëŠ” ê³¼ì •ì¼ ë¿ì…ë‹ˆë‹¤.',
                        'ëƒ„ë¹„ ìœ„ ë‚˜ë¬´ì£¼ê±± ì˜¬ë ¤ë‘ë©´ ê±°í’ˆì´ ì•ˆ ë„˜ì¹˜ì£ .',
                        'ê¸°í›„ë³€í™” ëŒ€ì‘ì„ ìœ„í•œ êµ­ì œì  í˜‘ë ¥ì´ ì‹œê¸‰í•©ë‹ˆë‹¤.',
                        'ê±°ìš¸ì— ë¹„ëˆ„ì¹ í•˜ë©´ ê¹€ì„œë¦¼ ì—†ì´ ì“¸ ìˆ˜ ìˆë‹µë‹ˆë‹¤.',
                        'ê¿ˆì„ í¬ê¸°í•˜ì§€ ì•ŠëŠ” ì‚¬ëŒë§Œì´ ì„±ê³µí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.',
                        'íœ´ì§€ì‹¬ ë¬¼ì£¼ê¸°ëŠ” í™”ë¶„ ê³¼ìŠµ ë°©ì§€ì— íš¨ê³¼ ìˆì£ .',
                        'ê±´ê°•í•œ ë¼ì´í”„ìŠ¤íƒ€ì¼ì„ ìœ ì§€í•˜ëŠ” ê²ƒì€ ë§¤ìš° ì¤‘ìš”í•©ë‹ˆë‹¤.',
                        'ì§€í¼ì— ì—°í•„ì‹¬ ë¬¸ì§€ë¥´ë©´ ì˜ ì˜¬ë¼ê°„ë‹µë‹ˆë‹¤.',
                        'ë””ì§€í„¸ ì „í™˜ì´ ëª¨ë“  ì‚°ì—… ë¶„ì•¼ì— ì˜í–¥ì„ ë¯¸ì¹˜ê³  ìˆìŠµë‹ˆë‹¤.',
                        'ë¹µ ë´‰ì§€ì— ì‚¬ê³¼ ë„£ìœ¼ë©´ ì‹ ì„ í•˜ê²Œ ë³´ê´€ë¼ìš”.',
                        'ì¸ê°„ê´€ê³„ì—ì„œ ì§„ì •ì„±ê³¼ ì‹ ë¢°ê°€ ê°€ì¥ ì¤‘ìš”í•œ ê°€ì¹˜ì…ë‹ˆë‹¤.',
                        'ì°½ì˜ì  ì‚¬ê³ ê°€ ë¬¸ì œ í•´ê²°ì˜ ì—´ì‡ ì…ë‹ˆë‹¤.',
                        'ìŠ¤ë§ˆíŠ¸ ê¸°ìˆ ì´ ì¼ìƒìƒí™œì„ í¸ë¦¬í•˜ê²Œ ë§Œë“¤ì–´ì£¼ê³  ìˆìŠµë‹ˆë‹¤.',
                        'í‰ìƒí•™ìŠµì€ ê¸‰ë³€í•˜ëŠ” ì‹œëŒ€ë¥¼ ì‚´ì•„ê°€ëŠ” í•„ìˆ˜ ì¡°ê±´ì…ë‹ˆë‹¤.'
                    ]
                };

                this.init();
            }

            init() {
                this.bindEvents();
                this.generateText();
                this.updateDisplay();
                
                // ì´ˆê¸° í…ìŠ¤íŠ¸ í‘œì‹œ í™•ì¸ ë° ê°•ì œ ì„¤ì •
                setTimeout(() => {
                    const display = document.getElementById('textDisplay');
                    if (!display.innerHTML || display.innerHTML.trim() === '' || !this.currentText) {
                        // ê°•ì œë¡œ ê¸°ë³¸ í…ìŠ¤íŠ¸ ì„¤ì •
                        this.currentText = 'ã„± ã„´ ã„· ã„¹ ã… ã…‚ ã……';
                        this.currentPosition = 0;
                        this.generateJamoSequence();
                        this.updateDisplay();
                    }
                }, 100);
            }

            bindEvents() {
                document.querySelectorAll('.menu-btn').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        this.changeMode(e.target.dataset.mode);
                    });
                });

                const typingInput = document.getElementById('typingInput');
                
                typingInput.addEventListener('input', (e) => {
                    try {
                        this.handleInput(e.target.value);
                    } catch (error) {
                        document.getElementById('accuracy').textContent = '100%';
                        document.getElementById('speed').textContent = '0';
                    }
                });

                typingInput.addEventListener('keydown', (e) => {
                    // ë¬¸ì¥ì—°ìŠµì—ì„œë§Œ í‚¤ íƒ€ì´ë° ê¸°ë¡
                    if (this.currentMode === 'sentence') {
                        this.recordKeyTiming(e.key);
                    }
                    
                    if ((e.key === ' ' || e.key === 'Enter') && this.currentPosition >= this.currentText.length) {
                        e.preventDefault();
                        
                        // ë¬¸ì¥ ì™„ë£Œ ì‹œ í†µê³„ ì €ì¥ í™•ì¸
                        if (this.currentMode === 'sentence') {
                            const currentAccuracy = parseInt(document.getElementById('accuracy').textContent.replace('%', ''));
                            const currentSpeed = parseInt(document.getElementById('speed').textContent);
                            
                            // ì´ë¯¸ ì €ì¥ë˜ì—ˆëŠ”ì§€ í™•ì¸
                            const alreadyStored = this.sentenceStats.some(stat => stat.sentenceNumber === this.currentProblem + 1);
                            
                            if (!alreadyStored) {
                                const sentenceData = {
                                    sentenceNumber: this.currentProblem + 1,
                                    accuracy: currentAccuracy,
                                    speed: currentSpeed
                                };
                                
                                this.sentenceStats.push(sentenceData);
                                console.log(`í‚¤ë‹¤ìš´ì—ì„œ ë¬¸ì¥${this.currentProblem + 1} ì €ì¥ - ì •í™•ë„: ${currentAccuracy}%, ì†ë„: ${currentSpeed}íƒ€/ë¶„`);
                            }
                        }
                        
                        this.nextProblem();
                    }
                });

                document.getElementById('restartBtn').addEventListener('click', () => {
                    this.restart();
                });
            }

            recordKeyTiming(key) {
                const now = Date.now();
                if (this.lastKeyTime) {
                    const interval = now - this.lastKeyTime;
                    this.sentenceKeyTimings.push({
                        key: key,
                        interval: interval,
                        position: this.currentPosition,
                        timestamp: now - this.sentenceStartTime
                    });

                    // í‚¤ ì´ë™ íŒ¨í„´ ë¶„ì„
                    if (this.lastKeyPressed && key !== this.lastKeyPressed) {
                        const fromKey = this.lastKeyPressed.toLowerCase();
                        const toKey = key.toLowerCase();
                        
                        // ì˜ë¬¸ í‚¤ë§Œ ë¶„ì„ (í•œê¸€ ìëª¨ëŠ” ì˜ë¬¸ í‚¤ë¡œ ë³€í™˜)
                        const fromEngKey = this.getEnglishKey(fromKey);
                        const toEngKey = this.getEnglishKey(toKey);
                        
                        if (fromEngKey && toEngKey && this.keyPositions[fromEngKey] && this.keyPositions[toEngKey]) {
                            this.keyTransitions.push({
                                from: fromEngKey,
                                to: toEngKey,
                                fromChar: this.lastKeyPressed,
                                toChar: key,
                                interval: interval,
                                distance: this.calculateKeyDistance(fromEngKey, toEngKey),
                                fingerTransition: this.getFingerTransition(fromEngKey, toEngKey)
                            });
                        }
                    }
                }
                this.lastKeyTime = now;
                this.lastKeyPressed = key;
            }

            getEnglishKey(key) {
                // í•œê¸€ ìëª¨ë¥¼ ì˜ë¬¸ í‚¤ë¡œ ë³€í™˜
                for (let [engKey, korChar] of Object.entries(this.koreanKeyMap)) {
                    if (korChar === key) return engKey;
                }
                // ì´ë¯¸ ì˜ë¬¸ì´ë©´ ê·¸ëŒ€ë¡œ ë°˜í™˜
                return key === ' ' ? ' ' : key.toLowerCase();
            }

            calculateKeyDistance(key1, key2) {
                const pos1 = this.keyPositions[key1];
                const pos2 = this.keyPositions[key2];
                if (!pos1 || !pos2) return 0;
                
                // ìœ í´ë¦¬ë“œ ê±°ë¦¬ ê³„ì‚°
                return Math.sqrt(Math.pow(pos2[0] - pos1[0], 2) + Math.pow(pos2[1] - pos1[1], 2));
            }

            getFingerTransition(key1, key2) {
                const finger1 = this.fingerAssignment[key1];
                const finger2 = this.fingerAssignment[key2];
                
                if (finger1 === finger2) return 'ê°™ì€ì†ê°€ë½';
                if (finger1 && finger2) {
                    if ((finger1.includes('ì™¼') && finger2.includes('ì™¼')) || 
                        (finger1.includes('ì˜¤') && finger2.includes('ì˜¤'))) {
                        return 'ê°™ì€ì†';
                    }
                    return 'ë‹¤ë¥¸ì†';
                }
                return 'ì•Œìˆ˜ì—†ìŒ';
            }

            changeMode(mode) {
                this.currentMode = mode;
                this.currentProblem = 0;
                this.resetStats();
                
                // ë¬¸ì¥ì—°ìŠµìœ¼ë¡œ ë³€ê²½ì‹œ ë¬¸ì œ ìˆ˜ë¥¼ 3ê°œë¡œ ë³€ê²½
                if (mode === 'sentence') {
                    this.totalProblems = 3;
                    this.sentenceTypingData = [];
                    this.sentenceMistakes = [];
                    this.sentenceKeyTimings = [];
                    this.sentenceStats = []; // ë¬¸ì¥ë³„ í†µê³„ ì´ˆê¸°í™”
                } else {
                    this.totalProblems = 10;
                }
                
                document.querySelectorAll('.menu-btn').forEach(btn => {
                    btn.classList.remove('active');
                });
                document.querySelector(`[data-mode="${mode}"]`).classList.add('active');
                
                this.generateText();
                this.updateDisplay();
                document.getElementById('typingInput').value = '';
                document.getElementById('typingInput').focus();
            }

            generateText() {
                const data = this.practiceData[this.currentMode];
                
                try {
                    if (this.currentMode === 'consonant' || this.currentMode === 'vowel') {
                        const selected = [];
                        for (let i = 0; i < 7; i++) {
                            selected.push(data[Math.floor(Math.random() * data.length)]);
                        }
                        this.currentText = selected.join(' ');
                    } else if (this.currentMode === 'word') {
                        const selected = [];
                        const easyWords = this.practiceData.word.easy.filter(word => !this.usedWords.includes(word));
                        const mediumWords = this.practiceData.word.medium.filter(word => !this.usedWords.includes(word));
                        const hardWords = this.practiceData.word.hard.filter(word => !this.usedWords.includes(word));
                        
                        if (easyWords.length === 0 && mediumWords.length === 0 && hardWords.length === 0) {
                            this.usedWords = [];
                        }
                        
                        const availableEasy = easyWords.length > 0 ? easyWords : this.practiceData.word.easy;
                        const availableMedium = mediumWords.length > 0 ? mediumWords : this.practiceData.word.medium;
                        const availableHard = hardWords.length > 0 ? hardWords : this.practiceData.word.hard;
                        
                        const easyWord = availableEasy[Math.floor(Math.random() * availableEasy.length)];
                        const mediumWord = availableMedium[Math.floor(Math.random() * availableMedium.length)];
                        const hardWord = availableHard[Math.floor(Math.random() * availableHard.length)];
                        
                        this.usedWords.push(easyWord, mediumWord, hardWord);
                        
                        const words = [easyWord, mediumWord, hardWord];
                        for (let i = words.length - 1; i > 0; i--) {
                            const j = Math.floor(Math.random() * (i + 1));
                            [words[i], words[j]] = [words[j], words[i]];
                        }
                        
                        this.currentText = words.join(' ');
                    } else {
                        const availableSentences = data.filter(sentence => !this.usedSentences.includes(sentence));
                        
                        if (availableSentences.length === 0) {
                            this.usedSentences = [];
                            availableSentences.push(...data);
                        }
                        
                        const randomIndex = Math.floor(Math.random() * availableSentences.length);
                        this.currentText = availableSentences[randomIndex];
                        
                        this.usedSentences.push(this.currentText);
                    }

                    this.currentPosition = 0;
                    this.startTime = null;
                    this.currentJamoSequence = [];
                    this.currentJamoPosition = 0;

                    // ë¬¸ì¥ì—°ìŠµì—ì„œë§Œ ë¬¸ì¥ë³„ íƒ€ì´ë° ì´ˆê¸°í™”
                    if (this.currentMode === 'sentence') {
                        this.sentenceStartTime = null;
                        this.lastKeyTime = null;
                        this.sentenceKeyTimings = [];
                        this.lastKeyPressed = null;
                        this.keyTransitions = [];
                    }

                    this.generateJamoSequence();
                    this.updateKeyboardHighlight();

                    const textDisplay = document.getElementById('textDisplay');
                    if (this.currentMode === 'sentence') {
                        textDisplay.classList.add('sentence-mode');
                    } else {
                        textDisplay.classList.remove('sentence-mode');
                    }
                } catch (error) {
                    // í…ìŠ¤íŠ¸ ìƒì„± ì˜¤ë¥˜ì‹œ ê¸°ë³¸ í…ìŠ¤íŠ¸ë¡œ fallback
                    this.currentText = this.currentMode === 'consonant' ? 'ã„± ã„´ ã„· ã„¹ ã… ã…‚ ã……' : 
                                     this.currentMode === 'vowel' ? 'ã… ã…‘ ã…“ ã…• ã…— ã…› ã…œ' :
                                     this.currentMode === 'word' ? 'ì‚¬ëŒ í•™êµ ì§‘' :
                                     'ì•ˆë…•í•˜ì„¸ìš” íƒ€ìì—°ìŠµì„ ì‹œì‘í•´ë³´ì„¸ìš”';
                }
            }

            generateJamoSequence() {
                this.currentJamoSequence = [];
                for (let i = 0; i < this.currentText.length; i++) {
                    const char = this.currentText[i];
                    if (char === ' ') {
                        this.currentJamoSequence.push(' ');
                    } else {
                        const decomposed = this.decomposeHangul(char);
                        if (decomposed && decomposed.length > 0) {
                            for (let jamo of decomposed) {
                                this.currentJamoSequence.push(jamo);
                            }
                        } else {
                            this.currentJamoSequence.push(char);
                        }
                    }
                }
            }

            countJaso(text) {
                let jasoCount = 0;
                for (let char of text) {
                    try {
                        if (char === ' ') {
                            jasoCount += 1;
                        } else if (/[ê°€-í£]/.test(char)) {
                            const unicode = char.charCodeAt(0) - 0xAC00;
                            if (unicode >= 0 && unicode <= 11171) {
                                const jong = unicode % 28;
                                jasoCount += 2;
                                if (jong > 0) jasoCount += 1;
                            } else {
                                jasoCount += 1;
                            }
                        } else {
                            jasoCount += 1;
                        }
                    } catch (error) {
                        jasoCount += 1;
                    }
                }
                return jasoCount;
            }

            updateDisplay() {
                try {
                    const display = document.getElementById('textDisplay');
                    display.innerHTML = '';
                    
                    // í…ìŠ¤íŠ¸ê°€ ì—†ìœ¼ë©´ ê¸°ë³¸ê°’ ì„¤ì •
                    if (!this.currentText) {
                        this.currentText = this.currentMode === 'consonant' ? 'ã„± ã„´ ã„· ã„¹ ã… ã…‚ ã……' : 
                                         this.currentMode === 'vowel' ? 'ã… ã…‘ ã…“ ã…• ã…— ã…› ã…œ' :
                                         this.currentMode === 'word' ? 'ì‚¬ëŒ í•™êµ ì§‘' :
                                         'ì•ˆë…•í•˜ì„¸ìš” íƒ€ìì—°ìŠµì„ ì‹œì‘í•´ë³´ì„¸ìš”';
                    }

                    for (let i = 0; i < this.currentText.length; i++) {
                        const span = document.createElement('span');
                        span.className = 'char';
                        
                        if (this.currentText[i] === ' ') {
                            span.innerHTML = '&nbsp;';
                            span.classList.add('space');
                        } else {
                            span.textContent = this.currentText[i];
                        }

                        if (i < this.currentPosition) {
                            span.classList.add('correct');
                        } else if (i === this.currentPosition) {
                            span.classList.add('current');
                        }

                        display.appendChild(span);
                    }

                    if (this.currentMode === 'sentence') {
                        this.applyInitialColors();
                    }

                    this.updateKeyboardHighlight();
                    document.getElementById('progress').textContent = `${this.currentProblem + 1}/${this.totalProblems}`;
                } catch (error) {
                    // UI ë Œë”ë§ ì˜¤ë¥˜ ì‹œ ê¸°ë³¸ í…ìŠ¤íŠ¸ ê°•ì œ í‘œì‹œ
                    const display = document.getElementById('textDisplay');
                    if (display) {
                        display.innerHTML = '<span class="char current">ã„±</span><span class="char"> </span><span class="char">ã„´</span><span class="char"> </span><span class="char">ã„·</span>';
                    }
                }
            }

            decomposeHangul(char) {
                const code = char.charCodeAt(0);
                
                if ((code >= 0x3131 && code <= 0x314E) || (code >= 0x314F && code <= 0x3163)) {
                    switch (char) {
                        case 'ã…˜': return ['ã…—', 'ã…'];
                        case 'ã…™': return ['ã…—', 'ã…'];
                        case 'ã…š': return ['ã…—', 'ã…£'];
                        case 'ã…': return ['ã…œ', 'ã…“'];
                        case 'ã…': return ['ã…œ', 'ã…”'];
                        case 'ã…Ÿ': return ['ã…œ', 'ã…£'];
                        case 'ã…¢': return ['ã…¡', 'ã…£'];
                        case 'ã…’': return ['ã…', 'ã…£'];
                        case 'ã…–': return ['ã…”', 'ã…£'];
                        default: return [char];
                    }
                }

                if (code >= 0xAC00 && code <= 0xD7A3) {
                    const baseCode = code - 0xAC00;
                    const choIndex = Math.floor(baseCode / 588);
                    const jungIndex = Math.floor((baseCode % 588) / 28);
                    const jongIndex = baseCode % 28;

                    const choSeong = ['ã„±', 'ã„²', 'ã„´', 'ã„·', 'ã„¸', 'ã„¹', 'ã…', 'ã…‚', 'ã…ƒ', 'ã……', 'ã…†', 'ã…‡', 'ã…ˆ', 'ã…‰', 'ã…Š', 'ã…‹', 'ã…Œ', 'ã…', 'ã…'];
                    const jungSeong = ['ã…', 'ã…', 'ã…‘', 'ã…’', 'ã…“', 'ã…”', 'ã…•', 'ã…–', 'ã…—', 'ã…˜', 'ã…™', 'ã…š', 'ã…›', 'ã…œ', 'ã…', 'ã…', 'ã…Ÿ', 'ã… ', 'ã…¡', 'ã…¢', 'ã…£'];
                    const jongSeong = ['', 'ã„±', 'ã„²', 'ã„³', 'ã„´', 'ã„µ', 'ã„¶', 'ã„·', 'ã„¹', 'ã„º', 'ã„»', 'ã„¼', 'ã„½', 'ã„¾', 'ã„¿', 'ã…€', 'ã…', 'ã…‚', 'ã…„', 'ã……', 'ã…†', 'ã…‡', 'ã…ˆ', 'ã…Š', 'ã…‹', 'ã…Œ', 'ã…', 'ã…'];

                    const result = [];

                    if (choSeong[choIndex]) {
                        result.push(choSeong[choIndex]);
                    }

                    const jung = jungSeong[jungIndex];
                    if (jung) {
                        switch (jung) {
                            case 'ã…˜': result.push('ã…—'); result.push('ã…'); break;
                            case 'ã…™': result.push('ã…—'); result.push('ã…'); break;
                            case 'ã…š': result.push('ã…—'); result.push('ã…£'); break;
                            case 'ã…': result.push('ã…œ'); result.push('ã…“'); break;
                            case 'ã…': result.push('ã…œ'); result.push('ã…”'); break;
                            case 'ã…Ÿ': result.push('ã…œ'); result.push('ã…£'); break;
                            case 'ã…¢': result.push('ã…¡'); result.push('ã…£'); break;
                            case 'ã…’': result.push('ã…'); result.push('ã…£'); break;
                            case 'ã…–': result.push('ã…”'); result.push('ã…£'); break;
                            default: result.push(jung); break;
                        }
                    }

                    if (jongSeong[jongIndex]) {
                        result.push(jongSeong[jongIndex]);
                    }

                    return result;
                }

                return null;
            }

            updateKeyboardHighlight() {
                document.querySelectorAll('.key').forEach(key => {
                    key.classList.remove('active');
                });

                if (this.currentMode === 'word' || this.currentMode === 'sentence') {
                    const inputValue = document.getElementById('typingInput').value;
                    let inputJamoCount = 0;

                    for (let i = 0; i < inputValue.length; i++) {
                        const char = inputValue[i];
                        if (char === ' ') {
                            inputJamoCount += 1;
                        } else {
                            const decomposed = this.decomposeHangul(char);
                            if (decomposed && decomposed.length > 0) {
                                inputJamoCount += decomposed.length;
                            } else {
                                inputJamoCount += 1;
                            }
                        }
                    }

                    if (inputJamoCount < this.currentJamoSequence.length) {
                        const currentJamo = this.currentJamoSequence[inputJamoCount];

                        if (currentJamo === ' ') {
                            const targetKey = document.querySelector(`[data-key=" "]`);
                            if (targetKey) {
                                targetKey.classList.add('active');
                            }
                        } else if (this.complexVowelMap[currentJamo]) {
                            const keys = this.complexVowelMap[currentJamo];
                            keys.forEach(keyName => {
                                const targetKey = document.querySelector(`[data-key="${keyName}"]`);
                                if (targetKey) {
                                    targetKey.classList.add('active');
                                }
                            });
                        } else {
                            const keyName = this.keyboardMap[currentJamo];
                            if (keyName) {
                                const targetKey = document.querySelector(`[data-key="${keyName}"]`);
                                if (targetKey) {
                                    targetKey.classList.add('active');
                                }
                            }
                        }
                    }
                } else {
                    if (this.currentPosition < this.currentText.length) {
                        const currentChar = this.currentText[this.currentPosition];

                        if (currentChar === ' ') {
                            const targetKey = document.querySelector(`[data-key=" "]`);
                            if (targetKey) {
                                targetKey.classList.add('active');
                            }
                        } else if (this.complexVowelMap[currentChar]) {
                            const keys = this.complexVowelMap[currentChar];
                            keys.forEach(keyName => {
                                const targetKey = document.querySelector(`[data-key="${keyName}"]`);
                                if (targetKey) {
                                    targetKey.classList.add('active');
                                }
                            });
                        } else {
                            const keyName = this.keyboardMap[currentChar];
                            if (keyName) {
                                const targetKey = document.querySelector(`[data-key="${keyName}"]`);
                                if (targetKey) {
                                    targetKey.classList.add('active');
                                }
                            }
                        }
                    }
                }
            }

            applyInitialColors() {
                const chars = document.querySelectorAll('.char');
                chars.forEach(char => {
                    char.style.color = '#8b5cf6';
                    char.style.background = 'none';
                    char.style.padding = '0';
                    char.style.borderRadius = '0';
                    char.style.boxShadow = 'none';
                    char.style.transform = 'none';
                });
            }

            handleInput(inputValue) {
                try {
                    if (!this.startTime) {
                        this.startTime = Date.now();
                        if (this.currentMode === 'sentence') {
                            this.sentenceStartTime = Date.now();
                        }
                    }

                    if (this.currentMode === 'sentence') {
                        const chars = document.querySelectorAll('.char');
                        let mistakes = [];

                        for (let i = 0; i < this.currentText.length; i++) {
                            const char = chars[i];
                            if (!char) continue;

                            char.style.background = 'none';
                            char.style.padding = '0';
                            char.style.borderRadius = '0';
                            char.style.boxShadow = 'none';
                            char.style.transform = 'none';

                            if (i < inputValue.length) {
                                if (inputValue[i] === this.currentText[i]) {
                                    char.style.color = '#000000';
                                } else {
                                    char.style.color = '#ff4444';
                                    mistakes.push({
                                        position: i,
                                        expected: this.currentText[i],
                                        actual: inputValue[i],
                                        timestamp: Date.now() - this.sentenceStartTime
                                    });
                                }
                            } else if (i === inputValue.length) {
                                char.style.color = '#3b82f6';
                            } else {
                                char.style.color = '#8b5cf6';
                            }
                        }

                        // ë¬¸ì¥ì—°ìŠµì—ì„œ ì‹¤ìˆ˜ ê¸°ë¡
                        this.sentenceMistakes = mistakes;
                    } else {
                        const chars = document.querySelectorAll('.char');

                        for (let i = 0; i < this.currentText.length; i++) {
                            const char = chars[i];

                            if (i < inputValue.length) {
                                if (inputValue[i] === this.currentText[i]) {
                                    char.className = 'char correct';
                                } else {
                                    char.className = 'char incorrect';
                                }
                            } else {
                                char.className = 'char';
                                if (i === inputValue.length) {
                                    char.classList.add('current');
                                }
                            }
                        }
                    }

                    this.currentPosition = inputValue.length;
                    this.updateStats();
                    this.updateKeyboardHighlight();

                    if (inputValue === this.currentText) {
                        // ë¬¸ì¥ì´ ì™„ë£Œë˜ë©´ IMMEDIATELY í˜„ì¬ í†µê³„ì°½ì˜ ì •í™•ë„ì™€ íƒ€ì/ë¶„ì„ ì €ì¥
                        if (this.currentMode === 'sentence') {
                            const currentAccuracy = parseInt(document.getElementById('accuracy').textContent.replace('%', ''));
                            const currentSpeed = parseInt(document.getElementById('speed').textContent);
                            
                            const sentenceData = {
                                sentenceNumber: this.currentProblem + 1,
                                accuracy: currentAccuracy,
                                speed: currentSpeed
                            };
                            
                            this.sentenceStats.push(sentenceData);
                            
                            console.log(`ë¬¸ì¥${this.currentProblem + 1} ì™„ë£Œ - í†µê³„ì°½ì—ì„œ ì €ì¥ë¨:`);
                            console.log(`  ì •í™•ë„: ${currentAccuracy}%`);
                            console.log(`  ì†ë„: ${currentSpeed}íƒ€/ë¶„`);
                            console.log(`sentenceStats ë°°ì—´:`, this.sentenceStats);
                        }
                        
                        this.recordSentenceData();
                    }
                } catch (error) {
                    document.getElementById('accuracy').textContent = '100%';
                    document.getElementById('speed').textContent = '0';
                }
            }

            recordSentenceData() {
                if (this.currentMode === 'sentence') {
                    const sentenceTime = Date.now() - this.sentenceStartTime;
                    
                    // í•œê¸€ ìì†Œ ë‹¨ìœ„ë¡œ ì •í™•ë„ ê³„ì‚° (ì›ë˜ ë°©ì‹ê³¼ ë™ì¼)
                    const currentTextJasoCount = this.countJaso(this.currentText);
                    const inputValue = document.getElementById('typingInput').value;
                    let currentCorrectJaso = 0;
                    
                    for (let i = 0; i < Math.min(inputValue.length, this.currentText.length); i++) {
                        if (inputValue[i] === this.currentText[i]) {
                            currentCorrectJaso += this.countJaso(this.currentText[i]);
                        }
                    }
                    
                    const accuracy = currentTextJasoCount > 0 ? Math.round((currentCorrectJaso / currentTextJasoCount) * 100) : 100;
                    
                    // í•œê¸€ ìì†Œ ë‹¨ìœ„ë¡œ íƒ€ì´í•‘ ì†ë„ ê³„ì‚° (ì›ë˜ ë°©ì‹ê³¼ ë™ì¼)
                    const jasoCount = this.countJaso(this.currentText);
                    const cpm = Math.round((jasoCount / (sentenceTime / 1000)) * 60);
                    
                    this.sentenceTypingData.push({
                        sentence: this.currentText,
                        time: sentenceTime,
                        accuracy: accuracy,
                        wpm: cpm, // ì‹¤ì œë¡œëŠ” CPM(ìì†Œ/ë¶„)ì´ì§€ë§Œ ê¸°ì¡´ ë³€ìˆ˜ëª… ìœ ì§€
                        mistakes: [...this.sentenceMistakes],
                        keyTimings: [...this.sentenceKeyTimings]
                    });
                }
            }

            updateStats() {
                try {
                    const currentTextJasoCount = this.countJaso(this.currentText);
                    let currentCorrectJaso = 0;
                    
                    const inputValue = document.getElementById('typingInput').value;
                    
                    for (let i = 0; i < Math.min(inputValue.length, this.currentText.length); i++) {
                        if (inputValue[i] === this.currentText[i]) {
                            currentCorrectJaso += this.countJaso(this.currentText[i]);
                        }
                    }
                    
                    const accuracy = currentTextJasoCount > 0 ? Math.round((currentCorrectJaso / currentTextJasoCount) * 100) : 100;
                    document.getElementById('accuracy').textContent = `${accuracy}%`;

                    if (this.startTime) {
                        const elapsed = (Date.now() - this.startTime) / 1000;
                        const currentInputJasoCount = this.countJaso(inputValue);
                        const cpm = elapsed > 0 ? Math.round((currentInputJasoCount / elapsed) * 60) : 0;
                        document.getElementById('speed').textContent = cpm;
                    } else {
                        document.getElementById('speed').textContent = '0';
                    }
                } catch (error) {
                    document.getElementById('accuracy').textContent = '100%';
                    document.getElementById('speed').textContent = '0';
                }
            }

            nextProblem() {
                try {
                    // ë¬¸ì¥ì—°ìŠµì—ì„œ ë¬¸ì¥ ì™„ë£Œ ì‹œ í†µê³„ ì €ì¥ (í˜¹ì‹œ ëˆ„ë½ëœ ê²½ìš°ë¥¼ ìœ„í•´)
                    if (this.currentMode === 'sentence' && this.currentPosition >= this.currentText.length) {
                        const currentAccuracy = parseInt(document.getElementById('accuracy').textContent.replace('%', ''));
                        const currentSpeed = parseInt(document.getElementById('speed').textContent);
                        
                        // ì´ë¯¸ ì €ì¥ë˜ì—ˆëŠ”ì§€ í™•ì¸ (ì¤‘ë³µ ë°©ì§€)
                        const alreadyStored = this.sentenceStats.some(stat => stat.sentenceNumber === this.currentProblem + 1);
                        
                        if (!alreadyStored) {
                            const sentenceData = {
                                sentenceNumber: this.currentProblem + 1,
                                accuracy: currentAccuracy,
                                speed: currentSpeed
                            };
                            
                            this.sentenceStats.push(sentenceData);
                            console.log(`nextProblemì—ì„œ ë¬¸ì¥${this.currentProblem + 1} ì €ì¥ - ì •í™•ë„: ${currentAccuracy}%, ì†ë„: ${currentSpeed}íƒ€/ë¶„`);
                        }
                    }
                    
                    this.currentProblem++;
                    console.log(`ë‹¤ìŒ ë¬¸ì œë¡œ ì´ë™: ${this.currentProblem + 1}/${this.totalProblems}`);
                    console.log(`í˜„ì¬ sentenceStats:`, this.sentenceStats);
                    
                    if (this.currentProblem >= this.totalProblems) {
                        console.log('ëª¨ë“  ë¬¸ì¥ ì™„ë£Œ! AI í”¼ë“œë°± í‘œì‹œ');
                        this.showComplete();
                    } else {
                        this.generateText();
                        this.updateDisplay();
                        document.getElementById('typingInput').value = '';
                        document.getElementById('typingInput').focus();
                    }
                } catch (error) {
                    console.error('nextProblem ì˜¤ë¥˜:', error);
                    // ë‹¤ìŒ ë¬¸ì œë¡œ ì´ë™ ì˜¤ë¥˜ ì‹œ ê¸°ë³¸ ìƒíƒœ ìœ ì§€
                }
            }

            showComplete() {
                try {
                    if (this.currentMode === 'sentence') {
                        // ë¬¸ì¥ì—°ìŠµ ì™„ë£Œì‹œ AI í”¼ë“œë°± í‘œì‹œ
                        this.showAIFeedback();
                    } else {
                        // ê¸°ì¡´ ì™„ë£Œ ëª¨ë‹¬
                        const currentAccuracy = document.getElementById('accuracy').textContent;
                        const currentSpeed = document.getElementById('speed').textContent;

                        document.getElementById('finalAccuracy').textContent = currentAccuracy;
                        document.getElementById('finalSpeed').textContent = currentSpeed;
                        document.getElementById('completeModal').style.display = 'flex';
                    }
                } catch (error) {
                    document.getElementById('finalAccuracy').textContent = '100%';
                    document.getElementById('finalSpeed').textContent = '0';
                    document.getElementById('completeModal').style.display = 'flex';
                }
            }

            async showAIFeedback() {
                // ë¡œë”© í‘œì‹œ
                const modalContent = document.getElementById('modalContent');
                modalContent.className = 'modal-content ai-feedback';
                modalContent.innerHTML = `
                    <h2 class="ai-title">ğŸ¤– AIê°€ ë‹¹ì‹ ì˜ íƒ€ì´í•‘ì„ ë¶„ì„í•˜ê³  ìˆìŠµë‹ˆë‹¤...</h2>
                    <div style="text-align: center; padding: 3rem;">
                        <div class="loading"></div>
                        íƒ€ì´í•‘ íŒ¨í„´ì„ ì‹¬ì¸µ ë¶„ì„ ì¤‘ì…ë‹ˆë‹¤...
                    </div>
                `;
                document.getElementById('completeModal').style.display = 'flex';

                // 2ì´ˆ í›„ ë¶„ì„ ê²°ê³¼ í‘œì‹œ
                setTimeout(() => {
                    this.generateAIFeedback();
                }, 2000);
            }

            generateAIFeedback() {
                // ë””ë²„ê¹…: ê° ë¬¸ì¥ë³„ í†µê³„ ë°ì´í„° í™•ì¸
                console.log("=== AI í”¼ë“œë°± ë””ë²„ê¹… ì‹œì‘ ===");
                console.log("ì €ì¥ëœ ë¬¸ì¥ë³„ í†µê³„:", this.sentenceStats);
                
                // ê° ë¬¸ì¥ë³„ ì €ì¥ëœ í†µê³„ ë°ì´í„° ì¶”ì¶œ
                let sentence1Speed = 0, sentence1Accuracy = 0;
                let sentence2Speed = 0, sentence2Accuracy = 0;
                let sentence3Speed = 0, sentence3Accuracy = 0;
                
                if (this.sentenceStats.length >= 1) {
                    sentence1Speed = this.sentenceStats[0].speed || 0;
                    sentence1Accuracy = this.sentenceStats[0].accuracy || 0;
                    console.log("ë¬¸ì¥1 ì €ì¥ëœ í†µê³„ - ì†ë„:", sentence1Speed, "ì •í™•ë„:", sentence1Accuracy);
                }
                
                if (this.sentenceStats.length >= 2) {
                    sentence2Speed = this.sentenceStats[1].speed || 0;
                    sentence2Accuracy = this.sentenceStats[1].accuracy || 0;
                    console.log("ë¬¸ì¥2 ì €ì¥ëœ í†µê³„ - ì†ë„:", sentence2Speed, "ì •í™•ë„:", sentence2Accuracy);
                }
                
                if (this.sentenceStats.length >= 3) {
                    sentence3Speed = this.sentenceStats[2].speed || 0;
                    sentence3Accuracy = this.sentenceStats[2].accuracy || 0;
                    console.log("ë¬¸ì¥3 ì €ì¥ëœ í†µê³„ - ì†ë„:", sentence3Speed, "ì •í™•ë„:", sentence3Accuracy);
                }
                
                // ì „ì²´ í‰ê·  ê³„ì‚°: (ë¬¸ì¥1 + ë¬¸ì¥2 + ë¬¸ì¥3) Ã· 3
                let totalAvgSpeed = 0;
                let totalAvgAccuracy = 0;
                
                if (this.sentenceStats.length > 0) {
                    totalAvgSpeed = (sentence1Speed + sentence2Speed + sentence3Speed) / 3;
                    totalAvgAccuracy = (sentence1Accuracy + sentence2Accuracy + sentence3Accuracy) / 3;
                    
                    console.log("ê³„ì‚° ê³¼ì •:");
                    console.log("ì†ë„ í•©ê³„:", sentence1Speed + sentence2Speed + sentence3Speed);
                    console.log("ì •í™•ë„ í•©ê³„:", sentence1Accuracy + sentence2Accuracy + sentence3Accuracy);
                    console.log("ìµœì¢… í‰ê·  ì†ë„:", totalAvgSpeed);
                    console.log("ìµœì¢… í‰ê·  ì •í™•ë„:", totalAvgAccuracy);
                } else {
                    // fallback: í˜„ì¬ í‘œì‹œë˜ëŠ” ê°’ ì‚¬ìš©
                    totalAvgSpeed = parseInt(document.getElementById('speed').textContent) || 0;
                    totalAvgAccuracy = parseInt(document.getElementById('accuracy').textContent.replace('%', '')) || 0;
                    console.log("fallback ì‚¬ìš© - ì†ë„:", totalAvgSpeed, "ì •í™•ë„:", totalAvgAccuracy);
                }

                const currentSpeed = Math.round(totalAvgSpeed);
                const avgAccuracy = Math.round(totalAvgAccuracy);
                
                console.log("AI í”¼ë“œë°±ì— ì‚¬ìš©ë  ìµœì¢… ê°’ - ì†ë„:", currentSpeed, "ì •í™•ë„:", avgAccuracy);
                console.log("=== AI í”¼ë“œë°± ë””ë²„ê¹… ë ===");
                
                const totalMistakes = this.sentenceTypingData.reduce((sum, data) => sum + data.mistakes.length, 0);
                
                // ì‚¬ìš©ì í‰ê·  ê¸°ì¤€ìœ¼ë¡œ ì ìˆ˜ ê³„ì‚° (ì •í™•ë„ 95%, ì†ë„ 350íƒ€)
                // ì†ë„ ì ìˆ˜ ê³„ì‚° (0-100ì ) - ìƒˆë¡œìš´ ê¸°ì¤€ ì ìš©
                let speedScore = 0;
                if (currentSpeed >= 600) speedScore = 100; // ì „ì„¤
                else if (currentSpeed >= 500) speedScore = 90; // ë§¤ìš° ìš°ìˆ˜
                else if (currentSpeed >= 400) speedScore = 80; // ìš°ìˆ˜
                else if (currentSpeed >= 300) speedScore = 70; // í‰ê·  (350íƒ€ ê¸°ì¤€)
                else if (currentSpeed >= 200) speedScore = 50; // ë¯¸í¡
                else speedScore = Math.max(0, (currentSpeed / 200) * 50); // ë§¤ìš° ë¯¸í¡

                // ì •í™•ë„ ì ìˆ˜ ê³„ì‚° (0-100ì ) - 95%ë¥¼ í‰ê· ìœ¼ë¡œ ì¡°ì •
                let accuracyScore = 0;
                if (avgAccuracy >= 99) accuracyScore = 100;
                else if (avgAccuracy >= 97) accuracyScore = 90;
                else if (avgAccuracy >= 95) accuracyScore = 70; // ì‚¬ìš©ì í‰ê· 
                else if (avgAccuracy >= 92) accuracyScore = 60;
                else if (avgAccuracy >= 88) accuracyScore = 50;
                else if (avgAccuracy >= 85) accuracyScore = 40;
                else if (avgAccuracy >= 80) accuracyScore = 30;
                else accuracyScore = Math.max(0, (avgAccuracy / 80) * 30);

                // ì „ì²´ ì ìˆ˜ (ì†ë„ 50% + ì •í™•ë„ 50%)
                const totalScore = (speedScore * 0.5) + (accuracyScore * 0.5);

                // ì „ì²´ ë“±ê¸‰ ê³„ì‚°
                let overallGrade, overallPercentile;
                if (totalScore >= 95) {
                    overallGrade = "ì „ì„¤ê¸‰";
                    overallPercentile = "ìƒìœ„ 1%";
                } else if (totalScore >= 85) {
                    overallGrade = "ë§¤ìš° ìš°ìˆ˜";
                    overallPercentile = "ìƒìœ„ 5%";
                } else if (totalScore >= 75) {
                    overallGrade = "ìš°ìˆ˜";
                    overallPercentile = "ìƒìœ„ 15%";
                } else if (totalScore >= 70) {
                    overallGrade = "í‰ê·  ì´ìƒ";
                    overallPercentile = "ìƒìœ„ 30%";
                } else if (totalScore >= 65) {
                    overallGrade = "í‰ê· ";
                    overallPercentile = "í‰ê·  ìˆ˜ì¤€";
                } else if (totalScore >= 45) {
                    overallGrade = "í‰ê·  ë¯¸ë§Œ";
                    overallPercentile = "í•˜ìœ„ 40%";
                } else {
                    overallGrade = "ê°œì„  í•„ìš”";
                    overallPercentile = "í•˜ìœ„ 20%";
                }

                // ì†ë„ë³„ ë“±ê¸‰ (ê³„ê¸°íŒìš© - ì¢…í•© ì‹¤ë ¥ ê¸°ì¤€ìœ¼ë¡œ ë³€ê²½)
                let speedGrade, speedPercentile, needleRotation;
                if (totalScore >= 95) {
                    speedGrade = "ì „ì„¤ê¸‰";
                    speedPercentile = "ìƒìœ„ 1%";
                    needleRotation = 45;
                } else if (totalScore >= 85) {
                    speedGrade = "ë§¤ìš° ìš°ìˆ˜";
                    speedPercentile = "ìƒìœ„ 5%";
                    needleRotation = 35;
                } else if (totalScore >= 75) {
                    speedGrade = "ìš°ìˆ˜";
                    speedPercentile = "ìƒìœ„ 15%";
                    needleRotation = 20;
                } else if (totalScore >= 70) {
                    speedGrade = "í‰ê·  ì´ìƒ";
                    speedPercentile = "ìƒìœ„ 30%";
                    needleRotation = 5;
                } else if (totalScore >= 65) {
                    speedGrade = "í‰ê· ";
                    speedPercentile = "í‰ê·  ìˆ˜ì¤€";
                    needleRotation = -5;
                } else if (totalScore >= 45) {
                    speedGrade = "í‰ê·  ë¯¸ë§Œ";
                    speedPercentile = "í•˜ìœ„ 40%";
                    needleRotation = -20;
                } else {
                    speedGrade = "ê°œì„  í•„ìš”";
                    speedPercentile = "í•˜ìœ„ 20%";
                    needleRotation = -40;
                }

                const commonMistakes = this.analyzeCommonMistakes();
                const feedback = this.generateDetailedFeedback(currentSpeed, avgAccuracy, speedGrade, overallGrade, overallPercentile);
                const advice = this.generatePersonalizedAdvice(currentSpeed, avgAccuracy, overallGrade);

                const modalContent = document.getElementById('modalContent');
                modalContent.innerHTML = `
                    <h2 class="ai-title">ğŸ¤– AI íƒ€ì´í•‘ ë¶„ì„ ê²°ê³¼</h2>
                    
                    <div class="feedback-section">
                        <div class="feedback-section-title">ğŸ“Š ì „ì²´ì ì¸ ì„±ê³¼</div>
                        
                        <!-- ê³„ê¸°íŒì„ ë§¨ ìœ„ ê°€ìš´ë° ë°°ì¹˜ -->
                        <div style="text-align: center; margin-bottom: 2rem;">
                            <div class="speedometer-container">
                                <div class="speedometer">
                                    <div class="speedometer-arc"></div>
                                    <div class="speedometer-needle" id="speedometerNeedle" style="transform: translateX(-50%) rotate(-90deg);"></div>
                                    <div class="speedometer-center"></div>
                                </div>
                            </div>
                            <div class="speedometer-labels">
                                <span class="left-label">í•˜ìœ„ 20%</span>
                                <span class="right-label">ìƒìœ„ 1%</span>
                            </div>
                            <div class="percentile-display">
                                ì¢…í•© ì‹¤ë ¥ì€ ì‚¬ìš©ì ì¤‘ <strong>${overallPercentile}</strong>ì— í•´ë‹¹í•©ë‹ˆë‹¤!
                            </div>
                        </div>

                        <!-- VS ëŒ€ê²° êµ¬ë„ -->
                        <div class="vs-container">
                            <div class="vs-player user">
                                <div class="vs-title">ğŸ¯ ë‚˜ì˜ ì‹¤ë ¥</div>
                                <div class="vs-stat">
                                    <span class="vs-stat-label">ì¢…í•© ë“±ê¸‰:</span>
                                    <span class="vs-stat-value">${overallGrade}</span>
                                </div>
                                <div class="vs-stat">
                                    <span class="vs-stat-label">í‰ê·  íƒ€ì´í•‘ ì†ë„:</span>
                                    <span class="vs-stat-value">${currentSpeed}íƒ€/ë¶„</span>
                                </div>
                                <div class="vs-stat">
                                    <span class="vs-stat-label">í‰ê·  ì •í™•ë„:</span>
                                    <span class="vs-stat-value">${Math.round(avgAccuracy)}%</span>
                                </div>
                            </div>
                            
                            <div class="vs-divider">VS</div>
                            
                            <div class="vs-player average">
                                <div class="vs-title">ğŸ“ˆ ì‚¬ìš©ì í‰ê· </div>
                                <div class="vs-stat">
                                    <span class="vs-stat-label">ì¢…í•© ë“±ê¸‰:</span>
                                    <span class="vs-stat-value">í‰ê· </span>
                                </div>
                                <div class="vs-stat">
                                    <span class="vs-stat-label">í‰ê·  íƒ€ì´í•‘ ì†ë„:</span>
                                    <span class="vs-stat-value">350íƒ€/ë¶„</span>
                                </div>
                                <div class="vs-stat">
                                    <span class="vs-stat-label">í‰ê·  ì •í™•ë„:</span>
                                    <span class="vs-stat-value">95%</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="feedback-section">
                        <div class="feedback-section-title">ğŸ¯ ê°œì„  ë°©ì•ˆ</div>
                        <div class="feedback-text">
                            ${feedback.improvements}
                        </div>
                    </div>

                    <div class="feedback-section">
                        <div class="feedback-section-title">ğŸ“ˆ ëª©í‘œ ì„¤ì •</div>
                        <div class="feedback-text">
                            ${feedback.goals}
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: ${Math.min((currentSpeed + 50) / 800 * 100, 100)}%"></div>
                        </div>
                    </div>

                    <div class="feedback-section">
                        <div class="feedback-section-title">ğŸ† ì¢…í•© í‰ê°€</div>
                        <div class="feedback-text" style="margin-bottom: 1.5rem;">
                            ${feedback.overallAssessment}
                        </div>
                        <div class="skill-grid">
                            <div class="skill-item">
                                <div class="skill-name">íƒ€ì´í•‘ ì†ë„</div>
                                <div class="skill-score">${currentSpeed >= 600 ? 'ì „ì„¤' : currentSpeed >= 500 ? 'ë§¤ìš° ìš°ìˆ˜' : currentSpeed >= 400 ? 'ìš°ìˆ˜' : currentSpeed >= 300 ? 'í‰ê· ' : currentSpeed >= 200 ? 'ë¯¸í¡' : 'ë§¤ìš° ë¯¸í¡'} (${currentSpeed}íƒ€/ë¶„)</div>
                            </div>
                            <div class="skill-item">
                                <div class="skill-name">ì •í™•ë„</div>
                                <div class="skill-score">${avgAccuracy >= 99 ? 'ë§¤ìš° ì •í™•' : avgAccuracy >= 97 ? 'ì •í™•' : avgAccuracy >= 95 ? 'í‰ê· ' : avgAccuracy >= 92 ? 'í‰ê·  ë¯¸ë§Œ' : 'ê°œì„  í•„ìš”'} (${Math.round(avgAccuracy)}%)</div>
                            </div>
                            <div class="skill-item">
                                <div class="skill-name">ì¼ê´€ì„±</div>
                                <div class="skill-score">${this.sentenceTypingData.length > 1 && (Math.max(...this.sentenceTypingData.map(d => d.wpm)) - Math.min(...this.sentenceTypingData.map(d => d.wpm))) < 10 ? 'ë§¤ìš° ì¼ê´€ì ' : 
                                    this.sentenceTypingData.length > 1 && (Math.max(...this.sentenceTypingData.map(d => d.wpm)) - Math.min(...this.sentenceTypingData.map(d => d.wpm))) < 20 ? 'ì¼ê´€ì ' : 'ê°œì„  í•„ìš”'}</div>
                            </div>
                            <div class="skill-item advice-item">
                                <div class="skill-name">ğŸ’¡ ê°œì¸ ë§ì¶¤ ì¡°ì–¸</div>
                                <div class="advice-content">${advice}</div>
                            </div>
                        </div>
                    </div>

                    <div class="modal-buttons">
                        <button class="restart-btn" id="restartBtn">ë‹¤ì‹œ ì‹œì‘í•˜ê¸°</button>
                        <button class="continue-btn" id="continueBtn">ë” ì—°ìŠµí•˜ê¸°</button>
                    </div>
                `;

                // ë²„íŠ¼ ì´ë²¤íŠ¸ ì¬ë°”ì¸ë”©
                document.getElementById('restartBtn').addEventListener('click', () => {
                    this.restart();
                });

                document.getElementById('continueBtn').addEventListener('click', () => {
                    this.continuePractice();
                });

                // ê³„ê¸°íŒ ì• ë‹ˆë©”ì´ì…˜ íš¨ê³¼
                setTimeout(() => {
                    const needle = document.getElementById('speedometerNeedle');
                    if (needle) {
                        needle.style.transform = `translateX(-50%) rotate(${needleRotation}deg)`;
                    }
                }, 500);
            }

            generatePersonalizedAdvice(currentSpeed, avgAccuracy, overallGrade) {
                if (overallGrade === "ì „ì„¤ê¸‰") {
                    return "ğŸŒŸ ì™„ë²½í•œ ì‹¤ë ¥ì…ë‹ˆë‹¤! ì´ì œ ì‹¤ë¬´ì—ì„œ í™œìš©í•˜ê±°ë‚˜ ë‹¤ë¥¸ ì‚¬ëŒë“¤ì„ ê°€ë¥´ì³ë³´ì„¸ìš”. ë” ì–´ë ¤ìš´ ì „ë¬¸ ìš©ì–´ë‚˜ ì½”ë”© ì—°ìŠµì— ë„ì „í•´ë³´ëŠ” ê²ƒë„ ì¢‹ìŠµë‹ˆë‹¤. ì •ê¸°ì ìœ¼ë¡œ ì‹¤ë ¥ì„ ìœ ì§€í•˜ê¸° ìœ„í•´ ì£¼ 2-3íšŒ ì •ë„ ì—°ìŠµì„ ì§€ì†í•˜ì„¸ìš”.";
                } else if (overallGrade === "ë§¤ìš° ìš°ìˆ˜" || overallGrade === "ìš°ìˆ˜") {
                    return "ğŸ¯ í›Œë¥­í•œ ì‹¤ë ¥ì…ë‹ˆë‹¤! ì¼ì •í•œ ë¦¬ë“¬ì„ ìœ ì§€í•˜ë©° ê¸´ ë¬¸ì„œ íƒ€ì´í•‘ ì—°ìŠµì„ í•´ë³´ì„¸ìš”. ì‹¤ë¬´ ë¬¸ì„œë‚˜ ë‰´ìŠ¤ ê¸°ì‚¬ íƒ€ì´í•‘ìœ¼ë¡œ ì‹¤ì „ ê°ê°ì„ ê¸°ë¥´ëŠ” ê²ƒì„ ì¶”ì²œí•©ë‹ˆë‹¤. ì†ëª© ìŠ¤íŠ¸ë ˆì¹­ê³¼ ì •í™•í•œ ìì„¸ ìœ ì§€ê°€ ì¤‘ìš”í•©ë‹ˆë‹¤.";
                } else if (overallGrade === "í‰ê·  ì´ìƒ") {
                    if (avgAccuracy < 95) {
                        return "ğŸ¨ ì •í™•ë„ë¥¼ 95% ì´ìƒìœ¼ë¡œ ë†’ì´ëŠ” ê²ƒì´ ìš°ì„ ì…ë‹ˆë‹¤. ì²œì²œíˆ ì •í™•í•˜ê²Œ íƒ€ì´í•‘í•˜ëŠ” ìŠµê´€ì„ ê¸°ë¥´ê³ , í‹€ë¦° ë¶€ë¶„ì„ ë°˜ë³µ ì—°ìŠµí•˜ì„¸ìš”. ë§¤ì¼ 15ë¶„ ì •ë„ ì •í™•ë„ ì§‘ì¤‘ ì—°ìŠµì„ ì¶”ì²œí•©ë‹ˆë‹¤. ì†ë„ëŠ” ì •í™•ë„ê°€ ë†’ì•„ì§„ í›„ ìì—°ìŠ¤ëŸ½ê²Œ í–¥ìƒë©ë‹ˆë‹¤.";
                    } else {
                        return "ğŸš€ ì •í™•ë„ëŠ” ì¢‹ìœ¼ë‹ˆ ì´ì œ ì†ë„ë¥¼ ë†’ì—¬ë³´ì„¸ìš”. ë‹¨ì–´ ë‹¨ìœ„ë¡œ ì¸ì‹í•˜ë©° íƒ€ì´í•‘í•˜ê³ , ìì£¼ ì‚¬ìš©í•˜ëŠ” ë‹¨ì–´ë“¤ì„ ë¹ ë¥´ê²Œ ì¹˜ëŠ” ì—°ìŠµì„ í•˜ì„¸ìš”. í‚¤ë³´ë“œ ìµìˆ™í•¨ í–¥ìƒì„ ìœ„í•´ íƒ€ìê²Œì„ë„ ë³‘í–‰í•´ë³´ì„¸ìš”.";
                    }
                } else if (overallGrade === "í‰ê· ") {
                    return "ğŸ“š ê¸°ë³¸ê¸°ë¥¼ íƒ„íƒ„íˆ í•˜ëŠ” ì‹œê¸°ì…ë‹ˆë‹¤. ì •í™•í•œ ì†ê°€ë½ ìœ„ì¹˜ë¥¼ ìµíˆê³ , ë§¤ì¼ 15-20ë¶„ì”© ê¾¸ì¤€íˆ ì—°ìŠµí•˜ì„¸ìš”. ì •í™•ë„ë¥¼ ë¨¼ì € 95% ì´ìƒìœ¼ë¡œ ë†’ì¸ í›„ ì†ë„ë¥¼ í–¥ìƒì‹œí‚¤ëŠ” ê²ƒì´ ì¤‘ìš”í•©ë‹ˆë‹¤. ì˜¬ë°”ë¥¸ ìì„¸(ì†ëª©ì„ í‚¤ë³´ë“œì— ëŒ€ì§€ ì•Šê¸°)ë¥¼ ê¼­ ì§€ì¼œì£¼ì„¸ìš”.";
                } else {
                    return "ğŸŒ± ê¸°ì´ˆë¶€í„° ì°¨ê·¼ì°¨ê·¼ ì‹œì‘í•˜ì„¸ìš”. ìì„¸ êµì •ì´ ê°€ì¥ ì¤‘ìš”í•©ë‹ˆë‹¤. ì†ëª©ì„ í‚¤ë³´ë“œì— ëŒ€ì§€ ë§ê³ , ê° ì†ê°€ë½ì˜ ë‹´ë‹¹ í‚¤ë¥¼ ì •í™•íˆ ìµí˜€ì£¼ì„¸ìš”. ì²˜ìŒì—ëŠ” ì†ë„ë³´ë‹¤ ì •í™•ë„ì— ì§‘ì¤‘í•˜ê³ , ë§¤ì¼ 10ë¶„ì”©ì´ë¼ë„ ê¾¸ì¤€íˆ ì—°ìŠµí•˜ë©´ ë°˜ë“œì‹œ ëŠ˜ì–´ë‚©ë‹ˆë‹¤! ì¸ë‚´ì‹¬ì„ ê°–ê³  ê¾¸ì¤€íˆ í•˜ì‹œë©´ ë©ë‹ˆë‹¤.";
                }
            }

            continuePractice() {
                // í˜„ì¬ ë¬¸ì œ ë²ˆí˜¸ë¥¼ ì´ˆê¸°í™”í•˜ê³  ê³„ì† ì§„í–‰
                this.currentProblem = 0;
                // ë¬¸ì¥ ì—°ìŠµ ë°ì´í„°ëŠ” ìœ ì§€
                this.generateText();
                this.updateDisplay();
                document.getElementById('typingInput').value = '';
                document.getElementById('completeModal').style.display = 'none';
                
                // ëª¨ë‹¬ í´ë˜ìŠ¤ ì´ˆê¸°í™”
                document.getElementById('modalContent').className = 'modal-content';
                
                document.getElementById('typingInput').focus();
            }

            generateDetailedFeedback(currentSpeed, avgAccuracy, speedGrade, overallGrade, overallPercentile) {
                // í˜„ì‹¤ì ì¸ ëª©í‘œ ì„¤ì • - ì‚¬ìš©ì í‰ê·  ê¸°ì¤€ ì¡°ì • (ì •í™•ë„ 95% ê¸°ì¤€)
                let targetSpeed, targetAccuracy, targetPercentile;
                
                // ì •í™•ë„ê°€ ë‚®ìœ¼ë©´ ì†ë„ë³´ë‹¤ ì •í™•ë„ ìš°ì„ 
                if (avgAccuracy < 88) {
                    targetAccuracy = Math.min(92, avgAccuracy + 4);
                    targetSpeed = currentSpeed + 20; // ì†ë„ëŠ” ì¡°ê¸ˆë§Œ ì¦ê°€
                    targetPercentile = "ì •í™•ë„ ê°œì„  ìš°ì„ ";
                } else if (avgAccuracy < 92) {
                    targetAccuracy = Math.min(95, avgAccuracy + 3);
                    targetSpeed = currentSpeed + 30;
                    targetPercentile = "í‰ê·  ìˆ˜ì¤€ ë‹¬ì„±";
                } else if (avgAccuracy < 95) {
                    targetAccuracy = Math.min(97, avgAccuracy + 2);
                    targetSpeed = currentSpeed < 250 ? 350 : currentSpeed + 50;
                    targetPercentile = "í‰ê·  ë‹¬ì„±";
                } else if (avgAccuracy < 97) {
                    targetAccuracy = Math.min(99, avgAccuracy + 2);
                    targetSpeed = currentSpeed < 250 ? 350 : currentSpeed + 50;
                    targetPercentile = "í‰ê·  ì´ìƒ";
                } else {
                    // ì •í™•ë„ê°€ ì¶©ë¶„í•˜ë©´ ì†ë„ ìœ„ì£¼
                    targetAccuracy = Math.min(100, avgAccuracy + 1);
                    targetSpeed = currentSpeed < 250 ? 350 : 
                                 currentSpeed < 350 ? 450 : 
                                 currentSpeed < 450 ? 550 : 
                                 currentSpeed + 50;
                    targetPercentile = currentSpeed < 350 ? "í‰ê·  ìˆ˜ì¤€" : 
                                      currentSpeed < 450 ? "ìƒìœ„ 30%" : 
                                      currentSpeed < 550 ? "ìƒìœ„ 15%" : 
                                      currentSpeed < 650 ? "ìƒìœ„ 5%" : "ìƒìœ„ 1%";
                }

                const improvements = `
                    ${avgAccuracy < 92 ? 
                        'ğŸ¯ <strong>ì •í™•ë„ ìµœìš°ì„ :</strong> ì†ë„ë¥¼ ëŠ¦ì¶”ë”ë¼ë„ ì •í™•í•˜ê²Œ íƒ€ì´í•‘í•˜ëŠ” ì—°ìŠµì„ í•˜ì„¸ìš”. ì‚¬ìš©ì í‰ê·  ì •í™•ë„ 95% ë‹¬ì„±ì´ ì²« ë²ˆì§¸ ëª©í‘œì…ë‹ˆë‹¤. í‹€ë¦° ê¸€ìê°€ ë‚˜ì˜¬ ë•Œë§ˆë‹¤ ì¦‰ì‹œ ë©ˆì¶”ê³  ë‹¤ì‹œ ì •í™•í•˜ê²Œ íƒ€ì´í•‘í•´ë³´ì„¸ìš”.<br>' : 
                        avgAccuracy < 95 ?
                        'ğŸ¯ <strong>í‰ê·  ì •í™•ë„ ë‹¬ì„±:</strong> 95% ì´ìƒì˜ ì •í™•ë„ë¥¼ ëª©í‘œë¡œ í•˜ì„¸ìš”. ì´ê²ƒì´ ì‚¬ìš©ì í‰ê·  ìˆ˜ì¤€ì…ë‹ˆë‹¤. ë°±ìŠ¤í˜ì´ìŠ¤ ì‚¬ìš©ì„ ìµœì†Œí™”í•˜ê³  ì²˜ìŒë¶€í„° ì •í™•í•˜ê²Œ íƒ€ì´í•‘í•˜ëŠ” ìŠµê´€ì„ ê¸°ë¥´ì„¸ìš”.<br>' :
                        avgAccuracy < 97 ?
                        'ğŸ¯ <strong>ì •í™•ë„ í–¥ìƒ:</strong> 97% ì´ìƒì˜ ì •í™•ë„ë¥¼ ëª©í‘œë¡œ í•˜ì„¸ìš”. ì‹¤ë¬´ì—ì„œ í™œìš©í•  ìˆ˜ ìˆëŠ” ìˆ˜ì¤€ì…ë‹ˆë‹¤. ìì£¼ í‹€ë¦¬ëŠ” ë¬¸ìë“¤ì„ ë”°ë¡œ ì—°ìŠµí•´ë³´ì„¸ìš”.<br>' :
                        ''
                    }
                    ${currentSpeed < 200 && avgAccuracy >= 85 ? 
                        'ğŸ”¥ <strong>ê¸°ë³¸ ìì„¸ êµì •:</strong> ì†ëª©ì„ í‚¤ë³´ë“œì— ëŒ€ì§€ ë§ê³  ì†ê°€ë½ë§Œ ì›€ì§ì—¬ íƒ€ì´í•‘í•˜ì„¸ìš”. ì •í™•í•œ ì†ê°€ë½ ìœ„ì¹˜ë¥¼ ìµíˆëŠ” ê²ƒì´ ìš°ì„ ì…ë‹ˆë‹¤. ê° ì†ê°€ë½ì˜ ë‹´ë‹¹ í‚¤ë¥¼ ëª…í™•íˆ êµ¬ë¶„í•´ì„œ ì—°ìŠµí•˜ì„¸ìš”.<br>' : 
                        ''
                    }
                    ${this.analyzeCommonMistakes().length > 0 ? 
                        `âŒ¨ï¸ <strong>ì·¨ì•½ ë¬¸ì ì§‘ì¤‘ ì—°ìŠµ:</strong> "${this.analyzeCommonMistakes().join(', ')}" ë¬¸ìê°€ í¬í•¨ëœ ë‹¨ì–´ë¥¼ ë°˜ë³µ ì—°ìŠµí•˜ì„¸ìš”. ì´ ë¬¸ìë“¤ì„ ì²œì²œíˆ ì •í™•í•˜ê²Œ ì¹˜ëŠ” ì—°ìŠµì„ ë§¤ì¼ 5ë¶„ì”© í•´ë³´ì„¸ìš”.<br>` : 
                        ''
                    }
                    ${this.sentenceTypingData.length > 1 && this.calculateSpeedVariance() > 50 ? 
                        'ğŸ“Š <strong>ì¼ì •í•œ ë¦¬ë“¬ ìœ ì§€:</strong> ë¹ ë¥´ê²Œ ì¹˜ë ¤ê³  í•˜ì§€ ë§ê³  ì¼ì •í•œ ë¦¬ë“¬ì„ ìœ ì§€í•˜ë©° íƒ€ì´í•‘í•˜ì„¸ìš”. ë©”íŠ¸ë¡œë†ˆì„ í™œìš©í•˜ê±°ë‚˜ ë§ˆìŒì†ìœ¼ë¡œ ì¼ì •í•œ ë°•ìë¥¼ ì„¸ë©´ì„œ ì—°ìŠµí•´ë³´ì„¸ìš”.<br>' : 
                        ''
                    }
                    ${currentSpeed >= 400 && avgAccuracy >= 97 ? 
                        'ğŸš€ <strong>ê³ ê¸‰ ê¸°ë²•:</strong> ë‹¨ì–´ ë‹¨ìœ„ë¡œ ì¸ì‹í•˜ì—¬ íƒ€ì´í•‘í•˜ëŠ” ì—°ìŠµì„ ì‹œì‘í•˜ì„¸ìš”. ë¬¸ì¥ì˜ íë¦„ì„ ë¯¸ë¦¬ ì½ê³  íƒ€ì´í•‘í•˜ë©´ ë”ìš± ë¹¨ë¼ì§‘ë‹ˆë‹¤. ì‹œê°ì  ê¸°ì–µê³¼ ê·¼ìœ¡ ê¸°ì–µì„ ë™ì‹œì— í™œìš©í•˜ì„¸ìš”.' : 
                        currentSpeed >= 200 && avgAccuracy >= 95 ?
                        'ğŸ“ˆ <strong>ì†ë„ í–¥ìƒ:</strong> ì •í™•ë„ë¥¼ ìœ ì§€í•˜ë©´ì„œ ì ì§„ì ìœ¼ë¡œ ì†ë„ë¥¼ ë†’ì—¬ë³´ì„¸ìš”. ì‚¬ìš©ì í‰ê· (350íƒ€)ì„ ëª©í‘œë¡œ í•˜ë˜, ë¬´ë¦¬í•˜ì§€ ë§ê³  ë‹¨ê³„ì ìœ¼ë¡œ ì¦ê°€ì‹œí‚¤ì„¸ìš”.' :
                        'ğŸ“š <strong>ê¸°ì´ˆ ì—°ìŠµ:</strong> ë§¤ì¼ 15-20ë¶„ì”© ì •í™•ë„ ìœ„ì£¼ë¡œ ì—°ìŠµí•˜ëŠ” ê²ƒì´ ê°€ì¥ ì¤‘ìš”í•©ë‹ˆë‹¤. ê¸°ì´ˆê°€ íƒ„íƒ„í•´ì•¼ ë‚˜ì¤‘ì— ì†ë„ë„ ìì—°ìŠ¤ëŸ½ê²Œ í–¥ìƒë©ë‹ˆë‹¤.'
                    }
                `;

                const goals = `
                    <strong>ë‹¨ê¸° ëª©í‘œ (2ì£¼ ë‚´):</strong><br>
                    â€¢ íƒ€ì´í•‘ ì†ë„: <span class="feedback-highlight">${Math.round(currentSpeed + (targetSpeed - currentSpeed) * 0.3)}íƒ€/ë¶„</span> ë‹¬ì„±<br>
                    â€¢ ì •í™•ë„: <span class="feedback-highlight">${Math.round(avgAccuracy + (targetAccuracy - avgAccuracy) * 0.6)}%</span> ë‹¬ì„±<br><br>
                    
                    <strong>ì¤‘ê¸° ëª©í‘œ (1ê°œì›” ë‚´):</strong><br>
                    â€¢ íƒ€ì´í•‘ ì†ë„: <span class="feedback-highlight">${targetSpeed}íƒ€/ë¶„</span> ë‹¬ì„±<br>
                    â€¢ ì •í™•ë„: <span class="feedback-highlight">${targetAccuracy}%</span> ë‹¬ì„±<br>
                    â€¢ ì‹¤ë ¥ ë“±ê¸‰: <span class="feedback-highlight">${targetPercentile}</span> ì§„ì…<br><br>
                    
                    <strong>ê¶Œì¥ ì—°ìŠµ ì‹œê°„ ë° ë°©ë²•:</strong><br>
                    ${avgAccuracy < 88 ? 
                        'ë§¤ì¼ 25-30ë¶„ì”© ì •í™•ë„ ì§‘ì¤‘ ì—°ìŠµ (ì†ë„ëŠ” ì²œì²œíˆ). í‹€ë¦° ë¬¸ì ì¦‰ì‹œ êµì •í•˜ê¸°' : 
                        avgAccuracy < 92 ?
                        'ë§¤ì¼ 20-25ë¶„ì”© ê¸°ë³¸ê¸° ë‹¤ì§€ê¸° (í‰ê·  ë‹¬ì„± ëª©í‘œ). ì •í™•ë„ 92% ìš°ì„ ' :
                        avgAccuracy < 95 ?
                        'ë§¤ì¼ 20-25ë¶„ì”© ì •í™•ë„ì™€ ì†ë„ ê· í˜• ì—°ìŠµ. 95% ì •í™•ë„ ë‹¬ì„± í›„ ì†ë„ í–¥ìƒ' :
                        avgAccuracy < 97 ?
                        'ë§¤ì¼ 18-22ë¶„ì”© ì •í™•ë„ í–¥ìƒê³¼ ì†ë„ ì—°ìŠµ. 97% ì •í™•ë„ ëª©í‘œ' :
                        currentSpeed < 300 ? 
                        'ë§¤ì¼ 15-20ë¶„ì”© ì†ë„ í–¥ìƒ ìœ„ì£¼ ì—°ìŠµ. ë¦¬ë“¬ê°ê³¼ ì¼ê´€ì„± ì¤‘ì‹œ' : 
                        'ë§¤ì¼ 10-15ë¶„ì”© ê³ ê¸‰ ê¸°ë²•ê³¼ ì‹¤ì „ ì—°ìŠµ. ê¸´ ë¬¸ì„œ íƒ€ì´í•‘ ë„ì „'
                    }
                `;

                const overallAssessment = overallGrade === "ì „ì„¤ê¸‰" ? 
                    'ì¶•í•˜í•©ë‹ˆë‹¤! ì†ë„ì™€ ì •í™•ë„ ëª¨ë‘ ìµœê³  ìˆ˜ì¤€ì…ë‹ˆë‹¤. ì´ì œ ì‹¤ë¬´ì—ì„œë„ ì¶©ë¶„íˆ í™œìš©í•  ìˆ˜ ìˆëŠ” ì™„ë²½í•œ ì‹¤ë ¥ì…ë‹ˆë‹¤!' :
                    overallGrade === "ë§¤ìš° ìš°ìˆ˜" || overallGrade === "ìš°ìˆ˜" ? 
                    'í›Œë¥­í•œ ì‹¤ë ¥ì…ë‹ˆë‹¤! ì†ë„ì™€ ì •í™•ë„ì˜ ê· í˜•ì´ ì˜ ì¡í˜€ìˆìŠµë‹ˆë‹¤. ì¡°ê¸ˆë§Œ ë” ì—°ìŠµí•˜ë©´ ìµœê³  ìˆ˜ì¤€ì— ë„ë‹¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.' :
                    overallGrade === "í‰ê·  ì´ìƒ" ? 
                    'ì‚¬ìš©ì í‰ê· ì„ ë„˜ì–´ì„  ì¢‹ì€ ì‹¤ë ¥ì…ë‹ˆë‹¤. ì†ë„ë‚˜ ì •í™•ë„ ì¤‘ ë¶€ì¡±í•œ ë¶€ë¶„ì„ ì§‘ì¤‘ì ìœ¼ë¡œ ì—°ìŠµí•˜ë©´ í¬ê²Œ í–¥ìƒë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.' :
                    overallGrade === "í‰ê· " ? 
                    'ì‚¬ìš©ì í‰ê·  ìˆ˜ì¤€ì— ê·¼ì ‘í•œ ì‹¤ë ¥ì…ë‹ˆë‹¤. ì •í™•ë„ë¥¼ ë¨¼ì € ë†’ì´ê³ , ê·¸ ë‹¤ìŒ ì†ë„ë¥¼ í–¥ìƒì‹œí‚¤ëŠ” ìˆœì„œë¡œ ì—°ìŠµí•˜ì„¸ìš”.' :
                    'ê¸°ì´ˆë¶€í„° ì°¨ê·¼ì°¨ê·¼ ì—°ìŠµì´ í•„ìš”í•©ë‹ˆë‹¤. ì •í™•ë„ë¥¼ 95% ì´ìƒìœ¼ë¡œ ë†’ì´ëŠ” ê²ƒì„ ìµœìš°ì„  ëª©í‘œë¡œ í•˜ì„¸ìš”. ì‚¬ìš©ì í‰ê· ì— ë„ë‹¬í•˜ëŠ” ê²ƒì´ ì²« ë²ˆì§¸ ëª©í‘œì…ë‹ˆë‹¤.';

                return {
                    improvements,
                    goals,
                    overallAssessment
                };
            }

            analyzeSlowTransitions() {
                if (this.keyTransitions.length < 5) return [];

                // í‚¤ ì´ë™ë³„ í‰ê·  ì‹œê°„ ê³„ì‚°
                const transitionGroups = {};
                this.keyTransitions.forEach(transition => {
                    const key = `${transition.from}-${transition.to}`;
                    if (!transitionGroups[key]) {
                        transitionGroups[key] = {
                            intervals: [],
                            distance: transition.distance,
                            fingerTransition: transition.fingerTransition,
                            fromChar: transition.fromChar,
                            toChar: transition.toChar,
                            from: transition.from,
                            to: transition.to
                        };
                    }
                    transitionGroups[key].intervals.push(transition.interval);
                });

                // ê° ì´ë™ íŒ¨í„´ì˜ í‰ê·  ì‹œê°„ ê³„ì‚°
                const transitionStats = [];
                Object.entries(transitionGroups).forEach(([key, data]) => {
                    if (data.intervals.length >= 2) { // ìµœì†Œ 2ë²ˆ ì´ìƒ ë‚˜íƒ€ë‚œ íŒ¨í„´ë§Œ
                        const avgTime = data.intervals.reduce((a, b) => a + b, 0) / data.intervals.length;
                        const expectedTime = this.getExpectedTransitionTime(data.distance, data.fingerTransition);
                        
                        transitionStats.push({
                            key: key,
                            avgTime: avgTime,
                            expectedTime: expectedTime,
                            slowness: avgTime / expectedTime, // ì˜ˆìƒ ì‹œê°„ ëŒ€ë¹„ ì‹¤ì œ ì‹œê°„ ë¹„ìœ¨
                            distance: data.distance,
                            fingerTransition: data.fingerTransition,
                            fromChar: data.fromChar,
                            toChar: data.toChar,
                            from: data.from,
                            to: data.to,
                            count: data.intervals.length
                        });
                    }
                });

                // ê°€ì¥ ëŠë¦° 3ê°œ íŒ¨í„´ ë°˜í™˜
                return transitionStats
                    .filter(stat => stat.slowness > 1.5) // ì˜ˆìƒë³´ë‹¤ 50% ì´ìƒ ëŠë¦° ê²ƒë§Œ
                    .sort((a, b) => b.slowness - a.slowness)
                    .slice(0, 3)
                    .map(stat => ({
                        display: `${this.getKoreanChar(stat.fromChar)} â†’ ${this.getKoreanChar(stat.toChar)}`,
                        slowness: stat.slowness,
                        fingerTransition: stat.fingerTransition,
                        advice: this.getTransitionAdvice(stat)
                    }));
            }

            getKoreanChar(char) {
                // ì˜ë¬¸ í‚¤ë¥¼ í•œê¸€ë¡œ ë³€í™˜í•´ì„œ í‘œì‹œ
                return this.koreanKeyMap[char.toLowerCase()] || char;
            }

            getExpectedTransitionTime(distance, fingerTransition) {
                // ê±°ë¦¬ì™€ ì†ê°€ë½ ì´ë™ íŒ¨í„´ì— ë”°ë¥¸ ì˜ˆìƒ ì‹œê°„ (ë°€ë¦¬ì´ˆ)
                let baseTime = 150; // ê¸°ë³¸ 150ms
                
                if (fingerTransition === 'ê°™ì€ì†ê°€ë½') {
                    baseTime += distance * 50; // ê°™ì€ ì†ê°€ë½ì€ ë” ëŠë¦¼
                } else if (fingerTransition === 'ê°™ì€ì†') {
                    baseTime += distance * 30;
                } else if (fingerTransition === 'ë‹¤ë¥¸ì†') {
                    baseTime += distance * 20; // ë‹¤ë¥¸ ì†ì€ ìƒëŒ€ì ìœ¼ë¡œ ë¹ ë¦„
                }
                
                return baseTime;
            }

            getTransitionAdvice(stat) {
                const finger = stat.fingerTransition;
                const slowness = stat.slowness;
                
                if (finger === 'ê°™ì€ì†ê°€ë½') {
                    return `ê°™ì€ ì†ê°€ë½ìœ¼ë¡œ ì—°ì† íƒ€ì´í•‘ì‹œ ${Math.round((slowness - 1) * 100)}% ì§€ì—°. ì†ê°€ë½ì„ ë¹ ë¥´ê²Œ ì´ë™í•˜ëŠ” ì—°ìŠµì´ í•„ìš”í•©ë‹ˆë‹¤.`;
                } else if (finger === 'ê°™ì€ì†') {
                    return `ê°™ì€ ì† ë‚´ì—ì„œ ${Math.round((slowness - 1) * 100)}% ì§€ì—°. ì†ê°€ë½ ë…ë¦½ì„±ì„ ê¸°ë¥´ëŠ” ì—°ìŠµì„ í•˜ì„¸ìš”.`;
                } else if (finger === 'ë‹¤ë¥¸ì†') {
                    return `ì–‘ì† í˜‘ì‘ì—ì„œ ${Math.round((slowness - 1) * 100)}% ì§€ì—°. ì–‘ì† ë¦¬ë“¬ ì—°ìŠµì´ í•„ìš”í•©ë‹ˆë‹¤.`;
                } else {
                    return `ì´ í‚¤ ì¡°í•©ì— ëŒ€í•œ ë°˜ë³µ ì—°ìŠµì´ í•„ìš”í•©ë‹ˆë‹¤.`;
                }
            }

            calculateSpeedVariance() {
                if (this.sentenceTypingData.length <= 1) return 0;
                const speeds = this.sentenceTypingData.map(data => data.wpm);
                return Math.max(...speeds) - Math.min(...speeds);
            }

            analyzeCommonMistakes() {
                const mistakeCount = {};
                this.sentenceTypingData.forEach(data => {
                    data.mistakes.forEach(mistake => {
                        const key = mistake.expected;
                        mistakeCount[key] = (mistakeCount[key] || 0) + 1;
                    });
                });

                return Object.entries(mistakeCount)
                    .sort((a, b) => b[1] - a[1])
                    .slice(0, 3)
                    .map(([char, count]) => char);
            }

            analyzeSlowCharacters() {
                const charTimings = {};
                this.sentenceTypingData.forEach(data => {
                    data.keyTimings.forEach(timing => {
                        if (timing.key !== ' ' && timing.interval > 0) {
                            if (!charTimings[timing.key]) {
                                charTimings[timing.key] = [];
                            }
                            charTimings[timing.key].push(timing.interval);
                        }
                    });
                });

                const avgTimings = {};
                Object.entries(charTimings).forEach(([char, timings]) => {
                    avgTimings[char] = timings.reduce((a, b) => a + b, 0) / timings.length;
                });

                if (Object.keys(avgTimings).length === 0) return [];

                const overallAvg = Object.values(avgTimings).reduce((a, b) => a + b, 0) / Object.values(avgTimings).length;

                return Object.entries(avgTimings)
                    .filter(([char, time]) => time > overallAvg * 1.5)
                    .sort((a, b) => b[1] - a[1])
                    .slice(0, 3)
                    .map(([char, time]) => char);
            }

            restart() {
                try {
                    this.currentProblem = 0;
                    this.resetStats();
                    
                    // ë¬¸ì¥ì—°ìŠµ ë°ì´í„° ì´ˆê¸°í™”
                    if (this.currentMode === 'sentence') {
                        this.sentenceTypingData = [];
                        this.sentenceMistakes = [];
                        this.sentenceKeyTimings = [];
                        this.keyTransitions = [];
                        this.sentenceStats = []; // ë¬¸ì¥ë³„ í†µê³„ë„ ì´ˆê¸°í™”
                    }
                    
                    this.generateText();
                    this.updateDisplay();
                    document.getElementById('typingInput').value = '';
                    document.getElementById('completeModal').style.display = 'none';
                    
                    // ëª¨ë‹¬ í´ë˜ìŠ¤ ì´ˆê¸°í™”
                    document.getElementById('modalContent').className = 'modal-content';
                    
                    document.getElementById('typingInput').focus();
                } catch (error) {
                    // ì¬ì‹œì‘ ì˜¤ë¥˜ ì‹œ ê¸°ë³¸ ìƒíƒœ ìœ ì§€
                }
            }

            resetStats() {
                try {
                    this.currentPosition = 0;
                    this.startTime = null;
                    this.sentenceStartTime = null;
                    this.lastKeyTime = null;
                    this.lastKeyPressed = null;
                    document.getElementById('accuracy').textContent = '100%';
                    document.getElementById('speed').textContent = '0';
                    document.getElementById('progress').textContent = `1/${this.totalProblems}`;
                } catch (error) {
                    // í†µê³„ ì´ˆê¸°í™” ì˜¤ë¥˜ ì‹œ ê¸°ë³¸ ìƒíƒœ ìœ ì§€
                }
            }
        }

        // ë“œë¡­ë‹¤ìš´ì—ì„œ ëª¨ë“œ ì „í™˜ í•¨ìˆ˜
        function switchMode(mode) {
            if (window.typingPractice) {
                window.typingPractice.changeMode(mode);
            }
        }

        // ì˜ì–´ íƒ€ìì—°ìŠµ ëª¨ë“œ ì „í™˜ í•¨ìˆ˜
        function switchEnglishMode(mode) {
            const modeNames = {
                'alphabet': 'ì•ŒíŒŒë²³',
                'word': 'ë‹¨ì–´',
                'sentence': 'ë¬¸ì¥'
            };
            alert(`ì˜ì–´ ${modeNames[mode]}ì—°ìŠµì„ ì‹œì‘í•©ë‹ˆë‹¤!\n\nì¶”í›„ ì˜ì–´ íƒ€ìì—°ìŠµ í˜ì´ì§€ì—ì„œ êµ¬í˜„ë  ì˜ˆì •ì…ë‹ˆë‹¤.`);
        }

        // íƒ€ìê²Œì„ í•¨ìˆ˜ë“¤
        function playKoreanMoleGame() {
            alert('í•œê¸€ ë‘ë”ì§€ ì¡ê¸° ê²Œì„ì„ ì‹œì‘í•©ë‹ˆë‹¤! ğŸ¹\n\nì‹¤ì œ êµ¬í˜„ì—ì„œëŠ” í•œê¸€ ê²Œì„ í˜ì´ì§€ë¡œ ì´ë™í•©ë‹ˆë‹¤.');
        }

        function playEnglishMoleGame() {
            alert('ì˜ì–´ ë‘ë”ì§€ ì¡ê¸° ê²Œì„ì„ ì‹œì‘í•©ë‹ˆë‹¤! ğŸ¯\n\nì‹¤ì œ êµ¬í˜„ì—ì„œëŠ” ì˜ì–´ ê²Œì„ í˜ì´ì§€ë¡œ ì´ë™í•©ë‹ˆë‹¤.');
        }

        function playKoreanPlaneGame() {
            alert('í•œê¸€ ë¹„í–‰ê¸° ì¡°ì¢… ê²Œì„ì„ ì‹œì‘í•©ë‹ˆë‹¤! âœˆï¸\n\nì‹¤ì œ êµ¬í˜„ì—ì„œëŠ” í•œê¸€ ë¹„í–‰ê¸° ê²Œì„ í˜ì´ì§€ë¡œ ì´ë™í•©ë‹ˆë‹¤.');
        }

        function playEnglishPlaneGame() {
            alert('ì˜ì–´ ë¹„í–‰ê¸° ì¡°ì¢… ê²Œì„ì„ ì‹œì‘í•©ë‹ˆë‹¤! ğŸ›©ï¸\n\nì‹¤ì œ êµ¬í˜„ì—ì„œëŠ” ì˜ì–´ ë¹„í–‰ê¸° ê²Œì„ í˜ì´ì§€ë¡œ ì´ë™í•©ë‹ˆë‹¤.');
        }

        function playKoreanDeliveryGame() {
            alert('í•œê¸€ íƒë°° ë¶„ë¥˜ ê²Œì„ì„ ì‹œì‘í•©ë‹ˆë‹¤! ğŸ“¦\n\nì‹¤ì œ êµ¬í˜„ì—ì„œëŠ” í•œê¸€ íƒë°° ê²Œì„ í˜ì´ì§€ë¡œ ì´ë™í•©ë‹ˆë‹¤.');
        }

        function playEnglishDeliveryGame() {
            alert('ì˜ì–´ íƒë°° ë¶„ë¥˜ ê²Œì„ì„ ì‹œì‘í•©ë‹ˆë‹¤! ğŸ“®\n\nì‹¤ì œ êµ¬í˜„ì—ì„œëŠ” ì˜ì–´ íƒë°° ê²Œì„ í˜ì´ì§€ë¡œ ì´ë™í•©ë‹ˆë‹¤.');
        }

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì´ˆê¸°í™”
        document.addEventListener('DOMContentLoaded', () => {
            try {
                window.typingPractice = new KoreanTypingPractice();
            } catch (error) {
                // ì´ˆê¸°í™” ì˜¤ë¥˜ ì‹œ ê¸°ë³¸ ìƒíƒœ ìœ ì§€
            }
        });

        // ë„¤ë¹„ê²Œì´ì…˜ ìŠ¤í¬ë¡¤ íš¨ê³¼
        window.addEventListener('scroll', () => {
            const nav = document.querySelector('nav');
            if (window.scrollY > 100) {
                nav.style.background = 'rgba(255, 255, 255, 0.98)';
            } else {
                nav.style.background = 'rgba(255, 255, 255, 0.95)';
            }
        });

        // ë¶€ë“œëŸ¬ìš´ ìŠ¤í¬ë¡¤ë§
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                const href = this.getAttribute('href');
                if (href && href !== '#') {
                    e.preventDefault();
                    const target = document.querySelector(href);
                    if (target) {
                        target.scrollIntoView({
                            behavior: 'smooth',
                            block: 'start'
                        });
                    }
                }
            });
        });
    </script>
</body>
</html>