<!DOCTYPE html>
<html lang="ko">
<head>
    <!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-T9HC454Z');</script>
<!-- End Google Tag Manager -->
    <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=0.67, maximum-scale=1.0, user-scalable=yes">
<title>핑거런 | 압도적인 디자인과 성능의 한글타자연습을 경험해보세요.</title>
<link rel="icon" type="image/svg+xml" href="../images/finger-run-logo.svg">
<link rel="shortcut icon" type="image/svg+xml" href="../images/finger-run-logo.svg">
<link rel="apple-touch-icon" href="../images/finger-run-logo.svg">
<link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>⌨️</text></svg>">
    
    <!-- SEO 메타태그 -->
    <meta name="description" content="압도적인 디자인과 성능을 갖춘 타자연습 사이트로 타이핑 속도와 정확도를 향상시키세요. 자음, 모음, 단어, 문장 단계별 한글타자 연습 프로그램.">
    <meta name="keywords" content="한글타자연습, 한글자판연습, 타자연습, 한글타자속도, 한글타자연습 사이트, 온라인 타자연습, 자음연습, 모음연습, 단어연습, 문장연습">
    <meta name="author" content="FingerRun">
    <meta name="robots" content="index, follow">

    <!-- Open Graph (SNS 공유) -->
    <meta property="og:title" content="핑거런 | 한글타자연습">
    <meta property="og:description" content="압도적인 디자인과 성능의 타자연습 사이트로 타이핑 속도와 정확도를 향상시키세요. 자음, 모음, 단어, 문장 단계별 학습.">
    <meta property="og:url" content="https://fingerrun.com/Korean/practice.html">
    <meta property="og:type" content="website">

    <!-- 추가 SEO -->
    <link rel="canonical" href="https://fingerrun.com/Korean/practice.html">
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #f5f5f5;
            min-height: 100vh;
            color: #333;
            line-height: 1.6;
        }

        /* Navigation */
        nav {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            padding: 1rem 0;
            position: fixed;
            width: 100%;
            top: 0;
            z-index: 1000;
            box-shadow: 0 2px 20px rgba(0, 0, 0, 0.1);
        }

        .nav-container {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 2rem;
        }

        .logo {
            font-size: 1.8rem;
            font-weight: bold;
            color: #667eea;
            text-decoration: none;
        }

        .nav-menu {
            display: flex;
            list-style: none;
            gap: 1.5rem;
            flex-wrap: nowrap;
            white-space: nowrap;
        }

        .nav-menu li {
            position: relative;
        }

        .nav-menu a {
            text-decoration: none;
            color: #333;
            font-weight: 500;
            padding: 0.5rem 0.8rem;
            border-radius: 25px;
            transition: all 0.3s ease;
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 0.3rem;
        }

        .nav-menu a:hover {
            background: #667eea;
            color: white;
            transform: translateY(-2px);
        }

        /* 드롭다운 화살표 */
        .dropdown-arrow {
            font-size: 0.7rem;
            transition: transform 0.3s ease;
        }

        /* 드롭다운 메뉴 */
        .dropdown-menu {
            position: absolute;
            top: 100%;
            left: 0;
            background: white;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
            border-radius: 10px;
            padding: 0.5rem 0;
            min-width: 180px;
            opacity: 0;
            visibility: hidden;
            transform: translateY(-10px);
            transition: all 0.3s ease;
            z-index: 1001;
            border: 1px solid rgba(0, 0, 0, 0.1);
        }

        .nav-menu li:hover .dropdown-menu {
            opacity: 1;
            visibility: visible;
            transform: translateY(0);
        }

        .nav-menu li:hover .dropdown-arrow {
            transform: rotate(180deg);
        }

        .dropdown-menu a {
            display: block;
            padding: 0.7rem 1rem;
            color: #333;
            border-radius: 0;
            font-weight: 400;
            transition: all 0.2s ease;
        }

        .dropdown-menu a:hover {
            background: #f8f9fa;
            color: #667eea;
            transform: none;
            padding-left: 1.2rem;
        }

        /* Main Container */
        .main-container {
            margin-top: 80px;
            padding: 2rem 0;
            max-width: 1200px;
            margin-left: auto;
            margin-right: auto;
            padding-left: 2rem;
            padding-right: 2rem;
        }

        .page-header {
            text-align: center;
            margin-bottom: 3rem;
        }

        .page-title {
            font-size: 2.5rem;
            font-weight: 700;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 1rem;
        }

        .page-description {
            font-size: 1.2rem;
            color: #666;
            max-width: 600px;
            margin: 0 auto;
        }

        /* Practice Container */
        .practice-container {
            background: white;
            border-radius: 20px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1);
            padding: 3rem;
            margin-bottom: 2rem;
            transition: all 0.3s ease;
        }

        .practice-container:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 50px rgba(0, 0, 0, 0.15);
        }

        /* Menu Buttons */
        .practice-menu {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-bottom: 3rem;
            flex-wrap: wrap;
        }

        .menu-btn {
            padding: 12px 25px;
            border: none;
            border-radius: 25px;
            font-size: 1rem;
            font-weight: 500;
            cursor: pointer;
            background: #f8f9fa;
            color: #667eea;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            border: 2px solid transparent;
        }

        .menu-btn:hover {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.3);
        }

        .menu-btn.active {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            transform: scale(1.05);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4);
        }

        /* Practice Area */
        .practice-area {
            text-align: center;
            margin-bottom: 3rem;
        }

        .text-display {
            font-size: 1.8rem;
            line-height: 1.8;
            margin-bottom: 2rem;
            min-height: 120px;
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            align-items: center;
            background: #f8f9fa;
            border-radius: 15px;
            padding: 2rem;
            word-break: keep-all;
            letter-spacing: 2px;
            border: 2px solid #e2e8f0;
            transition: all 0.3s ease;
        }

        .text-display:hover {
            border-color: #667eea;
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.1);
        }

        .text-display.sentence-mode {
            letter-spacing: 0.2px;
            line-height: 1.6;
            background: white;
            border: 2px solid #e2e8f0;
        }

        .text-display.sentence-mode:hover {
            border-color: #667eea;
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.1);
        }

        .text-display.sentence-mode .char {
            margin: 0;
            padding: 0;
            background: none !important;
            border-radius: 0;
            transition: color 0.2s ease;
            color: #8b5cf6;
            font-weight: 500;
            box-shadow: none !important;
            transform: none !important;
            animation: none !important;
        }

        .text-display.sentence-mode .char.correct {
            color: #000000;
        }

        .text-display.sentence-mode .char.incorrect {
            color: #ff4444;
        }

        .text-display.sentence-mode .char.current {
            color: #3b82f6;
            background: none !important;
        }

        /* 띄어쓰기 스타일 */
        .text-display.sentence-mode .char.space {
            display: inline-block;
            width: 0.5em;
        }

        .char {
            margin: 3px;
            padding: 8px 10px;
            border-radius: 8px;
            transition: all 0.3s ease;
            color: #666;
            font-weight: 500;
        }

        .char.correct {
            color: white;
            background: linear-gradient(45deg, #4caf50, #45a049);
            transform: scale(1.1);
            box-shadow: 0 4px 10px rgba(76, 175, 80, 0.3);
        }

        .char.incorrect {
            color: white;
            background: linear-gradient(45deg, #ff6b6b, #ff5252);
            transform: scale(1.1);
            box-shadow: 0 4px 10px rgba(255, 107, 107, 0.3);
        }

        .char.current {
            color: white;
            background: linear-gradient(45deg, #667eea, #764ba2);
            animation: pulse 1.5s infinite;
            transform: scale(1.15);
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; transform: scale(1.15); }
            50% { opacity: 0.7; transform: scale(1.2); }
        }

        /* Keyboard Area */
        .keyboard-area {
            margin: 2rem 0;
            display: flex;
            justify-content: center;
        }

        .keyboard {
            background: white;
            border-radius: 20px;
            padding: 2rem;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            border: 2px solid #e2e8f0;
            width: 100%;
            max-width: none;
        }

        .keyboard-row {
            display: flex;
            justify-content: center;
            margin-bottom: 0.5rem;
            gap: 0.3rem;
        }

        .keyboard-row:last-child {
            margin-bottom: 0;
        }

        .key {
            background: linear-gradient(145deg, #f8f9fa, #e9ecef);
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            padding: 0.8rem;
            min-width: 2.5rem;
            height: 2.5rem;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 500;
            font-size: 0.9rem;
            color: #495057;
            transition: all 0.3s ease;
            cursor: pointer;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            position: relative;
        }

        .key:hover {
            background: linear-gradient(145deg, #e9ecef, #dee2e6);
            transform: translateY(-1px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
        }

        .key.active {
            background: linear-gradient(145deg, #ff6b6b, #ff5252) !important;
            color: white !important;
            border-color: #ff4444 !important;
            transform: scale(1.1) !important;
            box-shadow: 0 6px 20px rgba(255, 107, 107, 0.4) !important;
            animation: keyPulse 0.3s ease-in-out !important;
        }

        @keyframes keyPulse {
            0% { transform: scale(1.1); }
            50% { transform: scale(1.2); }
            100% { transform: scale(1.1); }
        }

        /* 특수 키 스타일 */
        .key.wide { min-width: 4rem; }
        .key.extra-wide { min-width: 6rem; }
        .key.space { min-width: 12rem; }
        .key.shift { min-width: 5rem; }
        .key.tab { min-width: 3.5rem; }
        .key.caps { min-width: 4.5rem; }
        .key.enter { min-width: 5.5rem; }
        .key.backspace { min-width: 4.5rem; }

        /* 한글/영어 표시 */
        .key-dual {
            display: flex;
            flex-direction: column;
            align-items: center;
            line-height: 1.1;
        }

        .key-en {
            font-size: 0.7rem;
            color: #6c757d;
        }

        .key-ko {
            font-size: 0.8rem;
            color: #495057;
            font-weight: 600;
        }

        /* Input Area */
        .input-area {
            margin-bottom: 3rem;
        }

        .typing-input {
            width: 100%;
            padding: 18px;
            font-size: 1.2rem;
            border: 2px solid #e2e8f0;
            border-radius: 15px;
            text-align: center;
            outline: none;
            background: white;
            color: #333;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }

        .typing-input:focus {
            border-color: #667eea;
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.2);
            transform: translateY(-2px);
        }

        /* Stats */
        .stats {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            background: #f8f9fa;
            padding: 2rem;
            border-radius: 15px;
            margin-bottom: 2rem;
            border: 2px solid #e2e8f0;
        }

        .stat-item {
            text-align: center;
            padding: 1.5rem;
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.05);
            transition: all 0.3s ease;
        }

        .stat-item:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.1);
        }

        .stat-value {
            font-size: 2.2rem;
            font-weight: 700;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 0.5rem;
        }

        .stat-label {
            color: #666;
            font-size: 1rem;
            font-weight: 500;
        }

        /* Modal */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .modal-content {
            background: white;
            padding: 3rem;
            border-radius: 20px;
            text-align: center;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            max-width: 500px;
            width: 90%;
            animation: slideUp 0.5s ease;
        }

        @keyframes slideUp {
            from { transform: translateY(50px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        .complete-title {
            font-size: 2.8rem;
            font-weight: 700;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 2rem;
        }

        .complete-stats {
            display: flex;
            justify-content: space-around;
            margin-bottom: 3rem;
        }

        .complete-stat {
            text-align: center;
            padding: 1.5rem;
            background: #f8f9fa;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.05);
        }

        .complete-value {
            font-size: 2.5rem;
            font-weight: 700;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 0.5rem;
        }

        .complete-label {
            color: #666;
            font-size: 1.1rem;
            font-weight: 500;
        }

        .restart-btn {
            padding: 15px 40px;
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            border: none;
            border-radius: 25px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
        }

        .restart-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.5);
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .nav-menu {
                gap: 1rem;
                flex-wrap: nowrap;
            }

            .nav-menu a {
                padding: 0.4rem 0.6rem;
                font-size: 0.8rem;
            }

            .dropdown-menu {
                min-width: 150px;
                font-size: 0.8rem;
            }

            .dropdown-menu a {
                padding: 0.5rem 0.8rem;
            }

            .practice-container {
                padding: 2rem;
                margin: 1rem;
            }

            .page-title {
                font-size: 2rem;
            }

            .text-display {
                font-size: 1.5rem;
                padding: 1.5rem;
            }

            .stats {
                grid-template-columns: 1fr;
                gap: 15px;
                padding: 1.5rem;
            }

            .practice-menu {
                gap: 10px;
            }

            .menu-btn {
                padding: 10px 20px;
                font-size: 0.9rem;
            }

            .modal-content {
                padding: 2rem;
                margin: 1rem;
            }

            .complete-title {
                font-size: 2.2rem;
            }

            .complete-value {
                font-size: 2rem;
            }

            /* 모바일 키보드 조정 */
            .keyboard {
                padding: 1rem;
            }

            .key {
                min-width: 1.8rem;
                height: 1.8rem;
                padding: 0.4rem;
                font-size: 0.7rem;
            }

            .key-dual {
                line-height: 1;
            }

            .key-en {
                font-size: 0.5rem;
            }

            .key-ko {
                font-size: 0.6rem;
            }

            .key.space {
                min-width: 6rem;
            }

            .key.shift {
                min-width: 2.5rem;
            }

            .key.enter {
                min-width: 3rem;
            }

            .key.backspace {
                min-width: 2.5rem;
            }

            .key.wide {
                min-width: 2rem;
            }

            .key.tab {
                min-width: 2rem;
            }

            .key.caps {
                min-width: 2.5rem;
            }
        }

        /* Animations */
        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .practice-container {
            animation: fadeInUp 0.8s ease-out;
        }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav>
        <div class="nav-container">
            <a href="../index.html" class="logo">⌨️ FingerRun</a>
            <ul class="nav-menu">
                <li><a href="../index.html">소개</a></li>
                <li>
                    <a href="practice.html">
                        한글 타자연습
                        <span class="dropdown-arrow">▼</span>
                    </a>
                    <div class="dropdown-menu">
                        <a href="practice.html" onclick="switchMode('consonant')">자음 연습</a>
                        <a href="practice.html" onclick="switchMode('vowel')">모음 연습</a>
                        <a href="practice.html" onclick="switchMode('word')">단어 연습</a>
                        <a href="practice.html" onclick="switchMode('sentence')">문장 연습</a>
                    </div>
                </li>
                <li>
                    <a href="../English/practice.html">
                        영어 타자연습
                        <span class="dropdown-arrow">▼</span>
                    </a>
                    <div class="dropdown-menu">
                        <a href="../English/practice.html" onclick="switchEnglishMode('alphabet')">알파벳 연습</a>
                        <a href="../English/practice.html" onclick="switchEnglishMode('word')">영어 단어 연습</a>
                        <a href="../English/practice.html" onclick="switchEnglishMode('sentence')">영어 문장 연습</a>
                    </div>
                </li>
                <li>
                    <a href="game-mole.html">
                        타자게임
                        <span class="dropdown-arrow">▼</span>
                    </a>
                    <div class="dropdown-menu">
                        <a href="game-mole.html">두더지 잡기 (한글)</a>
                        <a href="../English/game-mole.html">두더지 잡기 (영어)</a>
                        <a href="game-plane.html">비행기 조종 (한글)</a>
                        <a href="../English/game-plane.html">비행기 조종 (영어)</a>
                        <a href="game-delivery.html">택배 분류 (한글)</a>
                        <a href="../English/game-delivery.html">택배 분류 (영어)</a>
                    </div>
                </li>
                <li>
                    <a href="../Certificate/word-processor.html">
                        자격증
                        <span class="dropdown-arrow">▼</span>
                    </a>
                    <div class="dropdown-menu">
                        <a href="../Certificate/word-processor.html">워드프로세서</a>
                    </div>
                </li>
                <li><a href="../contact.html">문의하기</a></li>
            </ul>
        </div>
    </nav>

    <!-- Main Container -->
    <div class="main-container">
        <!-- Page Header -->
        <div class="page-header">
            <h1 class="page-title">한글 타자 연습</h1>
            <p class="page-description">체계적인 한글 타이핑 연습으로 정확도와 속도를 향상시키세요</p>
        </div>

        <!-- Practice Container -->
        <div class="practice-container">
            <!-- Practice Menu -->
            <div class="practice-menu">
                <button class="menu-btn active" data-mode="consonant">자음연습</button>
                <button class="menu-btn" data-mode="vowel">모음연습</button>
                <button class="menu-btn" data-mode="word">단어연습</button>
                <button class="menu-btn" data-mode="sentence">문장연습</button>
            </div>

            <!-- Practice Area -->
            <div class="practice-area">
                <div class="text-display" id="textDisplay"></div>

                <!-- Keyboard Area -->
                <div class="keyboard-area">
                    <div class="keyboard" id="keyboard">
                        <div class="keyboard-row">
                            <div class="key" data-key="`" data-ko=""><div class="key-dual"><span class="key-en">`</span><span class="key-ko"></span></div></div>
                            <div class="key" data-key="1" data-ko=""><div class="key-dual"><span class="key-en">1</span><span class="key-ko"></span></div></div>
                            <div class="key" data-key="2" data-ko=""><div class="key-dual"><span class="key-en">2</span><span class="key-ko"></span></div></div>
                            <div class="key" data-key="3" data-ko=""><div class="key-dual"><span class="key-en">3</span><span class="key-ko"></span></div></div>
                            <div class="key" data-key="4" data-ko=""><div class="key-dual"><span class="key-en">4</span><span class="key-ko"></span></div></div>
                            <div class="key" data-key="5" data-ko=""><div class="key-dual"><span class="key-en">5</span><span class="key-ko"></span></div></div>
                            <div class="key" data-key="6" data-ko=""><div class="key-dual"><span class="key-en">6</span><span class="key-ko"></span></div></div>
                            <div class="key" data-key="7" data-ko=""><div class="key-dual"><span class="key-en">7</span><span class="key-ko"></span></div></div>
                            <div class="key" data-key="8" data-ko=""><div class="key-dual"><span class="key-en">8</span><span class="key-ko"></span></div></div>
                            <div class="key" data-key="9" data-ko=""><div class="key-dual"><span class="key-en">9</span><span class="key-ko"></span></div></div>
                            <div class="key" data-key="0" data-ko=""><div class="key-dual"><span class="key-en">0</span><span class="key-ko"></span></div></div>
                            <div class="key" data-key="-" data-ko=""><div class="key-dual"><span class="key-en">-</span><span class="key-ko"></span></div></div>
                            <div class="key" data-key="=" data-ko=""><div class="key-dual"><span class="key-en">=</span><span class="key-ko"></span></div></div>
                            <div class="key backspace" data-key="Backspace">←</div>
                        </div>
                        <div class="keyboard-row">
                            <div class="key tab" data-key="Tab">Tab</div>
                            <div class="key" data-key="q" data-ko="ㅂ"><div class="key-dual"><span class="key-en">Q</span><span class="key-ko">ㅂ</span></div></div>
                            <div class="key" data-key="w" data-ko="ㅈ"><div class="key-dual"><span class="key-en">W</span><span class="key-ko">ㅈ</span></div></div>
                            <div class="key" data-key="e" data-ko="ㄷ"><div class="key-dual"><span class="key-en">E</span><span class="key-ko">ㄷ</span></div></div>
                            <div class="key" data-key="r" data-ko="ㄱ"><div class="key-dual"><span class="key-en">R</span><span class="key-ko">ㄱ</span></div></div>
                            <div class="key" data-key="t" data-ko="ㅅ"><div class="key-dual"><span class="key-en">T</span><span class="key-ko">ㅅ</span></div></div>
                            <div class="key" data-key="y" data-ko="ㅛ"><div class="key-dual"><span class="key-en">Y</span><span class="key-ko">ㅛ</span></div></div>
                            <div class="key" data-key="u" data-ko="ㅕ"><div class="key-dual"><span class="key-en">U</span><span class="key-ko">ㅕ</span></div></div>
                            <div class="key" data-key="i" data-ko="ㅑ"><div class="key-dual"><span class="key-en">I</span><span class="key-ko">ㅑ</span></div></div>
                            <div class="key" data-key="o" data-ko="ㅐ"><div class="key-dual"><span class="key-en">O</span><span class="key-ko">ㅐ</span></div></div>
                            <div class="key" data-key="p" data-ko="ㅔ"><div class="key-dual"><span class="key-en">P</span><span class="key-ko">ㅔ</span></div></div>
                            <div class="key" data-key="[" data-ko=""><div class="key-dual"><span class="key-en">[</span><span class="key-ko"></span></div></div>
                            <div class="key" data-key="]" data-ko=""><div class="key-dual"><span class="key-en">]</span><span class="key-ko"></span></div></div>
                            <div class="key" data-key="\\" data-ko=""><div class="key-dual"><span class="key-en">\\</span><span class="key-ko"></span></div></div>
                        </div>
                        <div class="keyboard-row">
                            <div class="key caps" data-key="CapsLock">Caps</div>
                            <div class="key" data-key="a" data-ko="ㅁ"><div class="key-dual"><span class="key-en">A</span><span class="key-ko">ㅁ</span></div></div>
                            <div class="key" data-key="s" data-ko="ㄴ"><div class="key-dual"><span class="key-en">S</span><span class="key-ko">ㄴ</span></div></div>
                            <div class="key" data-key="d" data-ko="ㅇ"><div class="key-dual"><span class="key-en">D</span><span class="key-ko">ㅇ</span></div></div>
                            <div class="key" data-key="f" data-ko="ㄹ"><div class="key-dual"><span class="key-en">F</span><span class="key-ko">ㄹ</span></div></div>
                            <div class="key" data-key="g" data-ko="ㅎ"><div class="key-dual"><span class="key-en">G</span><span class="key-ko">ㅎ</span></div></div>
                            <div class="key" data-key="h" data-ko="ㅗ"><div class="key-dual"><span class="key-en">H</span><span class="key-ko">ㅗ</span></div></div>
                            <div class="key" data-key="j" data-ko="ㅓ"><div class="key-dual"><span class="key-en">J</span><span class="key-ko">ㅓ</span></div></div>
                            <div class="key" data-key="k" data-ko="ㅏ"><div class="key-dual"><span class="key-en">K</span><span class="key-ko">ㅏ</span></div></div>
                            <div class="key" data-key="l" data-ko="ㅣ"><div class="key-dual"><span class="key-en">L</span><span class="key-ko">ㅣ</span></div></div>
                            <div class="key" data-key=";" data-ko=""><div class="key-dual"><span class="key-en">;</span><span class="key-ko"></span></div></div>
                            <div class="key" data-key="'" data-ko=""><div class="key-dual"><span class="key-en">'</span><span class="key-ko"></span></div></div>
                            <div class="key enter" data-key="Enter">Enter</div>
                        </div>
                        <div class="keyboard-row">
                            <div class="key shift" data-key="ShiftLeft">Shift</div>
                            <div class="key" data-key="z" data-ko="ㅋ"><div class="key-dual"><span class="key-en">Z</span><span class="key-ko">ㅋ</span></div></div>
                            <div class="key" data-key="x" data-ko="ㅌ"><div class="key-dual"><span class="key-en">X</span><span class="key-ko">ㅌ</span></div></div>
                            <div class="key" data-key="c" data-ko="ㅊ"><div class="key-dual"><span class="key-en">C</span><span class="key-ko">ㅊ</span></div></div>
                            <div class="key" data-key="v" data-ko="ㅍ"><div class="key-dual"><span class="key-en">V</span><span class="key-ko">ㅍ</span></div></div>
                            <div class="key" data-key="b" data-ko="ㅠ"><div class="key-dual"><span class="key-en">B</span><span class="key-ko">ㅠ</span></div></div>
                            <div class="key" data-key="n" data-ko="ㅜ"><div class="key-dual"><span class="key-en">N</span><span class="key-ko">ㅜ</span></div></div>
                            <div class="key" data-key="m" data-ko="ㅡ"><div class="key-dual"><span class="key-en">M</span><span class="key-ko">ㅡ</span></div></div>
                            <div class="key" data-key="," data-ko=""><div class="key-dual"><span class="key-en">,</span><span class="key-ko"></span></div></div>
                            <div class="key" data-key="." data-ko=""><div class="key-dual"><span class="key-en">.</span><span class="key-ko"></span></div></div>
                            <div class="key" data-key="/" data-ko=""><div class="key-dual"><span class="key-en">/</span><span class="key-ko"></span></div></div>
                            <div class="key shift" data-key="ShiftRight">Shift</div>
                        </div>
                        <div class="keyboard-row">
                            <div class="key wide" data-key="ControlLeft">Ctrl</div>
                            <div class="key wide" data-key="MetaLeft">Win</div>
                            <div class="key wide" data-key="AltLeft">Alt</div>
                            <div class="key space" data-key=" ">Space</div>
                            <div class="key wide" data-key="AltRight">Alt</div>
                            <div class="key wide" data-key="MetaRight">Win</div>
                            <div class="key wide" data-key="ContextMenu">Menu</div>
                            <div class="key wide" data-key="ControlRight">Ctrl</div>
                        </div>
                    </div>
                </div>

                <div class="input-area">
                    <input type="text" class="typing-input" id="typingInput" placeholder="여기에 타이핑하세요...">
                </div>
            </div>

            <!-- Stats -->
            <div class="stats">
                <div class="stat-item">
                    <div class="stat-value" id="accuracy">100%</div>
                    <div class="stat-label">정확도</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="speed">0</div>
                    <div class="stat-label">타자/분</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="progress">0/10</div>
                    <div class="stat-label">진행률</div>
                </div>
            </div>
        </div>
    </div>

    <!-- Complete Modal -->
    <div class="modal" id="completeModal" style="display: none;">
        <div class="modal-content">
            <h2 class="complete-title">연습 완료! 🎉</h2>
            <div class="complete-stats">
                <div class="complete-stat">
                    <div class="complete-value" id="finalAccuracy">100%</div>
                    <div class="complete-label">최종 정확도</div>
                </div>
                <div class="complete-stat">
                    <div class="complete-value" id="finalSpeed">0</div>
                    <div class="complete-label">평균 속도</div>
                </div>
            </div>
            <button class="restart-btn" id="restartBtn">다시 시작</button>
        </div>
    </div>

    <script>
        class KoreanTypingPractice {
            constructor() {
                this.currentMode = 'consonant';
                this.currentText = '';
                this.currentPosition = 0;
                this.startTime = null;
                this.totalJaso = 0;
                this.correctJaso = 0;
                this.currentJamoSequence = [];
                this.currentJamoPosition = 0;
                this.currentProblem = 0;
                this.totalProblems = 10;
                this.usedWords = [];
                this.usedSentences = [];
                this.sessionSpeeds = [];
                this.sessionAccuracies = [];

                // 한글 자모 매핑
                this.koreanKeyMap = {
                    'q': 'ㅂ', 'w': 'ㅈ', 'e': 'ㄷ', 'r': 'ㄱ', 't': 'ㅅ',
                    'y': 'ㅛ', 'u': 'ㅕ', 'i': 'ㅑ', 'o': 'ㅐ', 'p': 'ㅔ',
                    'a': 'ㅁ', 's': 'ㄴ', 'd': 'ㅇ', 'f': 'ㄹ', 'g': 'ㅎ',
                    'h': 'ㅗ', 'j': 'ㅓ', 'k': 'ㅏ', 'l': 'ㅣ',
                    'z': 'ㅋ', 'x': 'ㅌ', 'c': 'ㅊ', 'v': 'ㅍ',
                    'b': 'ㅠ', 'n': 'ㅜ', 'm': 'ㅡ'
                };

                // 키보드 매핑 (한글 자모 -> 키)
                this.keyboardMap = {};
                for (let [key, korean] of Object.entries(this.koreanKeyMap)) {
                    this.keyboardMap[korean] = key;
                }

                // 추가 한글 자모 매핑 (복합모음, 쌍자음)
                this.keyboardMap['ㄲ'] = 'r';
                this.keyboardMap['ㄸ'] = 'e';
                this.keyboardMap['ㅃ'] = 'q';
                this.keyboardMap['ㅆ'] = 't';
                this.keyboardMap['ㅉ'] = 'w';
                this.keyboardMap['ㅒ'] = 'o'; // ㅐ 키만
                this.keyboardMap['ㅖ'] = 'p'; // ㅔ 키만
                this.keyboardMap[' '] = ' '; // 스페이스바

                // 복합모음 매핑 (동시에 두 키 강조용)
                this.complexVowelMap = {
                    'ㅘ': ['h', 'k'], // ㅗ + ㅏ
                    'ㅙ': ['h', 'o'], // ㅗ + ㅐ
                    'ㅚ': ['h', 'l'], // ㅗ + ㅣ
                    'ㅝ': ['n', 'j'], // ㅜ + ㅓ
                    'ㅞ': ['n', 'p'], // ㅜ + ㅔ
                    'ㅟ': ['n', 'l'], // ㅜ + ㅣ
                    'ㅢ': ['m', 'l']  // ㅡ + ㅣ
                };

                this.practiceData = {
                    consonant: ['ㄱ', 'ㄴ', 'ㄷ', 'ㄹ', 'ㅁ', 'ㅂ', 'ㅅ', 'ㅇ', 'ㅈ', 'ㅊ', 'ㅋ', 'ㅌ', 'ㅍ', 'ㅎ', 'ㄲ', 'ㄸ', 'ㅃ', 'ㅆ', 'ㅉ'],
                    vowel: ['ㅏ', 'ㅑ', 'ㅓ', 'ㅕ', 'ㅗ', 'ㅛ', 'ㅜ', 'ㅠ', 'ㅡ', 'ㅣ', 'ㅐ', 'ㅒ', 'ㅔ', 'ㅖ', 'ㅘ', 'ㅙ', 'ㅚ', 'ㅝ', 'ㅞ', 'ㅟ', 'ㅢ'],
                    word: {
                        easy: [
                            '사람', '학교', '집', '물', '불', '하늘', '땅', '바다', '산', '강',
                            '나무', '꽃', '새', '고양이', '개', '책', '연필', '의자', '책상', '문',
                            '창문', '시계', '전화', '컴퓨터', '텔레비전', '냉장고', '침대', '소파', '밥', '빵',
                            '우유', '사과', '바나나', '딸기', '포도', '오렌지', '아침', '점심', '저녁', '월요일',
                            '화요일', '수요일', '목요일', '금요일', '토요일', '일요일', '봄', '여름', '가을', '겨울',
                            '날씨', '비', '눈', '바람', '구름', '해', '달', '별', '빨간색', '파란색',
                            '노란색', '초록색', '하얀색', '검은색', '엄마', '아빠', '형', '동생', '할머니', '할아버지',
                            '병원', '약국', '은행', '우체국', '마트', '가게', '버스', '지하철', '택시', '자전거',
                            '자동차', '비행기', '기차', '배', '바지', '치마', '옷', '신발', '모자', '가방',
                            '우산', '돈', '카드', '휴대폰', '노트북', '마우스', '키보드', '음식', '물건', '장난감',
                            '운동', '축구', '야구', '농구', '수영', '달리기'
                        ],
                        medium: [
                            '정치', '경제', '사회', '문화', '과학', '기술', '역사', '철학', '예술', '음악',
                            '문학', '소설', '시인', '작가', '투자', '주식', '부동산', '창업', '혁신', '리더십',
                            '도전', '성공', '실패', '성장', '변화', '기회', '꿈', '목표', '열정', '노력',
                            '인내', '용기', '희망', '자신감', '책임', '정의', '평등', '자유', '민주주의', '인권',
                            '환경', '기후', '에너지', '미래', '발전', '교육', '연구', '실험', '발견', '창작',
                            '영감', '상상력', '지혜', '지식', '진리', '아름다움', '감동', '사랑', '우정', '가족',
                            '공동체', '소통', '이해', '배려', '감사', '행복', '평화', '건강', '여행', '모험',
                            '경험', '추억', '시간', '공간', '자연', '도시', '문명', '전통', '현대', '글로벌',
                            '디지털', '인공지능', '로봇', '우주', '생명', '의료', '치료', '예방', '운동', '스포츠',
                            '전략', '계획', '관리', '분석', '평가', '개선', '효율', '품질', '서비스', '고객',
                            '시장', '경쟁', '협력', '네트워크', '플랫폼', '데이터', '정보', '통신', '보안', '개인정보', '프라이버시'
                        ],
                        hard: [
                            '뿌리깊은', '빨갛게', '까맣게', '뽀얗게', '빠뜨리다', '뜨뜻미지근하다', '꺼칠꺼칠하다', '삐걱삐걱', '뒤뚱뒤뚱', '엇갈리다',
                            '얽혀있다', '웅성웅성', '우르르', '자글자글', '쭈글쭈글', '떨떠름하다', '우글우글', '쑥스럽다', '엉성하다', '삐뚤어지다',
                            '깜빡깜빡', '흐뭇하다', '아뜩하다', '까탈스럽다', '깔끔하다', '까무잡잡하다', '빼곡하다', '빙글빙글', '껄껄웃다', '킥킥거리다',
                            '씩씩하다', '쭉쭉뻗다', '휘청휘청', '흔들흔들', '울퉁불퉁', '데굴데굴', '뱅글뱅글', '껑충껑충', '팔랑팔랑', '펄럭펄럭',
                            '나풀나풀', '살랑살랑', '주렁주렁', '졸졸흐르다', '찰랑찰랑', '출렁출렁', '출렁거리다', '철썩철썩', '첨벙첨벙', '뛰어올라가다',
                            '주저앉다', '엎드리다', '우뚝서다', '뒤돌아보다', '내려다보다', '올려다보다', '가로질러가다', '비틀거리다', '뒤뚱거리다', '비스듬히',
                            '아슬아슬', '가파르다', '뾰족하다', '두루뭉술하다', '어깨동무하다', '손뼉치다', '발가락질하다', '눈짓하다', '머리감다', '이마찡그리다',
                            '코웃음치다', '입꾸물거리다'
                        ]
                    },
                    sentence: [
                        '경제 성장과 사회 발전은 서로 밀접한 관련이 있습니다.',
                        '기술 혁신이 우리의 미래를 바꾸고 있습니다.',
                        '환경 보호는 다음 세대를 위한 중요한 과제입니다.',
                        '교육의 힘으로 더 나은 세상을 만들어갑시다.',
                        '꿈을 포기하지 않는 사람만이 성공할 수 있습니다.',
                        '실패는 성공으로 가는 과정일 뿐입니다.',
                        '창의적 사고가 문제 해결의 열쇠입니다.',
                        '글로벌 시대에는 소통 능력이 필수입니다.',
                        '인공지능이 인간의 삶을 어떻게 변화시킬까요?',
                        '민주주의는 시민의 참여로 완성됩니다.',
                        '오늘 날씨가 정말 좋아서 산책하기 좋은 하루입니다.',
                        '커피 한 잔과 함께 책을 읽는 시간이 가장 행복합니다.',
                        '가족과 함께 보내는 시간은 무엇과도 바꿀 수 없습니다.',
                        '건강한 식습관과 규칙적인 운동이 장수의 비결입니다.',
                        '새로운 언어를 배우는 것은 새로운 세계를 발견하는 일입니다.',
                        '음악을 들으면 마음이 편안해지고 스트레스가 풀립니다.',
                        '여행을 통해 다양한 문화를 경험하고 시야를 넓힐 수 있습니다.',
                        '친구들과 함께 나누는 대화는 인생의 소중한 기쁨입니다.',
                        '독서는 상상력을 기르고 지식을 쌓는 최고의 방법입니다.',
                        '요리를 할 때 가족을 생각하면 더욱 맛있게 만들 수 있습니다.',
                        '스마트폰이 우리 생활에 미친 영향을 한번 생각해보세요.',
                        '지구온난화 문제는 전 세계가 함께 해결해야 할 과제입니다.',
                        '인터넷의 발달로 정보 접근성이 크게 향상되었습니다.',
                        '코로나19 팬데믹은 우리 사회를 완전히 바꾸었습니다.',
                        '원격근무가 새로운 일하는 방식으로 자리잡고 있습니다.',
                        '메타버스가 미래 사회의 새로운 플랫폼이 될 것입니다.',
                        '블록체인 기술이 금융 시스템을 혁신하고 있습니다.',
                        '전기자동차 보급으로 친환경 교통수단이 확산되고 있습니다.',
                        '재생에너지 발전이 기후변화 대응의 핵심입니다.',
                        '플라스틱 사용 줄이기는 환경 보호의 첫걸음입니다.',
                        'K팝이 전 세계 청년들에게 큰 인기를 얻고 있습니다.',
                        '한국 드라마가 넷플릭스를 통해 세계로 퍼져나가고 있습니다.',
                        '온라인 쇼핑몰이 전통적인 오프라인 매장을 대체하고 있습니다.',
                        '배달 앱의 성장으로 외식 문화가 크게 변화했습니다.',
                        '유튜브는 새로운 직업군을 만들어내는 플랫폼입니다.',
                        '소셜미디어는 현대인의 소통 방식을 완전히 바꾸었습니다.',
                        '게임 산업이 문화 콘텐츠의 새로운 영역으로 성장하고 있습니다.',
                        '웹툰이 한국 문화 콘텐츠의 새로운 강자로 떠오르고 있습니다.',
                        '인공지능 기술이 의료 분야에서 혁신을 이끌고 있습니다.',
                        '로봇 기술의 발전이 제조업 자동화를 가속화하고 있습니다.',
                        '빅데이터 분석이 마케팅과 광고의 패러다임을 바꾸고 있습니다.',
                        '클라우드 컴퓨팅이 기업의 IT 인프라를 혁신하고 있습니다.',
                        '사물인터넷 기술이 스마트홈 시대를 열어가고 있습니다.',
                        '드론 기술이 물류와 배송 시스템을 변화시키고 있습니다.',
                        '가상현실 기술이 교육과 훈련 분야에서 활용되고 있습니다.',
                        '양자컴퓨터가 컴퓨팅의 새로운 미래를 제시하고 있습니다.',
                        '바이오 기술이 질병 치료와 예방에 새로운 가능성을 열고 있습니다.',
                        '나노 기술이 소재 과학의 혁신을 이끌어내고 있습니다.',
                        '우주 기술의 발전으로 화성 탐사가 현실이 되어가고 있습니다.',
                        '지속 가능한 발전을 위해서는 모든 분야의 협력이 필요합니다.'
                    ]
                };

                this.init();
            }

            init() {
                this.bindEvents();
                this.generateText();
                this.updateDisplay();
            }

            bindEvents() {
                document.querySelectorAll('.menu-btn').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        this.changeMode(e.target.dataset.mode);
                    });
                });

                const typingInput = document.getElementById('typingInput');
                
                // input 이벤트로 텍스트 변화 감지
                typingInput.addEventListener('input', (e) => {
                    try {
                        this.handleInput(e.target.value);
                    } catch (error) {
                        document.getElementById('accuracy').textContent = '100%';
                        document.getElementById('speed').textContent = '0';
                    }
                });

                // 엔터/스페이스로 다음 문제
                typingInput.addEventListener('keydown', (e) => {
                    if ((e.key === ' ' || e.key === 'Enter') && this.currentPosition >= this.currentText.length) {
                        e.preventDefault();
                        this.nextProblem();
                    }
                });

                document.getElementById('restartBtn').addEventListener('click', () => {
                    this.restart();
                });
            }

            changeMode(mode) {
                this.currentMode = mode;
                this.currentProblem = 0;
                this.resetStats();
                
                document.querySelectorAll('.menu-btn').forEach(btn => {
                    btn.classList.remove('active');
                });
                document.querySelector(`[data-mode="${mode}"]`).classList.add('active');
                
                this.generateText();
                this.updateDisplay();
                document.getElementById('typingInput').value = '';
                document.getElementById('typingInput').focus();
            }

            generateText() {
                const data = this.practiceData[this.currentMode];
                
                if (this.currentMode === 'consonant' || this.currentMode === 'vowel') {
                    const selected = [];
                    for (let i = 0; i < 7; i++) {
                        selected.push(data[Math.floor(Math.random() * data.length)]);
                    }
                    this.currentText = selected.join(' ');
                } else if (this.currentMode === 'word') {
                    const selected = [];
                    const easyWords = this.practiceData.word.easy.filter(word => !this.usedWords.includes(word));
                    const mediumWords = this.practiceData.word.medium.filter(word => !this.usedWords.includes(word));
                    const hardWords = this.practiceData.word.hard.filter(word => !this.usedWords.includes(word));
                    
                    // 사용 가능한 단어가 없으면 초기화
                    if (easyWords.length === 0 && mediumWords.length === 0 && hardWords.length === 0) {
                        this.usedWords = [];
                    }
                    
                    const availableEasy = easyWords.length > 0 ? easyWords : this.practiceData.word.easy;
                    const availableMedium = mediumWords.length > 0 ? mediumWords : this.practiceData.word.medium;
                    const availableHard = hardWords.length > 0 ? hardWords : this.practiceData.word.hard;
                    
                    const easyWord = availableEasy[Math.floor(Math.random() * availableEasy.length)];
                    const mediumWord = availableMedium[Math.floor(Math.random() * availableMedium.length)];
                    const hardWord = availableHard[Math.floor(Math.random() * availableHard.length)];
                    
                    // 사용된 단어 기록
                    this.usedWords.push(easyWord, mediumWord, hardWord);
                    
                    const words = [easyWord, mediumWord, hardWord];
                    for (let i = words.length - 1; i > 0; i--) {
                        const j = Math.floor(Math.random() * (i + 1));
                        [words[i], words[j]] = [words[j], words[i]];
                    }
                    
                    this.currentText = words.join(' ');
                } else {
                    const availableSentences = data.filter(sentence => !this.usedSentences.includes(sentence));
                    
                    // 사용 가능한 문장이 없으면 초기화
                    if (availableSentences.length === 0) {
                        this.usedSentences = [];
                        availableSentences.push(...data);
                    }
                    
                    const randomIndex = Math.floor(Math.random() * availableSentences.length);
                    this.currentText = availableSentences[randomIndex];
                    
                    // 사용된 문장 기록
                    this.usedSentences.push(this.currentText);
                }

                this.currentPosition = 0;
                this.startTime = null;
                this.correctJaso = 0;
                this.totalJaso = 0;
                this.currentJamoSequence = [];
                this.currentJamoPosition = 0;

                // 텍스트의 전체 자모 시퀀스 생성
                this.generateJamoSequence();

                // 초기 키보드 강조
                this.updateKeyboardHighlight();

                const textDisplay = document.getElementById('textDisplay');
                if (this.currentMode === 'sentence') {
                    textDisplay.classList.add('sentence-mode');
                } else {
                    textDisplay.classList.remove('sentence-mode');
                }
            }

            // 텍스트 전체를 자모 단위로 분해하여 시퀀스 생성
            generateJamoSequence() {
                this.currentJamoSequence = [];
                for (let i = 0; i < this.currentText.length; i++) {
                    const char = this.currentText[i];
                    if (char === ' ') {
                        this.currentJamoSequence.push(' ');
                    } else {
                        const decomposed = this.decomposeHangul(char);
                        if (decomposed && decomposed.length > 0) {
                            for (let jamo of decomposed) {
                                this.currentJamoSequence.push(jamo);
                            }
                        } else {
                            this.currentJamoSequence.push(char);
                        }
                    }
                }
            }

            countJaso(text) {
                let jasoCount = 0;
                for (let char of text) {
                    try {
                        if (char === ' ') {
                            jasoCount += 1;
                        } else if (/[가-힣]/.test(char)) {
                            const unicode = char.charCodeAt(0) - 0xAC00;
                            if (unicode >= 0 && unicode <= 11171) {
                                const jong = unicode % 28;
                                jasoCount += 2;
                                if (jong > 0) jasoCount += 1;
                            } else {
                                jasoCount += 1;
                            }
                        } else {
                            jasoCount += 1;
                        }
                    } catch (error) {
                        jasoCount += 1;
                    }
                }
                return jasoCount;
            }

            updateDisplay() {
                try {
                    const display = document.getElementById('textDisplay');
                    display.innerHTML = '';

                    for (let i = 0; i < this.currentText.length; i++) {
                        const span = document.createElement('span');
                        span.className = 'char';
                        
                        if (this.currentText[i] === ' ') {
                            span.innerHTML = '&nbsp;';
                            span.classList.add('space');
                        } else {
                            span.textContent = this.currentText[i];
                        }

                        if (i < this.currentPosition) {
                            span.classList.add('correct');
                        } else if (i === this.currentPosition) {
                            span.classList.add('current');
                        }

                        display.appendChild(span);
                    }

                    if (this.currentMode === 'sentence') {
                        this.applyInitialColors();
                    }

                    this.updateKeyboardHighlight();
                    document.getElementById('progress').textContent = `${this.currentProblem + 1}/${this.totalProblems}`;
                } catch (error) {
                    // UI 렌더링 오류 시 기본 상태 유지
                }
            }

            // 한글 문자를 자모로 분해하는 함수 (복합모음 올바른 순서로 분해)
            decomposeHangul(char) {
                const code = char.charCodeAt(0);
                
                // 개별 자모인 경우
                if ((code >= 0x3131 && code <= 0x314E) || (code >= 0x314F && code <= 0x3163)) {
                    // 복합모음 개별 자모 분해 (타자 입력 순서대로)
                    switch (char) {
                        case 'ㅘ': // ㅗ + ㅏ
                            return ['ㅗ', 'ㅏ'];
                        case 'ㅙ': // ㅗ + ㅐ
                            return ['ㅗ', 'ㅐ'];
                        case 'ㅚ': // ㅗ + ㅣ
                            return ['ㅗ', 'ㅣ'];
                        case 'ㅝ': // ㅜ + ㅓ
                            return ['ㅜ', 'ㅓ'];
                        case 'ㅞ': // ㅜ + ㅔ
                            return ['ㅜ', 'ㅔ'];
                        case 'ㅟ': // ㅜ + ㅣ
                            return ['ㅜ', 'ㅣ'];
                        case 'ㅢ': // ㅡ + ㅣ
                            return ['ㅡ', 'ㅣ'];
                        case 'ㅒ': // ㅐ + ㅣ
                            return ['ㅐ', 'ㅣ'];
                        case 'ㅖ': // ㅔ + ㅣ
                            return ['ㅔ', 'ㅣ'];
                        default:
                            return [char];
                    }
                }

                // 완성된 한글인지 확인 (가-힣)
                if (code >= 0xAC00 && code <= 0xD7A3) {
                    const baseCode = code - 0xAC00;
                    const choIndex = Math.floor(baseCode / 588);
                    const jungIndex = Math.floor((baseCode % 588) / 28);
                    const jongIndex = baseCode % 28;

                    const choSeong = ['ㄱ', 'ㄲ', 'ㄴ', 'ㄷ', 'ㄸ', 'ㄹ', 'ㅁ', 'ㅂ', 'ㅃ', 'ㅅ', 'ㅆ', 'ㅇ', 'ㅈ', 'ㅉ', 'ㅊ', 'ㅋ', 'ㅌ', 'ㅍ', 'ㅎ'];
                    const jungSeong = ['ㅏ', 'ㅐ', 'ㅑ', 'ㅒ', 'ㅓ', 'ㅔ', 'ㅕ', 'ㅖ', 'ㅗ', 'ㅘ', 'ㅙ', 'ㅚ', 'ㅛ', 'ㅜ', 'ㅝ', 'ㅞ', 'ㅟ', 'ㅠ', 'ㅡ', 'ㅢ', 'ㅣ'];
                    const jongSeong = ['', 'ㄱ', 'ㄲ', 'ㄳ', 'ㄴ', 'ㄵ', 'ㄶ', 'ㄷ', 'ㄹ', 'ㄺ', 'ㄻ', 'ㄼ', 'ㄽ', 'ㄾ', 'ㄿ', 'ㅀ', 'ㅁ', 'ㅂ', 'ㅄ', 'ㅅ', 'ㅆ', 'ㅇ', 'ㅈ', 'ㅊ', 'ㅋ', 'ㅌ', 'ㅍ', 'ㅎ'];

                    const result = [];

                    // 초성 추가
                    if (choSeong[choIndex]) {
                        result.push(choSeong[choIndex]);
                    }

                    // 중성 추가 - 복합모음을 타자 순서로 분해
                    const jung = jungSeong[jungIndex];
                    if (jung) {
                        switch (jung) {
                            case 'ㅘ': // ㅗ + ㅏ
                                result.push('ㅗ');
                                result.push('ㅏ');
                                break;
                            case 'ㅙ': // ㅗ + ㅐ
                                result.push('ㅗ');
                                result.push('ㅐ');
                                break;
                            case 'ㅚ': // ㅗ + ㅣ
                                result.push('ㅗ');
                                result.push('ㅣ');
                                break;
                            case 'ㅝ': // ㅜ + ㅓ
                                result.push('ㅜ');
                                result.push('ㅓ');
                                break;
                            case 'ㅞ': // ㅜ + ㅔ
                                result.push('ㅜ');
                                result.push('ㅔ');
                                break;
                            case 'ㅟ': // ㅜ + ㅣ
                                result.push('ㅜ');
                                result.push('ㅣ');
                                break;
                            case 'ㅢ': // ㅡ + ㅣ
                                result.push('ㅡ');
                                result.push('ㅣ');
                                break;
                            case 'ㅒ': // ㅐ + ㅣ
                                result.push('ㅐ');
                                result.push('ㅣ');
                                break;
                            case 'ㅖ': // ㅔ + ㅣ
                                result.push('ㅔ');
                                result.push('ㅣ');
                                break;
                            default:
                                result.push(jung);
                                break;
                        }
                    }

                    // 종성 추가
                    if (jongSeong[jongIndex]) {
                        result.push(jongSeong[jongIndex]);
                    }

                    return result;
                }

                return null;
            }

            updateKeyboardHighlight() {
                // 모든 키 강조 제거
                document.querySelectorAll('.key').forEach(key => {
                    key.classList.remove('active');
                });

                // 단어/문장 모드에서는 자모 시퀀스 기반 강조
                if (this.currentMode === 'word' || this.currentMode === 'sentence') {
                    // 입력값 기반으로 자모 위치 계산
                    const inputValue = document.getElementById('typingInput').value;
                    let inputJamoCount = 0;

                    for (let i = 0; i < inputValue.length; i++) {
                        const char = inputValue[i];
                        if (char === ' ') {
                            inputJamoCount += 1;
                        } else {
                            const decomposed = this.decomposeHangul(char);
                            if (decomposed && decomposed.length > 0) {
                                inputJamoCount += decomposed.length;
                            } else {
                                inputJamoCount += 1;
                            }
                        }
                    }

                    if (inputJamoCount < this.currentJamoSequence.length) {
                        const currentJamo = this.currentJamoSequence[inputJamoCount];

                        // 스페이스바 처리
                        if (currentJamo === ' ') {
                            const targetKey = document.querySelector(`[data-key=" "]`);
                            if (targetKey) {
                                targetKey.classList.add('active');
                            }
                        }
                        // 복합모음인 경우 두 키 모두 강조 (ㅒ, ㅖ 제외)
                        else if (this.complexVowelMap[currentJamo]) {
                            const keys = this.complexVowelMap[currentJamo];
                            keys.forEach(keyName => {
                                const targetKey = document.querySelector(`[data-key="${keyName}"]`);
                                if (targetKey) {
                                    targetKey.classList.add('active');
                                }
                            });
                        } else {
                            // 일반 자모인 경우 단일 키 강조 (ㅒ는 ㅐ키만, ㅖ는 ㅔ키만)
                            const keyName = this.keyboardMap[currentJamo];
                            if (keyName) {
                                const targetKey = document.querySelector(`[data-key="${keyName}"]`);
                                if (targetKey) {
                                    targetKey.classList.add('active');
                                }
                            }
                        }
                    }
                } else {
                    // 자음/모음 모드
                    if (this.currentPosition < this.currentText.length) {
                        const currentChar = this.currentText[this.currentPosition];

                        // 스페이스바 처리
                        if (currentChar === ' ') {
                            const targetKey = document.querySelector(`[data-key=" "]`);
                            if (targetKey) {
                                targetKey.classList.add('active');
                            }
                        }
                        // 복합모음인 경우 두 키 모두 강조 (ㅒ, ㅖ 제외)
                        else if (this.complexVowelMap[currentChar]) {
                            const keys = this.complexVowelMap[currentChar];
                            keys.forEach(keyName => {
                                const targetKey = document.querySelector(`[data-key="${keyName}"]`);
                                if (targetKey) {
                                    targetKey.classList.add('active');
                                }
                            });
                        } else {
                            // 일반 자모인 경우 단일 키 강조 (ㅒ는 ㅐ키만, ㅖ는 ㅔ키만)
                            const keyName = this.keyboardMap[currentChar];
                            if (keyName) {
                                const targetKey = document.querySelector(`[data-key="${keyName}"]`);
                                if (targetKey) {
                                    targetKey.classList.add('active');
                                }
                            }
                        }
                    }
                }
            }

            applyInitialColors() {
                const chars = document.querySelectorAll('.char');
                chars.forEach(char => {
                    char.style.color = '#8b5cf6';
                    char.style.background = 'none';
                    char.style.padding = '0';
                    char.style.borderRadius = '0';
                    char.style.boxShadow = 'none';
                    char.style.transform = 'none';
                });
            }

            handleInput(inputValue) {
                try {
                    if (!this.startTime) {
                        this.startTime = Date.now();
                    }

                    if (this.currentMode === 'sentence') {
                        const chars = document.querySelectorAll('.char');
                        this.correctJaso = 0;
                        this.totalJaso = this.countJaso(inputValue);

                        for (let i = 0; i < this.currentText.length; i++) {
                            const char = chars[i];
                            if (!char) continue;

                            char.style.background = 'none';
                            char.style.padding = '0';
                            char.style.borderRadius = '0';
                            char.style.boxShadow = 'none';
                            char.style.transform = 'none';

                            if (i < inputValue.length) {
                                if (inputValue[i] === this.currentText[i]) {
                                    char.style.color = '#000000';
                                    this.correctJaso += this.countJaso(this.currentText[i]);
                                } else {
                                    char.style.color = '#ff4444';
                                }
                            } else if (i === inputValue.length) {
                                char.style.color = '#3b82f6';
                            } else {
                                char.style.color = '#8b5cf6';
                            }
                        }
                    } else {
                        const chars = document.querySelectorAll('.char');
                        this.correctJaso = 0;
                        this.totalJaso = this.countJaso(inputValue);

                        for (let i = 0; i < this.currentText.length; i++) {
                            const char = chars[i];

                            if (i < inputValue.length) {
                                if (inputValue[i] === this.currentText[i]) {
                                    char.className = 'char correct';
                                    this.correctJaso += this.countJaso(this.currentText[i]);
                                } else {
                                    char.className = 'char incorrect';
                                }
                            } else {
                                char.className = 'char';
                                if (i === inputValue.length) {
                                    char.classList.add('current');
                                }
                            }
                        }
                    }

                    this.currentPosition = inputValue.length;
                    this.updateStats();
                    this.updateKeyboardHighlight();

                    if (inputValue === this.currentText) {
                        this.showNextButton();
                    }
                } catch (error) {
                    document.getElementById('accuracy').textContent = '100%';
                    document.getElementById('speed').textContent = '0';
                }
            }

            updateStats() {
                try {
                    const accuracy = this.totalJaso > 0 ? Math.round((this.correctJaso / this.totalJaso) * 100) : 100;
                    document.getElementById('accuracy').textContent = `${accuracy}%`;

                    if (this.startTime) {
                        const elapsed = (Date.now() - this.startTime) / 1000;
                        const cpm = elapsed > 0 ? Math.round((this.totalJaso / elapsed) * 60) : 0;
                        document.getElementById('speed').textContent = cpm;
                    } else {
                        document.getElementById('speed').textContent = '0';
                    }
                } catch (error) {
                    document.getElementById('accuracy').textContent = '100%';
                    document.getElementById('speed').textContent = '0';
                }
            }

            showNextButton() {
                try {
                    const accuracy = this.totalJaso > 0 ? Math.round((this.correctJaso / this.totalJaso) * 100) : 100;
                    const elapsed = this.startTime ? (Date.now() - this.startTime) / 1000 : 0;
                    const cpm = elapsed > 0 ? Math.round((this.totalJaso / elapsed) * 60) : 0;

                    this.sessionSpeeds.push(cpm);
                    this.sessionAccuracies.push(accuracy);
                } catch (error) {
                    // 오류 시 기본 상태 유지
                }
            }

            nextProblem() {
                try {
                    this.currentProblem++;
                    if (this.currentProblem >= this.totalProblems) {
                        this.showComplete();
                    } else {
                        this.generateText();
                        this.updateDisplay();
                        document.getElementById('typingInput').value = '';
                        document.getElementById('typingInput').focus();
                    }
                } catch (error) {
                    // 다음 문제로 이동 오류 시 기본 상태 유지
                }
            }

            showComplete() {
                try {
                    const avgAccuracy = this.sessionAccuracies.length > 0 ? 
                        Math.round(this.sessionAccuracies.reduce((a, b) => a + b, 0) / this.sessionAccuracies.length) : 100;
                    const avgSpeed = this.sessionSpeeds.length > 0 ? 
                        Math.round(this.sessionSpeeds.reduce((a, b) => a + b, 0) / this.sessionSpeeds.length) : 0;

                    document.getElementById('finalAccuracy').textContent = `${avgAccuracy}%`;
                    document.getElementById('finalSpeed').textContent = avgSpeed;
                    document.getElementById('completeModal').style.display = 'flex';
                } catch (error) {
                    // 완료 모달 표시 오류 시 기본 상태 유지
                }
            }

            restart() {
                try {
                    this.currentProblem = 0;
                    this.sessionSpeeds = [];
                    this.sessionAccuracies = [];
                    this.resetStats();
                    this.generateText();
                    this.updateDisplay();
                    document.getElementById('typingInput').value = '';
                    document.getElementById('completeModal').style.display = 'none';
                    document.getElementById('typingInput').focus();
                } catch (error) {
                    // 재시작 오류 시 기본 상태 유지
                }
            }

            resetStats() {
                try {
                    this.currentPosition = 0;
                    this.startTime = null;
                    this.totalJaso = 0;
                    this.correctJaso = 0;
                    document.getElementById('accuracy').textContent = '100%';
                    document.getElementById('speed').textContent = '0';
                    document.getElementById('progress').textContent = `1/${this.totalProblems}`;
                } catch (error) {
                    // 통계 초기화 오류 시 기본 상태 유지
                }
            }
        }

        // 드롭다운에서 모드 전환 함수
        function switchMode(mode) {
            if (window.typingPractice) {
                window.typingPractice.changeMode(mode);
            }
        }

        // 영어 타자연습 모드 전환 함수
        function switchEnglishMode(mode) {
            const modeNames = {
                'alphabet': '알파벳',
                'word': '단어',
                'sentence': '문장'
            };
            alert(`영어 ${modeNames[mode]}연습을 시작합니다!\n\n추후 영어 타자연습 페이지에서 구현될 예정입니다.`);
        }

        // 타자게임 함수들
        function playKoreanMoleGame() {
            alert('한글 두더지 잡기 게임을 시작합니다! 🐹\n\n실제 구현에서는 한글 게임 페이지로 이동합니다.');
        }

        function playEnglishMoleGame() {
            alert('영어 두더지 잡기 게임을 시작합니다! 🎯\n\n실제 구현에서는 영어 게임 페이지로 이동합니다.');
        }

        function playKoreanPlaneGame() {
            alert('한글 비행기 조종 게임을 시작합니다! ✈️\n\n실제 구현에서는 한글 비행기 게임 페이지로 이동합니다.');
        }

        function playEnglishPlaneGame() {
            alert('영어 비행기 조종 게임을 시작합니다! 🛩️\n\n실제 구현에서는 영어 비행기 게임 페이지로 이동합니다.');
        }

        function playKoreanDeliveryGame() {
            alert('한글 택배 분류 게임을 시작합니다! 📦\n\n실제 구현에서는 한글 택배 게임 페이지로 이동합니다.');
        }

        function playEnglishDeliveryGame() {
            alert('영어 택배 분류 게임을 시작합니다! 📮\n\n실제 구현에서는 영어 택배 게임 페이지로 이동합니다.');
        }

        // 페이지 로드 시 초기화
        document.addEventListener('DOMContentLoaded', () => {
            try {
                window.typingPractice = new KoreanTypingPractice();
            } catch (error) {
                // 초기화 오류 시 기본 상태 유지
            }
        });

        // 네비게이션 스크롤 효과
        window.addEventListener('scroll', () => {
            const nav = document.querySelector('nav');
            if (window.scrollY > 100) {
                nav.style.background = 'rgba(255, 255, 255, 0.98)';
            } else {
                nav.style.background = 'rgba(255, 255, 255, 0.95)';
            }
        });

        // 부드러운 스크롤링
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                const href = this.getAttribute('href');
                if (href && href !== '#') {
                    e.preventDefault();
                    const target = document.querySelector(href);
                    if (target) {
                        target.scrollIntoView({
                            behavior: 'smooth',
                            block: 'start'
                        });
                    }
                }
            });
        });
    </script>
</body>
</html>